import{q as p,r as d,a as m,j as e,$ as N}from"./app-Cv3MKqnQ.js";import{A as y}from"./app-layout-B9EKTGre.js";import{U as w,C as v}from"./user-BeBrnzWe.js";import{B as i}from"./chevron-right-xPR8hiYq.js";import{C as x,T as k}from"./triangle-alert-CeFHn_An.js";import{C as o}from"./clock-vLQhbkbj.js";import{S as B}from"./search-CG4lyfLd.js";import"./app-logo-icon-ivrV0WvK.js";import"./index-C3a3quoa.js";import"./index-CZzXUl2S.js";import"./createLucideIcon-CFrv8MY5.js";const _=[{title:"My Library",href:"/user"},{title:"Dashboard",href:"/user/dashboard"}];function $(){const{auth:c}=p().props,[r,h]=d.useState([]),[j,u]=d.useState({}),[a,b]=d.useState(!0);d.useEffect(()=>{g()},[]);const g=async()=>{try{const[s,t]=await Promise.all([m.get("/api/user/transactions"),m.get("/api/user/dashboard-stats")]);h(s.data),u(t.data)}catch(s){console.error("Failed to fetch user data:",s)}finally{b(!1)}},n=s=>new Date(s).toLocaleDateString(),l=s=>{var t;return new Date(s)<new Date&&!((t=r.find(f=>f.due_date===s))!=null&&t.returned_at)};return e.jsxs(y,{breadcrumbs:_,children:[e.jsx(N,{title:"My Dashboard"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg shadow-sm p-6 text-white",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-full",children:e.jsx(w,{className:"h-8 w-8"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Welcome back, ",c.user.name,"!"]}),e.jsxs("p",{className:"text-blue-100",children:[c.user.role==="student"?"Student":"Staff"," â€¢ Library Member"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Books Borrowed"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a?"...":j.myBorrowedBooks||0})]}),e.jsx(i,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Loans"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a?"...":r.filter(s=>!s.returned_at).length})]}),e.jsx(x,{className:"h-8 w-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Books"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a?"...":r.filter(s=>!s.returned_at&&l(s.due_date)).length})]}),e.jsx(o,{className:"h-8 w-8 text-red-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(i,{className:"h-5 w-5 mr-2 text-blue-600"}),"Currently Borrowed Books"]})}),e.jsx("div",{className:"p-6",children:a?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading your books..."})]}):r.filter(s=>!s.returned_at).length>0?e.jsx("div",{className:"space-y-4",children:r.filter(s=>!s.returned_at).map(s=>e.jsx("div",{className:`p-4 rounded-lg border ${l(s.due_date)?"border-red-200 bg-red-50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.book_title}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Borrowed: ",n(s.borrowed_at)]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(o,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Due: ",n(s.due_date)]})]})]})]}),e.jsx("div",{className:"ml-4",children:l(s.due_date)?e.jsxs("div",{className:"flex items-center text-red-600",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Overdue"})]}):e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(v,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Active"})]})})]})},s.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(i,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"You don't have any books currently borrowed."}),e.jsx("p",{className:"text-sm mt-1",children:"Visit the library to borrow some books!"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("a",{href:"/user/search",className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Search Books"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Find books in the library catalog"})]})]})}),e.jsx("a",{href:"/user/history",className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(o,{className:"h-8 w-8 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Borrowing History"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View your complete borrowing history"})]})]})})]})]})]})}export{$ as default};
