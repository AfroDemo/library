import{q as $,r as l,j as e,$ as O,m as x}from"./app-DCuZLIiR.js";import{A as P,T as I}from"./app-layout-CxSrBOU3.js";import{U}from"./users-CMo67ggo.js";import{D as L}from"./download-BkUYoEL1.js";import{S as F}from"./search-BSJJuXeU.js";import{S as z}from"./square-pen-B8CwlUIa.js";import{T as q}from"./trash-2-Cb7_oVag.js";import"./app-logo-icon-l4AutvGA.js";import"./index-DWDx7uJa.js";import"./index-Bq50F9d8.js";import"./createLucideIcon-B80Gj0Dh.js";import"./chevron-right-MvP6eIpt.js";const V=[{title:"Admin",href:"/admin"},{title:"Manage Users",href:"/admin/users"}];function ae(){const{users:o,filters:j,errors:u,success:p}=$().props,[b,v]=l.useState(j.search||""),[h,N]=l.useState(j.role||""),[k,f]=l.useState([]),[A,g]=l.useState(!1),[i,w]=l.useState(null),[a,d]=l.useState({name:"",email:"",role:"student",password:"",member_id:""});l.useEffect(()=>{typeof p=="string"&&p&&S("success",p),u&&Object.values(u).length>0&&Object.values(u).forEach(s=>S("error",s))},[p,u]);const S=(s,r)=>{const n=Date.now().toString();f(c=>[...c,{type:s,message:r,id:n}]),setTimeout(()=>f(c=>c.filter(m=>m.id!==n)),5e3)},E=s=>{f(r=>r.filter(n=>n.id!==s))},y=(s=b,r=h)=>{x.get(route("admin.users.index"),{search:s,role:r},{preserveState:!0,replace:!0})},R=s=>{s&&x.get(s,{search:b,role:h},{preserveState:!0})},D=()=>{const r=[["ID","Name","Email","Role","Member ID"],...o.data.map(t=>[t.id,t.name,t.email,t.role,t.member_id||"N/A"])].map(t=>t.map(T=>`"${T}"`).join(",")).join(`
`),n=new Blob([r],{type:"text/csv"}),c=window.URL.createObjectURL(n),m=document.createElement("a");m.href=c,m.download=`users_${new Date().toISOString().split("T")[0]}.csv`,m.click(),window.URL.revokeObjectURL(c)},C=(s=null)=>{w(s),d(s?{name:s.name,email:s.email,role:s.role,password:"",member_id:s.member_id||""}:{name:"",email:"",role:"student",password:"",member_id:""}),g(!0)},M=()=>{const s={...a};s.password||(s.password=void 0),i?x.put(route("admin.users.update",i.id),s,{onSuccess:()=>{g(!1),w(null)}}):x.post(route("admin.users.store"),s,{onSuccess:()=>g(!1)})},_=s=>{confirm("Are you sure you want to delete this user?")&&x.delete(route("admin.users.destroy",s.id))};return e.jsxs(P,{breadcrumbs:V,children:[e.jsx(O,{title:"Manage Users"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"mb-2 flex items-center gap-2 text-2xl font-bold text-gray-900",children:[e.jsx(U,{className:"h-6 w-6 text-blue-600"}),"Manage Users"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:D,className:"flex items-center space-x-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700","aria-label":"Export users as CSV",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Export CSV"})]}),e.jsx("button",{onClick:()=>C(),className:"flex items-center space-x-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700","aria-label":"Add new user",children:e.jsx("span",{children:"Add User"})})]})]}),e.jsx("p",{className:"text-gray-600",children:"Manage students, staff, and librarians in the library system."})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:b,onChange:s=>v(s.target.value),onKeyPress:s=>s.key==="Enter"&&y(),className:"w-full rounded-lg border border-gray-300 py-2 pr-4 pl-10 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"Search users"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("select",{value:h,onChange:s=>{const r=s.target.value;N(r),y(b,r)},className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"Filter by role",children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"librarian",children:"Librarian"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{v(""),N(""),y()},className:"w-full rounded-lg border border-gray-300 px-4 py-2 hover:bg-gray-50","aria-label":"Clear filters",children:"Clear Filters"})})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-6",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Users (",o.total,")"]})}),o.data.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"User"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Role"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Member ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:o.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:s.email}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900 capitalize",children:s.role}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:s.member_id||"N/A"}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap",children:[e.jsx("button",{onClick:()=>C(s),className:"mr-4 text-blue-600 hover:text-blue-900","aria-label":`Edit user ${s.name}`,children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(s),className:"text-red-600 hover:text-red-900","aria-label":`Delete user ${s.name}`,children:e.jsx(q,{className:"h-4 w-4"})})]})]},s.id))})]})}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(U,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),e.jsx("p",{children:"No users found."})]}),o.last_page>1&&e.jsx("div",{className:"flex justify-center space-x-2 p-6",children:o.links.map((s,r)=>e.jsx("button",{onClick:()=>R(s.url),className:`rounded-lg px-4 py-2 ${s.active?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,disabled:!s.url,"aria-label":s.label==="« Previous"?"Previous page":s.label==="Next »"?"Next page":`Go to page ${s.label}`,children:s.label==="« Previous"?"Previous":s.label==="Next »"?"Next":s.label},r))})]}),A&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-6",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-gray-900",children:i?"Edit User":"Add User"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>d({...a,name:s.target.value}),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"User name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",value:a.email,onChange:s=>d({...a,email:s.target.value}),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"User email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("select",{value:a.role,onChange:s=>d({...a,role:s.target.value}),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"User role",children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"librarian",children:"Librarian"})]})]}),a.role==="student"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Member ID"}),e.jsx("input",{type:"text",value:a.member_id,onChange:s=>d({...a,member_id:s.target.value}),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"Student member ID"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Password ",i?"(Optional)":""]}),e.jsx("input",{type:"password",value:a.password,onChange:s=>d({...a,password:s.target.value}),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"User password"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>g(!1),className:"rounded-lg border border-gray-300 px-4 py-2 hover:bg-gray-50","aria-label":"Cancel",children:"Cancel"}),e.jsx("button",{onClick:M,className:"rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700","aria-label":i?"Update user":"Add user",children:i?"Update":"Add"})]})]})}),e.jsx("div",{className:"fixed right-4 bottom-4 z-50 space-y-2",children:k.map(s=>e.jsxs("div",{className:`flex max-w-sm items-center space-x-3 rounded-lg border px-4 py-3 shadow-lg ${s.type==="success"?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-800"}`,children:[s.type==="success"&&e.jsx("div",{className:"h-5 w-5 text-green-600",children:"✔"}),s.type==="error"&&e.jsx(I,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"text-sm font-medium",children:s.message}),e.jsx("button",{onClick:()=>E(s.id),className:"text-gray-400 hover:text-gray-600","aria-label":"Close toast notification",children:"×"})]},s.id))})]})]})}export{ae as default};
