import{r as m,j as e,$ as S,m as g}from"./app-KiXo_k_h.js";import{A as C,U as _,T as k}from"./app-layout-BgEcNBAK.js";import{S as D}from"./scan-BsP3T29D.js";import{S as L}from"./search-CQzR3Gfu.js";import{B as f}from"./chevron-right-BS6E1_9l.js";import{C as T}from"./calendar-D8t0BAEn.js";import{C as p}from"./clock-m8ZAyMD4.js";import"./app-logo-icon-DguhPrG2.js";import"./index-qTwxiHtT.js";import"./index-Dz0iKmGF.js";import"./createLucideIcon-D1T_WgAe.js";const R=[{title:"Dashboard",href:"/dashboard"},{title:"Returns",href:"/librarian/returns"}];function q(j){const{activeTransactions:x}=j,[l,y]=m.useState(""),[a,u]=m.useState(""),[N,i]=m.useState(!1),v=s=>{if(s.preventDefault(),!a.trim())return;const r=x.find(t=>t.book_isbn===a||t.member_id===a||t.id.toString()===a);r?h(r.id):alert("No active transaction found for this scan."),u("")},h=s=>{confirm("Are you sure you want to process this return?")&&(i(!0),g.post(route("librarian.returns.process"),{transaction_id:s},{onSuccess:()=>{i(!1),g.reload({only:["activeTransactions"]}),alert("Book returned successfully!")},onError:()=>{i(!1),alert("Failed to process return. Please try again.")}}))},b=s=>new Date(s).toLocaleDateString(),n=s=>new Date(s.due_date)<new Date,w=s=>{const r=new Date(s),d=new Date().getTime()-r.getTime(),o=Math.ceil(d/(1e3*60*60*24));return o>0?o:0},c=x.filter(s=>{var r,t,d,o;return((r=s.student_name)==null?void 0:r.toLowerCase().includes(l.toLowerCase()))||((t=s.book_title)==null?void 0:t.toLowerCase().includes(l.toLowerCase()))||((d=s.member_id)==null?void 0:d.toLowerCase().includes(l.toLowerCase()))||((o=s.book_isbn)==null?void 0:o.toLowerCase().includes(l.toLowerCase()))});return e.jsxs(C,{breadcrumbs:R,children:[e.jsx(S,{title:"Process Returns"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsx("h1",{className:"mb-2 text-2xl font-bold text-gray-900",children:"Process Returns"}),e.jsx("p",{className:"text-gray-600",children:"Scan books or manually process returns for borrowed items"})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center space-x-3",children:[e.jsx(D,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Return"})]}),e.jsxs("form",{onSubmit:v,className:"flex space-x-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:a,onChange:s=>u(s.target.value),placeholder:"Scan book ISBN, student ID, or enter manually...",className:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-500"})}),e.jsx("button",{type:"submit",disabled:!a.trim()||N,className:"rounded-lg bg-blue-600 px-6 py-3 text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:"Process Return"})]})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"mb-4 flex items-center space-x-3",children:[e.jsx(L,{className:"h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search active transactions...",value:l,onChange:s=>y(s.target.value),className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-6",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Active Transactions (",c.length,")"]})}),c.length>0?e.jsx("div",{className:"divide-y divide-gray-200",children:c.map(s=>e.jsx("div",{className:"p-6 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.student_name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.member_id})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(f,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.book_title}),e.jsx("div",{className:"text-sm text-gray-500",children:s.book_isbn})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Borrowed: ",b(s.borrowed_at)]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(p,{className:"mr-2 h-4 w-4"}),e.jsxs("span",{className:n(s)?"text-red-600":"text-gray-600",children:["Due: ",b(s.due_date),n(s)&&e.jsxs("span",{className:"ml-2 font-medium",children:["(",w(s.due_date)," days overdue)"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[n(s)?e.jsxs("span",{className:"inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800",children:[e.jsx(k,{className:"mr-1 h-3 w-3"}),"Overdue"]}):e.jsxs("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800",children:[e.jsx(p,{className:"mr-1 h-3 w-3"}),"Active"]}),e.jsx("button",{onClick:()=>h(s.id),className:"rounded-lg bg-green-600 px-4 py-2 text-white transition-colors hover:bg-green-700",children:"Process Return"})]})]})},s.id))}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(f,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),e.jsx("p",{children:"No active transactions found."}),e.jsx("p",{className:"mt-1 text-sm",children:"All books have been returned!"})]})]})]})]})}export{q as default};
