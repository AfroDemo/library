import{q as Y,r,j as e,$ as H,m as p}from"./app-B3QjrgfE.js";import{A as J,T as Q}from"./app-layout-DBHVPZfr.js";import{B as E}from"./chevron-right-bRrSZfP4.js";import{D as W}from"./download-peLvOtVv.js";import{S as X}from"./search-DKArdvs_.js";import{S as Z}from"./square-pen-CXEVN1nP.js";import{T as ee}from"./trash-2-Dd7aZBoZ.js";import"./app-logo-icon-BOS49W9v.js";import"./index-CMzxVQNP.js";import"./index--B1BczC_.js";import"./createLucideIcon-Z2OSLAlR.js";const se=[{title:"Dashboard",href:"/dashboard"},{title:"Manage Books",href:"/admin/books"}];function me(){const{books:n,filters:$,shelves:v=[],errors:t,success:y}=Y().props,[N,D]=r.useState($.search||""),[w,O]=r.useState($.available||""),[U,S]=r.useState([]),[F,f]=r.useState(!1),[L,j]=r.useState(!1),[u,k]=r.useState(null),[m,_]=r.useState(null),[a,c]=r.useState({title:"",author:"",isbn:"",shelf_id:"",available:!0}),[i,C]=r.useState({}),[B,h]=r.useState(!1);r.useEffect(()=>{y&&b("success",y),t&&Object.values(t).length>0&&Object.values(t).forEach(s=>b("error",s))},[y,t]);const b=(s,l)=>{const d=Date.now().toString();S(x=>[...x,{type:s,message:l,id:d}]),setTimeout(()=>S(x=>x.filter(g=>g.id!==d)),5e3)},P=s=>{S(l=>l.filter(d=>d.id!==s))},A=()=>{p.get(route("admin.books.index"),{search:N,available:w},{preserveState:!0,replace:!0})},q=s=>{s&&p.get(s,{search:N,available:w},{preserveState:!0})},R=()=>{const l=[["ID","Title","Author","ISBN","Available","Floor","Shelf Number"],...n.data.map(o=>{var T,M;return[o.id,`"${o.title.replace(/"/g,'""')}"`,`"${o.author.replace(/"/g,'""')}"`,o.isbn,o.available?"Yes":"No",((T=o.shelf)==null?void 0:T.floor)||"N/A",((M=o.shelf)==null?void 0:M.shelf_number)||"N/A"]})].map(o=>o.join(",")).join(`
`),d=new Blob([l],{type:"text/csv"}),x=window.URL.createObjectURL(d),g=document.createElement("a");g.href=x,g.download=`books_${new Date().toISOString().split("T")[0]}.csv`,g.click(),window.URL.revokeObjectURL(x)},I=(s=null)=>{var l;k(s),c(s?{title:s.title,author:s.author,isbn:s.isbn,shelf_id:((l=s.shelf)==null?void 0:l.id.toString())||"",available:s.available}:{title:"",author:"",isbn:"",shelf_id:"",available:!0}),C({}),f(!0)},z=()=>{const s={};return a.title.trim()||(s.title="Title is required"),a.author.trim()||(s.author="Author is required"),a.isbn.trim()?a.isbn.length!==10&&(s.isbn="ISBN must be 10 characters"):s.isbn="ISBN is required",C(s),Object.keys(s).length===0},V=()=>{z()&&(h(!0),u?p.put(route("admin.books.update",u.id),a,{onSuccess:()=>{f(!1),k(null),h(!1)},onError:s=>{Object.values(s).forEach(l=>b("error",l)),h(!1)}}):p.post(route("admin.books.store"),a,{onSuccess:()=>{f(!1),h(!1)},onError:s=>{Object.values(s).forEach(l=>b("error",l)),h(!1)}}))},G=s=>{_(s),j(!0)},K=()=>{m&&p.delete(route("admin.books.destroy",m.id),{onSuccess:()=>{j(!1),_(null)},onError:s=>{Object.values(s).forEach(l=>b("error",l)),j(!1)}})};return e.jsxs(J,{breadcrumbs:se,children:[e.jsx(H,{title:"Manage Books"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto p-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col items-center justify-between sm:flex-row",children:[e.jsxs("h1",{className:"mb-2 flex items-center gap-2 text-2xl font-bold text-gray-900",children:[e.jsx(E,{className:"h-6 w-6 text-blue-600"}),"Manage Books"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:R,className:"flex items-center space-x-2 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700","aria-label":"Export books as CSV",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{children:"Export CSV"})]}),e.jsx("button",{onClick:()=>I(),className:"flex items-center space-x-2 rounded-lg bg-green-600 px-4 py-2 text-white transition-colors hover:bg-green-700","aria-label":"Add new book",children:e.jsx("span",{children:"Add Book"})})]})]}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Add, edit, or remove books from the library collection."})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by title, author, or ISBN...",value:N,onChange:s=>D(s.target.value),onKeyPress:s=>s.key==="Enter"&&A(),className:"w-full rounded-lg border border-gray-300 py-2 pr-4 pl-10 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"Search books"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Availability"}),e.jsxs("select",{value:w,onChange:s=>{O(s.target.value),A()},className:"w-full rounded-lg border border-gray-300 px-3 py-2 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"Filter by availability",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"true",children:"Available"}),e.jsx("option",{value:"false",children:"Unavailable"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{D(""),O(""),A()},className:"w-full rounded-lg border border-gray-300 px-4 py-2 transition-colors hover:bg-gray-50","aria-label":"Clear filters",children:"Clear Filters"})})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-6",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Books (",n.total,")"]})}),n.data.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Book"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"ISBN"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Location"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:n.data.map(s=>e.jsxs("tr",{className:"transition-colors hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"mr-3 h-8 w-8 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500",children:s.author})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:s.isbn}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:s.shelf?`${s.shelf.floor}, Shelf ${s.shelf.shelf_number}`:"Not assigned"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.available?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.available?"Available":"Unavailable"})}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap",children:[e.jsx("button",{onClick:()=>I(s),className:"mr-4 text-blue-600 transition-colors hover:text-blue-900","aria-label":`Edit book ${s.title}`,children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>G(s),className:"text-red-600 transition-colors hover:text-red-900","aria-label":`Delete book ${s.title}`,children:e.jsx(ee,{className:"h-4 w-4"})})]})]},s.id))})]})}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(E,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),e.jsx("p",{children:"No books found."})]}),n.last_page>1&&e.jsx("div",{className:"flex justify-center space-x-2 p-6",children:n.links.map((s,l)=>e.jsx("button",{onClick:()=>q(s.url),className:`rounded-lg px-4 py-2 ${s.active?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,disabled:!s.url,"aria-label":s.label==="« Previous"?"Previous page":s.label==="Next »"?"Next page":`Go to page ${s.label}`,children:s.label==="« Previous"?"Previous":s.label==="Next »"?"Next":s.label},l))})]}),F&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-gray-900",children:u?"Edit Book":"Add Book"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",value:a.title,onChange:s=>c({...a,title:s.target.value}),className:`w-full rounded-lg border px-3 py-2 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 ${i.title||t.title?"border-red-500":"border-gray-300"}`,"aria-label":"Book title"}),(i.title||t.title)&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.title||t.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Author"}),e.jsx("input",{type:"text",value:a.author,onChange:s=>c({...a,author:s.target.value}),className:`w-full rounded-lg border px-3 py-2 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 ${i.author||t.author?"border-red-500":"border-gray-300"}`,"aria-label":"Book author"}),(i.author||t.author)&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.author||t.author})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ISBN"}),e.jsx("input",{type:"text",value:a.isbn,onChange:s=>c({...a,isbn:s.target.value}),className:`w-full rounded-lg border px-3 py-2 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 ${i.isbn||t.isbn?"border-red-500":"border-gray-300"}`,"aria-label":"Book ISBN"}),(i.isbn||t.isbn)&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.isbn||t.isbn})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Shelf Location"}),e.jsxs("select",{value:a.shelf_id,onChange:s=>c({...a,shelf_id:s.target.value}),className:`w-full rounded-lg border px-3 py-2 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500 ${t.shelf_id?"border-red-500":"border-gray-300"}`,"aria-label":"Shelf location",children:[e.jsx("option",{value:"",children:"No shelf"}),v&&v.length>0?v.map(s=>e.jsxs("option",{value:s.id,children:[s.floor,", Shelf ",s.shelf_number]},s.id)):e.jsx("option",{value:"",disabled:!0,children:"No shelves available"})]}),t.shelf_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.shelf_id})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.available,onChange:s=>c({...a,available:s.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":"Book availability"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Available"})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{f(!1),k(null),C({})},className:"rounded-lg border border-gray-300 px-4 py-2 transition-colors hover:bg-gray-50","aria-label":"Cancel",children:"Cancel"}),e.jsx("button",{onClick:V,disabled:B,className:`rounded-lg px-4 py-2 text-white transition-colors ${B?"cursor-not-allowed bg-blue-400":"bg-blue-600 hover:bg-blue-700"}`,"aria-label":u?"Update book":"Add book",children:B?"Submitting...":u?"Update":"Add"})]})]})}),L&&m&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-gray-900",children:"Confirm Delete"}),e.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to delete ",e.jsx("span",{className:"font-semibold",children:m.title}),"?"]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>j(!1),className:"rounded-lg border border-gray-300 px-4 py-2 transition-colors hover:bg-gray-50","aria-label":"Cancel delete",children:"Cancel"}),e.jsx("button",{onClick:K,className:"rounded-lg bg-red-600 px-4 py-2 text-white transition-colors hover:bg-red-700","aria-label":`Delete book ${m.title}`,children:"Delete"})]})]})}),e.jsx("div",{className:"fixed right-4 bottom-4 z-50 space-y-2",children:U.map(s=>e.jsxs("div",{className:`flex max-w-sm items-center space-x-3 rounded-lg border px-4 py-3 shadow-lg ${s.type==="success"?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-800"}`,children:[s.type==="success"&&e.jsx("div",{className:"h-5 w-5 text-green-600",children:"✔"}),s.type==="error"&&e.jsx(Q,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"text-sm font-medium",children:s.message}),e.jsx("button",{onClick:()=>P(s.id),className:"text-gray-400 hover:text-gray-600","aria-label":"Close toast notification",children:"×"})]},s.id))})]})]})}export{me as default};
