import{q as F,r as a,j as e,$ as D,m as S}from"./app-B3QjrgfE.js";import{A as L,T as X}from"./app-layout-DBHVPZfr.js";import{B as h}from"./chevron-right-bRrSZfP4.js";import{C as G}from"./circle-check-big-SvkpkOEO.js";import{c as K}from"./createLucideIcon-Z2OSLAlR.js";import"./app-logo-icon-BOS49W9v.js";import"./index-CMzxVQNP.js";import"./index--B1BczC_.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],V=K("CircleX",U),H=[{title:"Dashboard",href:"/dashboard"},{title:"Extension Requests",href:"/librarian/extension-requests"}];function ae(){const{extensionRequests:l,filters:R,errors:d,success:u}=F().props,[g,_]=a.useState(R.search||""),[b,A]=a.useState(R.status||""),[M,f]=a.useState([]),[q,y]=a.useState(!1),[$,j]=a.useState(!1),[t,c]=a.useState(null),[o,N]=a.useState(!1);a.useEffect(()=>{u&&v("success",u),d&&Object.values(d).length>0&&Object.values(d).forEach(s=>v("error",s))},[u,d]);const v=(s,r)=>{const i=Date.now().toString();f(C=>[...C,{type:s,message:r,id:i}]),setTimeout(()=>f(C=>C.filter(I=>I.id!==i)),5e3)},O=s=>{f(r=>r.filter(i=>i.id!==s))},w=()=>{S.get(route("librarian.extension-requests"),{search:g,status:b},{preserveState:!0,replace:!0})},B=s=>{S.get(route("librarian.extension-requests"),{search:g,status:b,page:s},{preserveState:!0,replace:!0})},T=s=>{c(s),y(!0)},z=s=>{c(s),j(!0)},P=s=>{t&&(N(!0),S.post(route("transactions.extension.process",t.id),{status:s},{onSuccess:()=>{y(!1),j(!1),c(null),N(!1)},onError:r=>{Object.values(r).forEach(i=>v("error",i)),N(!1)}}))},x=[],n=l.current_page,E=l.last_page,p=5;let m=Math.max(1,n-Math.floor(p/2)),k=Math.min(E,m+p-1);k-m+1<p&&(m=Math.max(1,k-p+1)),n>1&&x.push({label:"Previous",page:n-1,active:!1});for(let s=m;s<=k;s++)x.push({label:s.toString(),page:s,active:s===n});return n<E&&x.push({label:"Next",page:n+1,active:!1}),e.jsxs(L,{breadcrumbs:H,children:[e.jsx(D,{title:"Manage Extension Requests"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto p-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"flex flex-col items-center justify-between sm:flex-row",children:e.jsxs("h1",{className:"mb-2 flex items-center gap-2 text-2xl font-bold text-gray-900",children:[e.jsx(h,{className:"h-6 w-6 text-blue-600"}),"Manage Extension Requests"]})}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Review and process extension requests for borrowed books."})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by book title, ISBN, or student name...",value:g,onChange:s=>_(s.target.value),onKeyPress:s=>s.key==="Enter"&&w(),className:"w-full rounded-lg border border-gray-300 py-2 pr-4 pl-10 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"Search extension requests"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{value:b,onChange:s=>{A(s.target.value),w()},className:"w-full rounded-lg border border-gray-300 px-3 py-2 transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-500","aria-label":"Filter by status",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{_(""),A(""),w()},className:"w-full rounded-lg border border-gray-300 px-4 py-2 transition-colors hover:bg-gray-50","aria-label":"Clear filters",children:"Clear Filters"})})]})}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-gray-200 p-6",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Extension Requests (",l.total,")"]})}),l.data.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Book"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Student"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Requested Days"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Requested At"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Processed By"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:l.data.map(s=>e.jsxs("tr",{className:"transition-colors hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{className:"mr-3 h-8 w-8 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.book_title}),e.jsx("div",{className:"text-sm text-gray-500",children:s.book_isbn})]})]})}),e.jsxs("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:[s.student_name," (",s.member_id,")"]}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:s.requested_days}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.status==="pending"?"bg-yellow-100 text-yellow-800":s.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:s.created_at}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:s.processed_by}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap",children:s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>T(s),className:"mr-4 text-green-600 transition-colors hover:text-green-900","aria-label":`Approve extension request for ${s.book_title}`,children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(s),className:"text-red-600 transition-colors hover:text-red-900","aria-label":`Reject extension request for ${s.book_title}`,children:e.jsx(V,{className:"h-4 w-4"})})]})})]},s.id))})]})}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(h,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),e.jsx("p",{children:"No extension requests found."})]}),l.last_page>1&&e.jsx("div",{className:"flex justify-center space-x-2 p-6",children:x.map((s,r)=>e.jsx("button",{onClick:()=>B(s.page),className:`rounded-lg px-4 py-2 ${s.active?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,disabled:s.active,"aria-label":s.label==="Previous"?"Previous page":s.label==="Next"?"Next page":`Go to page ${s.label}`,children:s.label},r))})]}),q&&t&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-gray-900",children:"Confirm Approve Extension"}),e.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to approve the extension request for"," ",e.jsx("span",{className:"font-semibold",children:t.book_title})," by"," ",e.jsx("span",{className:"font-semibold",children:t.student_name})," for"," ",e.jsx("span",{className:"font-semibold",children:t.requested_days})," days?"]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{y(!1),c(null)},className:"rounded-lg border border-gray-300 px-4 py-2 transition-colors hover:bg-gray-50","aria-label":"Cancel",children:"Cancel"}),e.jsx("button",{onClick:()=>P("approved"),disabled:o,className:`rounded-lg px-4 py-2 text-white transition-colors ${o?"cursor-not-allowed bg-green-400":"bg-green-600 hover:bg-green-700"}`,"aria-label":"Approve extension",children:o?"Processing...":"Approve"})]})]})}),$&&t&&e.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-gray-900",children:"Confirm Reject Extension"}),e.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to reject the extension request for"," ",e.jsx("span",{className:"font-semibold",children:t.book_title})," by"," ",e.jsx("span",{className:"font-semibold",children:t.student_name})," for"," ",e.jsx("span",{className:"font-semibold",children:t.requested_days})," days?"]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{j(!1),c(null)},className:"rounded-lg border border-gray-300 px-4 py-2 transition-colors hover:bg-gray-50","aria-label":"Cancel",children:"Cancel"}),e.jsx("button",{onClick:()=>P("rejected"),disabled:o,className:`rounded-lg px-4 py-2 text-white transition-colors ${o?"cursor-not-allowed bg-red-400":"bg-red-600 hover:bg-red-700"}`,"aria-label":"Reject extension",children:o?"Processing...":"Reject"})]})]})}),e.jsx("div",{className:"fixed right-4 bottom-4 z-50 space-y-2",children:M.map(s=>e.jsxs("div",{className:`flex max-w-sm items-center space-x-3 rounded-lg border px-4 py-3 shadow-lg ${s.type==="success"?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-800"}`,children:[s.type==="success"&&e.jsx("div",{className:"h-5 w-5 text-green-600",children:"✔"}),s.type==="error"&&e.jsx(X,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"text-sm font-medium",children:s.message}),e.jsx("button",{onClick:()=>O(s.id),className:"text-gray-400 hover:text-gray-600","aria-label":"Close toast notification",children:"×"})]},s.id))})]})]})}export{ae as default};
