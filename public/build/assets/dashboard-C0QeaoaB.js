import{c as Gn,g as Si,q as Ni,r as He,v as Mr,j as y,$ as Ti,m as hr}from"./app-DCuZLIiR.js";import{A as _i,U as vr}from"./app-layout-CxSrBOU3.js";import{T as Ri}from"./trending-up-q3KU2li_.js";import{C as Oi}from"./clock-rXkSNBR3.js";import{C as gn}from"./circle-check-big-Opi59qMb.js";import{S as Di}from"./scan-nr7799vg.js";import{c as jr}from"./createLucideIcon-B80Gj0Dh.js";import{T as Mi}from"./trash-2-Cb7_oVag.js";import{B as fr}from"./chevron-right-MvP6eIpt.js";import"./app-logo-icon-l4AutvGA.js";import"./index-DWDx7uJa.js";import"./index-Bq50F9d8.js";function vi(w,x){for(var u=0;u<x.length;u++){const E=x[u];if(typeof E!="string"&&!Array.isArray(E)){for(const p in E)if(p!=="default"&&!(p in w)){const g=Object.getOwnPropertyDescriptor(E,p);g&&Object.defineProperty(w,p,g.get?g:{enumerable:!0,get:()=>E[p]})}}}return Object.freeze(Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}))}/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],_n=jr("CircleAlert",Bi);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Rn=jr("RefreshCw",Pi);var j;(function(w){w[w.QR_CODE=0]="QR_CODE",w[w.AZTEC=1]="AZTEC",w[w.CODABAR=2]="CODABAR",w[w.CODE_39=3]="CODE_39",w[w.CODE_93=4]="CODE_93",w[w.CODE_128=5]="CODE_128",w[w.DATA_MATRIX=6]="DATA_MATRIX",w[w.MAXICODE=7]="MAXICODE",w[w.ITF=8]="ITF",w[w.EAN_13=9]="EAN_13",w[w.EAN_8=10]="EAN_8",w[w.PDF_417=11]="PDF_417",w[w.RSS_14=12]="RSS_14",w[w.RSS_EXPANDED=13]="RSS_EXPANDED",w[w.UPC_A=14]="UPC_A",w[w.UPC_E=15]="UPC_E",w[w.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(j||(j={}));var Br=new Map([[j.QR_CODE,"QR_CODE"],[j.AZTEC,"AZTEC"],[j.CODABAR,"CODABAR"],[j.CODE_39,"CODE_39"],[j.CODE_93,"CODE_93"],[j.CODE_128,"CODE_128"],[j.DATA_MATRIX,"DATA_MATRIX"],[j.MAXICODE,"MAXICODE"],[j.ITF,"ITF"],[j.EAN_13,"EAN_13"],[j.EAN_8,"EAN_8"],[j.PDF_417,"PDF_417"],[j.RSS_14,"RSS_14"],[j.RSS_EXPANDED,"RSS_EXPANDED"],[j.UPC_A,"UPC_A"],[j.UPC_E,"UPC_E"],[j.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Pr;(function(w){w[w.UNKNOWN=0]="UNKNOWN",w[w.URL=1]="URL"})(Pr||(Pr={}));function Li(w){return Object.values(j).includes(w)}var Wn;(function(w){w[w.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",w[w.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Wn||(Wn={}));var Fi=function(){function w(){}return w.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",w.SCAN_DEFAULT_FPS=2,w.DEFAULT_DISABLE_FLIP=!1,w.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,w.DEFAULT_SUPPORTED_SCAN_TYPE=[Wn.SCAN_TYPE_CAMERA,Wn.SCAN_TYPE_FILE],w}(),Yr=function(){function w(x,u){this.format=x,this.formatName=u}return w.prototype.toString=function(){return this.formatName},w.create=function(x){if(!Br.has(x))throw"".concat(x," not in html5QrcodeSupportedFormatsTextMap");return new w(x,Br.get(x))},w}(),Lr=function(){function w(){}return w.createFromText=function(x){var u={text:x};return{decodedText:x,result:u}},w.createFromQrcodeResult=function(x){return{decodedText:x.text,result:x}},w}(),dr;(function(w){w[w.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",w[w.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",w[w.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(dr||(dr={}));var ki=function(){function w(){}return w.createFrom=function(x){return{errorMessage:x,type:dr.UNKWOWN_ERROR}},w}(),Ui=function(){function w(x){this.verbose=x}return w.prototype.log=function(x){this.verbose&&console.log(x)},w.prototype.warn=function(x){this.verbose&&console.warn(x)},w.prototype.logError=function(x,u){(this.verbose||u===!0)&&console.error(x)},w.prototype.logErrors=function(x){if(x.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(x)},w}();function kt(w){return typeof w>"u"||w===null}var wn=function(){function w(){}return w.codeParseError=function(x){return"QR code parse error, error = ".concat(x)},w.errorGettingUserMedia=function(x){return"Error getting userMedia, error = ".concat(x)},w.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},w.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},w.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},w.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},w.scannerPaused=function(){return"Scanner paused"},w}(),zr=function(){function w(){}return w.isMediaStreamConstraintsValid=function(x,u){if(typeof x!="object"){var E=typeof x;return u.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(E,"."),!0),!1}for(var p=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],g=new Set(p),R=Object.keys(x),V=0,B=R;V<B.length;V++){var C=B[V];if(g.has(C))return u.logError("".concat(C," is not supported videoConstaints."),!0),!1}return!0},w}(),On={exports:{}},Vi=On.exports,Fr;function Gi(){return Fr||(Fr=1,function(w,x){(function(u,E){E(x)})(Vi,function(u){function E(h){return h==null}var p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,e){h.__proto__=e}||function(h,e){for(var t in e)e.hasOwnProperty(t)&&(h[t]=e[t])};function g(h,e){p(h,e);function t(){this.constructor=h}h.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function R(h,e){var t=Object.setPrototypeOf;t?t(h,e):h.__proto__=e}function V(h,e){e===void 0&&(e=h.constructor);var t=Error.captureStackTrace;t&&t(h,e)}var B=function(h){g(e,h);function e(t){var n=this.constructor,r=h.call(this,t)||this;return Object.defineProperty(r,"name",{value:n.name,enumerable:!1}),R(r,n.prototype),V(r),r}return e}(Error);class C extends B{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}C.kind="Exception";class L extends C{}L.kind="ArgumentException";class D extends C{}D.kind="IllegalArgumentException";class ue{constructor(e){if(this.binarizer=e,e===null)throw new D("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,n,r){const i=this.binarizer.getLuminanceSource().crop(e,t,n,r);return new ue(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new ue(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new ue(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class re extends C{static getChecksumInstance(){return new re}}re.kind="ChecksumException";class Qe{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class ne{static arraycopy(e,t,n,r,i){for(;i--;)n[r++]=e[t++]}static currentTimeMillis(){return Date.now()}}class lt extends C{}lt.kind="IndexOutOfBoundsException";class rt extends lt{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}rt.kind="ArrayIndexOutOfBoundsException";class pe{static fill(e,t){for(let n=0,r=e.length;n<r;n++)e[n]=t}static fillWithin(e,t,n,r){pe.rangeCheck(e.length,t,n);for(let i=t;i<n;i++)e[i]=r}static rangeCheck(e,t,n){if(t>n)throw new D("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new rt(t);if(n>e)throw new rt(n)}static asList(...e){return e}static create(e,t,n){return Array.from({length:e}).map(i=>Array.from({length:t}).fill(n))}static createInt32Array(e,t,n){return Array.from({length:e}).map(i=>Int32Array.from({length:t}).fill(n))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const n of e)t=31*t+n;return t}static fillUint8Array(e,t){for(let n=0;n!==e.length;n++)e[n]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)}static copyOfRange(e,t,n){const r=n-t,i=new Int32Array(r);return ne.arraycopy(e,t,i,0,r),i}static binarySearch(e,t,n){n===void 0&&(n=pe.numberComparator);let r=0,i=e.length-1;for(;r<=i;){const s=i+r>>1,a=n(t,e[s]);if(a>0)r=s+1;else if(a<0)i=s-1;else return s}return-r-1}static numberComparator(e,t){return e-t}}class ${static numberOfTrailingZeros(e){let t;if(e===0)return 32;let n=31;return t=e<<16,t!==0&&(n-=16,e=t),t=e<<8,t!==0&&(n-=8,e=t),t=e<<4,t!==0&&(n-=4,e=t),t=e<<2,t!==0&&(n-=2,e=t),n-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}$.MIN_VALUE_32_BITS=-2147483648,$.MAX_VALUE=Number.MAX_SAFE_INTEGER;class oe{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=oe.makeArray(e):this.bits=t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const t=oe.makeArray(e);ne.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=n[r];i&=~((1<<(e&31))-1);const s=n.length;for(;i===0;){if(++r===s)return t;i=n[r]}const a=r*32+$.numberOfTrailingZeros(i);return a>t?t:a}getNextUnset(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=~n[r];i&=~((1<<(e&31))-1);const s=n.length;for(;i===0;){if(++r===s)return t;i=~n[r]}const a=r*32+$.numberOfTrailingZeros(i);return a>t?t:a}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new D;if(t===e)return;t--;const n=Math.floor(e/32),r=Math.floor(t/32),i=this.bits;for(let s=n;s<=r;s++){const a=s>n?0:e&31,l=(2<<(s<r?31:t&31))-(1<<a);i[s]|=l}}clear(){const e=this.bits.length,t=this.bits;for(let n=0;n<e;n++)t[n]=0}isRange(e,t,n){if(t<e||e<0||t>this.size)throw new D;if(t===e)return!0;t--;const r=Math.floor(e/32),i=Math.floor(t/32),s=this.bits;for(let a=r;a<=i;a++){const o=a>r?0:e&31,c=(2<<(a<i?31:t&31))-(1<<o)&4294967295;if((s[a]&c)!==(n?c:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,t){if(t<0||t>32)throw new D("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let n=t;n>0;n--)this.appendBit((e>>n-1&1)===1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let n=0;n<t;n++)this.appendBit(e.get(n))}xor(e){if(this.size!==e.size)throw new D("Sizes don't match");const t=this.bits;for(let n=0,r=t.length;n<r;n++)t[n]^=e.bits[n]}toBytes(e,t,n,r){for(let i=0;i<r;i++){let s=0;for(let a=0;a<8;a++)this.get(e)&&(s|=1<<7-a),e++;t[n+i]=s}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,r=this.bits;for(let i=0;i<n;i++){let s=r[i];s=s>>1&1431655765|(s&1431655765)<<1,s=s>>2&858993459|(s&858993459)<<2,s=s>>4&252645135|(s&252645135)<<4,s=s>>8&16711935|(s&16711935)<<8,s=s>>16&65535|(s&65535)<<16,e[t-i]=s}if(this.size!==n*32){const i=n*32-this.size;let s=e[0]>>>i;for(let a=1;a<n;a++){const o=e[a];s|=o<<32-i,e[a-1]=s,s=o>>>i}e[n-1]=s}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof oe))return!1;const t=e;return this.size===t.size&&pe.equals(this.bits,t.bits)}hashCode(){return 31*this.size+pe.hashCode(this.bits)}toString(){let e="";for(let t=0,n=this.size;t<n;t++)(t&7)===0&&(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new oe(this.size,this.bits.slice())}}var Je;(function(h){h[h.OTHER=0]="OTHER",h[h.PURE_BARCODE=1]="PURE_BARCODE",h[h.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",h[h.TRY_HARDER=3]="TRY_HARDER",h[h.CHARACTER_SET=4]="CHARACTER_SET",h[h.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",h[h.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",h[h.ASSUME_GS1=7]="ASSUME_GS1",h[h.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",h[h.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",h[h.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Je||(Je={}));var le=Je;class G extends C{static getFormatInstance(){return new G}}G.kind="FormatException";var ge;(function(h){h[h.Cp437=0]="Cp437",h[h.ISO8859_1=1]="ISO8859_1",h[h.ISO8859_2=2]="ISO8859_2",h[h.ISO8859_3=3]="ISO8859_3",h[h.ISO8859_4=4]="ISO8859_4",h[h.ISO8859_5=5]="ISO8859_5",h[h.ISO8859_6=6]="ISO8859_6",h[h.ISO8859_7=7]="ISO8859_7",h[h.ISO8859_8=8]="ISO8859_8",h[h.ISO8859_9=9]="ISO8859_9",h[h.ISO8859_10=10]="ISO8859_10",h[h.ISO8859_11=11]="ISO8859_11",h[h.ISO8859_13=12]="ISO8859_13",h[h.ISO8859_14=13]="ISO8859_14",h[h.ISO8859_15=14]="ISO8859_15",h[h.ISO8859_16=15]="ISO8859_16",h[h.SJIS=16]="SJIS",h[h.Cp1250=17]="Cp1250",h[h.Cp1251=18]="Cp1251",h[h.Cp1252=19]="Cp1252",h[h.Cp1256=20]="Cp1256",h[h.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",h[h.UTF8=22]="UTF8",h[h.ASCII=23]="ASCII",h[h.Big5=24]="Big5",h[h.GB18030=25]="GB18030",h[h.EUC_KR=26]="EUC_KR"})(ge||(ge={}));class U{constructor(e,t,n,...r){this.valueIdentifier=e,this.name=n,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=r,U.VALUE_IDENTIFIER_TO_ECI.set(e,this),U.NAME_TO_ECI.set(n,this);const i=this.values;for(let s=0,a=i.length;s!==a;s++){const o=i[s];U.VALUES_TO_ECI.set(o,this)}for(const s of r)U.NAME_TO_ECI.set(s,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new G("incorect value");const t=U.VALUES_TO_ECI.get(e);if(t===void 0)throw new G("incorect value");return t}static getCharacterSetECIByName(e){const t=U.NAME_TO_ECI.get(e);if(t===void 0)throw new G("incorect value");return t}equals(e){if(!(e instanceof U))return!1;const t=e;return this.getName()===t.getName()}}U.VALUE_IDENTIFIER_TO_ECI=new Map,U.VALUES_TO_ECI=new Map,U.NAME_TO_ECI=new Map,U.Cp437=new U(ge.Cp437,Int32Array.from([0,2]),"Cp437"),U.ISO8859_1=new U(ge.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),U.ISO8859_2=new U(ge.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),U.ISO8859_3=new U(ge.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),U.ISO8859_4=new U(ge.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),U.ISO8859_5=new U(ge.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),U.ISO8859_6=new U(ge.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),U.ISO8859_7=new U(ge.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),U.ISO8859_8=new U(ge.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),U.ISO8859_9=new U(ge.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),U.ISO8859_10=new U(ge.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),U.ISO8859_11=new U(ge.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),U.ISO8859_13=new U(ge.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),U.ISO8859_14=new U(ge.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),U.ISO8859_15=new U(ge.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),U.ISO8859_16=new U(ge.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),U.SJIS=new U(ge.SJIS,20,"SJIS","Shift_JIS"),U.Cp1250=new U(ge.Cp1250,21,"Cp1250","windows-1250"),U.Cp1251=new U(ge.Cp1251,22,"Cp1251","windows-1251"),U.Cp1252=new U(ge.Cp1252,23,"Cp1252","windows-1252"),U.Cp1256=new U(ge.Cp1256,24,"Cp1256","windows-1256"),U.UnicodeBigUnmarked=new U(ge.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),U.UTF8=new U(ge.UTF8,26,"UTF8","UTF-8"),U.ASCII=new U(ge.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),U.Big5=new U(ge.Big5,28,"Big5"),U.GB18030=new U(ge.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),U.EUC_KR=new U(ge.EUC_KR,30,"EUC_KR","EUC-KR");class gt extends C{}gt.kind="UnsupportedOperationException";class We{static decode(e,t){const n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)}static shouldDecodeOnFallback(e){return!We.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof U?e:U.getCharacterSetECIByName(e)}static decodeFallback(e,t){const n=this.encodingCharacterSet(t);if(We.isDecodeFallbackSupported(n)){let r="";for(let i=0,s=e.length;i<s;i++){let a=e[i].toString(16);a.length<2&&(a="0"+a),r+="%"+a}return decodeURIComponent(r)}if(n.equals(U.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new gt(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(U.UTF8)||e.equals(U.ISO8859_1)||e.equals(U.ASCII)}static encodeFallback(e){const n=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let i=0;i<n.length;i++)r.push(n[i].charCodeAt(0));return new Uint8Array(r)}}class Q{static castAsNonUtf8Char(e,t=null){const n=t?t.getName():this.ISO88591;return We.decode(new Uint8Array([e]),n)}static guessEncoding(e,t){if(t!=null&&t.get(le.CHARACTER_SET)!==void 0)return t.get(le.CHARACTER_SET).toString();const n=e.length;let r=!0,i=!0,s=!0,a=0,o=0,l=0,c=0,f=0,d=0,A=0,b=0,I=0,S=0,_=0;const F=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let k=0;k<n&&(r||i||s);k++){const P=e[k]&255;s&&(a>0?(P&128)===0?s=!1:a--:(P&128)!==0&&((P&64)===0?s=!1:(a++,(P&32)===0?o++:(a++,(P&16)===0?l++:(a++,(P&8)===0?c++:s=!1))))),r&&(P>127&&P<160?r=!1:P>159&&(P<192||P===215||P===247)&&_++),i&&(f>0?P<64||P===127||P>252?i=!1:f--:P===128||P===160||P>239?i=!1:P>160&&P<224?(d++,b=0,A++,A>I&&(I=A)):P>127?(f++,A=0,b++,b>S&&(S=b)):(A=0,b=0))}return s&&a>0&&(s=!1),i&&f>0&&(i=!1),s&&(F||o+l+c>0)?Q.UTF8:i&&(Q.ASSUME_SHIFT_JIS||I>=3||S>=3)?Q.SHIFT_JIS:r&&i?I===2&&d===2||_*10>=n?Q.SHIFT_JIS:Q.ISO88591:r?Q.ISO88591:i?Q.SHIFT_JIS:s?Q.UTF8:Q.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let n=-1;function r(s,a,o,l,c,f){if(s==="%%")return"%";if(t[++n]===void 0)return;s=l?parseInt(l.substr(1)):void 0;let d=c?parseInt(c.substr(1)):void 0,A;switch(f){case"s":A=t[n];break;case"c":A=t[n][0];break;case"f":A=parseFloat(t[n]).toFixed(s);break;case"p":A=parseFloat(t[n]).toPrecision(s);break;case"e":A=parseFloat(t[n]).toExponential(s);break;case"x":A=parseInt(t[n]).toString(d||16);break;case"d":A=parseFloat(parseInt(t[n],d||10).toPrecision(s)).toFixed(0);break}A=typeof A=="object"?JSON.stringify(A):(+A).toString(d);let b=parseInt(o),I=o&&o[0]+""=="0"?"0":" ";for(;A.length<b;)A=a!==void 0?A+I:I+A;return A}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}static getBytes(e,t){return We.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}Q.SHIFT_JIS=U.SJIS.getName(),Q.GB2312="GB2312",Q.ISO88591=U.ISO8859_1.getName(),Q.EUC_JP="EUC_JP",Q.UTF8=U.UTF8.getName(),Q.PLATFORM_DEFAULT_ENCODING=Q.UTF8,Q.ASSUME_SHIFT_JIS=!1;class de{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=Q.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,n){for(let r=t;t<t+n;r++)this.append(e[r]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class Re{constructor(e,t,n,r){if(this.width=e,this.height=t,this.rowSize=n,this.bits=r,t==null&&(t=e),this.height=t,e<1||t<1)throw new D("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,r==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,n=e[0].length,r=new Re(n,t);for(let i=0;i<t;i++){const s=e[i];for(let a=0;a<n;a++)s[a]&&r.set(a,i)}return r}static parseFromString(e,t,n){if(e===null)throw new D("stringRepresentation cannot be null");const r=new Array(e.length);let i=0,s=0,a=-1,o=0,l=0;for(;l<e.length;)if(e.charAt(l)===`
`||e.charAt(l)==="\r"){if(i>s){if(a===-1)a=i-s;else if(i-s!==a)throw new D("row lengths do not match");s=i,o++}l++}else if(e.substring(l,l+t.length)===t)l+=t.length,r[i]=!0,i++;else if(e.substring(l,l+n.length)===n)l+=n.length,r[i]=!1,i++;else throw new D("illegal character encountered: "+e.substring(l));if(i>s){if(a===-1)a=i-s;else if(i-s!==a)throw new D("row lengths do not match");o++}const c=new Re(a,o);for(let f=0;f<i;f++)r[f]&&c.set(Math.floor(f%a),Math.floor(f/a));return c}get(e,t){const n=t*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0}set(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295}unset(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)}flip(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new D("input matrix dimensions do not match");const t=new oe(Math.floor(this.width/32)+1),n=this.rowSize,r=this.bits;for(let i=0,s=this.height;i<s;i++){const a=i*n,o=e.getRow(i,t).getBitArray();for(let l=0;l<n;l++)r[a+l]^=o[l]}}clear(){const e=this.bits,t=e.length;for(let n=0;n<t;n++)e[n]=0}setRegion(e,t,n,r){if(t<0||e<0)throw new D("Left and top must be nonnegative");if(r<1||n<1)throw new D("Height and width must be at least 1");const i=e+n,s=t+r;if(s>this.height||i>this.width)throw new D("The region must fit inside the matrix");const a=this.rowSize,o=this.bits;for(let l=t;l<s;l++){const c=l*a;for(let f=e;f<i;f++)o[c+Math.floor(f/32)]|=1<<(f&31)&4294967295}}getRow(e,t){t==null||t.getSize()<this.width?t=new oe(this.width):t.clear();const n=this.rowSize,r=this.bits,i=e*n;for(let s=0;s<n;s++)t.setBulk(s*32,r[i+s]);return t}setRow(e,t){ne.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let n=new oe(e),r=new oe(e);for(let i=0,s=Math.floor((t+1)/2);i<s;i++)n=this.getRow(i,n),r=this.getRow(t-1-i,r),n.reverse(),r.reverse(),this.setRow(i,r),this.setRow(t-1-i,n)}getEnclosingRectangle(){const e=this.width,t=this.height,n=this.rowSize,r=this.bits;let i=e,s=t,a=-1,o=-1;for(let l=0;l<t;l++)for(let c=0;c<n;c++){const f=r[l*n+c];if(f!==0){if(l<s&&(s=l),l>o&&(o=l),c*32<i){let d=0;for(;(f<<31-d&4294967295)===0;)d++;c*32+d<i&&(i=c*32+d)}if(c*32+31>a){let d=31;for(;!(f>>>d);)d--;c*32+d>a&&(a=c*32+d)}}}return a<i||o<s?null:Int32Array.from([i,s,a-i+1,o-s+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let n=0;for(;n<t.length&&t[n]===0;)n++;if(n===t.length)return null;const r=n/e;let i=n%e*32;const s=t[n];let a=0;for(;(s<<31-a&4294967295)===0;)a++;return i+=a,Int32Array.from([i,r])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let n=t.length-1;for(;n>=0&&t[n]===0;)n--;if(n<0)return null;const r=Math.floor(n/e);let i=Math.floor(n%e)*32;const s=t[n];let a=31;for(;!(s>>>a);)a--;return i+=a,Int32Array.from([i,r])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof Re))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&pe.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+pe.hashCode(this.bits),e}toString(e="X ",t="  ",n=`
`){return this.buildToString(e,t,n)}buildToString(e,t,n){let r=new de;for(let i=0,s=this.height;i<s;i++){for(let a=0,o=this.width;a<o;a++)r.append(this.get(a,i)?e:t);r.append(n)}return r.toString()}clone(){return new Re(this.width,this.height,this.rowSize,this.bits.slice())}}class O extends C{static getNotFoundInstance(){return new O}}O.kind="NotFoundException";class Ne extends Qe{constructor(e){super(e),this.luminances=Ne.EMPTY,this.buckets=new Int32Array(Ne.LUMINANCE_BUCKETS)}getBlackRow(e,t){const n=this.getLuminanceSource(),r=n.getWidth();t==null||t.getSize()<r?t=new oe(r):t.clear(),this.initArrays(r);const i=n.getRow(e,this.luminances),s=this.buckets;for(let o=0;o<r;o++)s[(i[o]&255)>>Ne.LUMINANCE_SHIFT]++;const a=Ne.estimateBlackPoint(s);if(r<3)for(let o=0;o<r;o++)(i[o]&255)<a&&t.set(o);else{let o=i[0]&255,l=i[1]&255;for(let c=1;c<r-1;c++){const f=i[c+1]&255;(l*4-o-f)/2<a&&t.set(c),o=l,l=f}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight(),r=new Re(t,n);this.initArrays(t);const i=this.buckets;for(let o=1;o<5;o++){const l=Math.floor(n*o/5),c=e.getRow(l,this.luminances),f=Math.floor(t*4/5);for(let d=Math.floor(t/5);d<f;d++){const A=c[d]&255;i[A>>Ne.LUMINANCE_SHIFT]++}}const s=Ne.estimateBlackPoint(i),a=e.getMatrix();for(let o=0;o<n;o++){const l=o*t;for(let c=0;c<t;c++)(a[l+c]&255)<s&&r.set(c,o)}return r}createBinarizer(e){return new Ne(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let n=0;n<Ne.LUMINANCE_BUCKETS;n++)t[n]=0}static estimateBlackPoint(e){const t=e.length;let n=0,r=0,i=0;for(let c=0;c<t;c++)e[c]>i&&(r=c,i=e[c]),e[c]>n&&(n=e[c]);let s=0,a=0;for(let c=0;c<t;c++){const f=c-r,d=e[c]*f*f;d>a&&(s=c,a=d)}if(r>s){const c=r;r=s,s=c}if(s-r<=t/16)throw new O;let o=s-1,l=-1;for(let c=s-1;c>r;c--){const f=c-r,d=f*f*(s-c)*(n-e[c]);d>l&&(o=c,l=d)}return o<<Ne.LUMINANCE_SHIFT}}Ne.LUMINANCE_BITS=5,Ne.LUMINANCE_SHIFT=8-Ne.LUMINANCE_BITS,Ne.LUMINANCE_BUCKETS=1<<Ne.LUMINANCE_BITS,Ne.EMPTY=Uint8ClampedArray.from([0]);class te extends Ne{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight();if(t>=te.MINIMUM_DIMENSION&&n>=te.MINIMUM_DIMENSION){const r=e.getMatrix();let i=t>>te.BLOCK_SIZE_POWER;(t&te.BLOCK_SIZE_MASK)!==0&&i++;let s=n>>te.BLOCK_SIZE_POWER;(n&te.BLOCK_SIZE_MASK)!==0&&s++;const a=te.calculateBlackPoints(r,i,s,t,n),o=new Re(t,n);te.calculateThresholdForBlock(r,i,s,t,n,a,o),this.matrix=o}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new te(e)}static calculateThresholdForBlock(e,t,n,r,i,s,a){const o=i-te.BLOCK_SIZE,l=r-te.BLOCK_SIZE;for(let c=0;c<n;c++){let f=c<<te.BLOCK_SIZE_POWER;f>o&&(f=o);const d=te.cap(c,2,n-3);for(let A=0;A<t;A++){let b=A<<te.BLOCK_SIZE_POWER;b>l&&(b=l);const I=te.cap(A,2,t-3);let S=0;for(let F=-2;F<=2;F++){const k=s[d+F];S+=k[I-2]+k[I-1]+k[I]+k[I+1]+k[I+2]}const _=S/25;te.thresholdBlock(e,b,f,_,r,a)}}}static cap(e,t,n){return e<t?t:e>n?n:e}static thresholdBlock(e,t,n,r,i,s){for(let a=0,o=n*i+t;a<te.BLOCK_SIZE;a++,o+=i)for(let l=0;l<te.BLOCK_SIZE;l++)(e[o+l]&255)<=r&&s.set(t+l,n+a)}static calculateBlackPoints(e,t,n,r,i){const s=i-te.BLOCK_SIZE,a=r-te.BLOCK_SIZE,o=new Array(n);for(let l=0;l<n;l++){o[l]=new Int32Array(t);let c=l<<te.BLOCK_SIZE_POWER;c>s&&(c=s);for(let f=0;f<t;f++){let d=f<<te.BLOCK_SIZE_POWER;d>a&&(d=a);let A=0,b=255,I=0;for(let _=0,F=c*r+d;_<te.BLOCK_SIZE;_++,F+=r){for(let k=0;k<te.BLOCK_SIZE;k++){const P=e[F+k]&255;A+=P,P<b&&(b=P),P>I&&(I=P)}if(I-b>te.MIN_DYNAMIC_RANGE)for(_++,F+=r;_<te.BLOCK_SIZE;_++,F+=r)for(let k=0;k<te.BLOCK_SIZE;k++)A+=e[F+k]&255}let S=A>>te.BLOCK_SIZE_POWER*2;if(I-b<=te.MIN_DYNAMIC_RANGE&&(S=b/2,l>0&&f>0)){const _=(o[l-1][f]+2*o[l][f-1]+o[l-1][f-1])/4;b<_&&(S=_)}o[l][f]=S}}return o}}te.BLOCK_SIZE_POWER=3,te.BLOCK_SIZE=1<<te.BLOCK_SIZE_POWER,te.BLOCK_SIZE_MASK=te.BLOCK_SIZE-1,te.MINIMUM_DIMENSION=te.BLOCK_SIZE*5,te.MIN_DYNAMIC_RANGE=24;class Zt{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,n,r){throw new gt("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new gt("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new gt("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new de;for(let n=0;n<this.height;n++){const r=this.getRow(n,e);for(let i=0;i<this.width;i++){const s=r[i]&255;let a;s<64?a="#":s<128?a="+":s<192?a=".":a=" ",t.append(a)}t.append(`
`)}return t.toString()}}class $e extends Zt{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const n=this.delegate.getRow(e,t),r=this.getWidth();for(let i=0;i<r;i++)n[i]=255-(n[i]&255);return n}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(t);for(let r=0;r<t;r++)n[r]=255-(e[r]&255);return n}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,n,r){return new $e(this.delegate.crop(e,t,n,r))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new $e(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new $e(this.delegate.rotateCounterClockwise45())}}class ct extends Zt{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=ct.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return ct.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,n){const r=new Uint8ClampedArray(t*n);for(let i=0,s=0,a=e.length;i<a;i+=4,s++){let o;if(e[i+3]===0)o=255;else{const c=e[i],f=e[i+1],d=e[i+2];o=306*c+601*f+117*d+512>>10}r[s]=o}return r}getRow(e,t){if(e<0||e>=this.getHeight())throw new D("Requested row is outside the image: "+e);const n=this.getWidth(),r=e*n;return t===null?t=this.buffer.slice(r,r+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(r,r+n))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,n,r){return super.crop(e,t,n,r),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),n=t.getContext("2d"),r=e*ct.DEGREE_TO_RADIANS,i=this.canvas.width,s=this.canvas.height,a=Math.ceil(Math.abs(Math.cos(r))*i+Math.abs(Math.sin(r))*s),o=Math.ceil(Math.abs(Math.sin(r))*i+Math.abs(Math.cos(r))*s);return t.width=a,t.height=o,n.translate(a/2,o/2),n.rotate(r),n.drawImage(this.canvas,i/-2,s/-2),this.buffer=ct.makeBufferFromCanvasImageData(t),this}invert(){return new $e(this)}}ct.DEGREE_TO_RADIANS=Math.PI/180;class nn{constructor(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Ze=(globalThis||Gn||self||window||void 0)&&(globalThis||Gn||self||window||void 0).__awaiter||function(h,e,t,n){function r(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function a(c){try{l(n.next(c))}catch(f){s(f)}}function o(c){try{l(n.throw(c))}catch(f){s(f)}}function l(c){c.done?i(c.value):r(c.value).then(a,o)}l((n=n.apply(h,e||[])).next())})};class Ft{constructor(e,t=500,n){this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return Ze(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const n of e){const r=n.kind==="video"?"videoinput":n.kind;if(r!=="videoinput")continue;const i=n.deviceId||n.id,s=n.label||`Video device ${t.length+1}`,a=n.groupId,o={deviceId:i,label:s,kind:r,groupId:a};t.push(o)}return t})}getVideoInputDevices(){return Ze(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(t=>new nn(t.deviceId,t.label))})}findDeviceById(e){return Ze(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(n=>n.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return Ze(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return Ze(this,void 0,void 0,function*(){this.reset();let n;e?n={deviceId:{exact:e}}:n={facingMode:"environment"};const r={video:n};return yield this.decodeOnceFromConstraints(r,t)})}decodeOnceFromConstraints(e,t){return Ze(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(n,t)})}decodeOnceFromStream(e,t){return Ze(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(n)})}decodeFromInputVideoDeviceContinuously(e,t,n){return Ze(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,n)})}decodeFromVideoDevice(e,t,n){return Ze(this,void 0,void 0,function*(){let r;e?r={deviceId:{exact:e}}:r={facingMode:"environment"};const i={video:r};return yield this.decodeFromConstraints(i,t,n)})}decodeFromConstraints(e,t,n){return Ze(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(r,t,n)})}decodeFromStream(e,t,n){return Ze(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(r,n)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return Ze(this,void 0,void 0,function*(){const n=this.prepareVideoElement(t);return this.addVideoSource(n,e),this.videoElement=n,this.stream=e,yield this.playVideoOnLoadAsync(n),n})}playVideoOnLoadAsync(e){return new Promise((t,n)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return Ze(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const n=document.getElementById(e);if(!n)throw new L(`element with id '${e}' not found`);if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new L(`element with id '${e}' must be an ${t} element`);return n}decodeFromImage(e,t){if(!e&&!t)throw new L("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new L("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,n){if(e===void 0&&t===void 0)throw new L("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)}decodeFromImageElement(e){if(!e)throw new L("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);this.imageElement=t;let n;return this.isImageLoaded(t)?n=this.decodeOnce(t,!1,!0):n=this._decodeOnLoadImage(t),n}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)}_decodeFromVideoElementSetup(e){if(!e)throw new L("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new L("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const n=this._decodeOnLoadImage(t);return t.src=e,n}decodeFromVideoUrl(e){if(!e)throw new L("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n}decodeFromVideoUrlContinuously(e,t){if(!e)throw new L("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(n,t);return n.src=e,r}_decodeOnLoadImage(e){return new Promise((t,n)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,n),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return Ze(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return Ze(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,n=!0){this._stopAsyncDecode=!1;const r=(i,s)=>{if(this._stopAsyncDecode){s(new O("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const a=this.decode(e);i(a)}catch(a){const o=t&&a instanceof O,c=(a instanceof re||a instanceof G)&&n;if(o||c)return setTimeout(r,this._timeBetweenDecodingAttempts,i,s);s(a)}};return new Promise((i,s)=>r(i,s))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const n=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const r=this.decode(e);t(r,null),setTimeout(n,this.timeBetweenScansMillis)}catch(r){t(null,r);const i=r instanceof re||r instanceof G,s=r instanceof O;(i||s)&&setTimeout(n,this._timeBetweenDecodingAttempts)}};n()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return e.videoWidth!==0}drawFrameOnCanvas(e,t,n){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,n=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),n=new ct(t),r=new te(n);return new ue(r)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const n=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=n}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let n,r;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,r=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,r=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=r+"px",t.width=n,t.height=r,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class Le{constructor(e,t,n=t==null?0:8*t.length,r,i,s=ne.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=r,this.format=i,this.timestamp=s,this.text=e,this.rawBytes=t,n==null?this.numBits=t==null?0:8*t.length:this.numBits=n,this.resultPoints=r,this.format=i,this.resultMetadata=null,s==null?this.timestamp=ne.currentTimeMillis():this.timestamp=s}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const n=new Array(t.length+e.length);ne.arraycopy(t,0,n,0,t.length),ne.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ut;(function(h){h[h.AZTEC=0]="AZTEC",h[h.CODABAR=1]="CODABAR",h[h.CODE_39=2]="CODE_39",h[h.CODE_93=3]="CODE_93",h[h.CODE_128=4]="CODE_128",h[h.DATA_MATRIX=5]="DATA_MATRIX",h[h.EAN_8=6]="EAN_8",h[h.EAN_13=7]="EAN_13",h[h.ITF=8]="ITF",h[h.MAXICODE=9]="MAXICODE",h[h.PDF_417=10]="PDF_417",h[h.QR_CODE=11]="QR_CODE",h[h.RSS_14=12]="RSS_14",h[h.RSS_EXPANDED=13]="RSS_EXPANDED",h[h.UPC_A=14]="UPC_A",h[h.UPC_E=15]="UPC_E",h[h.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ut||(Ut={}));var z=Ut,Nt;(function(h){h[h.OTHER=0]="OTHER",h[h.ORIENTATION=1]="ORIENTATION",h[h.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",h[h.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",h[h.ISSUE_NUMBER=4]="ISSUE_NUMBER",h[h.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",h[h.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",h[h.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",h[h.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",h[h.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",h[h.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Nt||(Nt={}));var Xe=Nt;class Vt{constructor(e,t,n,r,i=-1,s=-1){this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=r,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=s,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class wt{exp(e){return this.expTable[e]}log(e){if(e===0)throw new D;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class Fe{constructor(e,t){if(t.length===0)throw new D;this.field=e;const n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-r),ne.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let n;if(e===1){n=0;for(let s=0,a=t.length;s!==a;s++){const o=t[s];n=wt.addOrSubtract(n,o)}return n}n=t[0];const r=t.length,i=this.field;for(let s=1;s<r;s++)n=wt.addOrSubtract(i.multiply(e,n),t[s]);return n}addOrSubtract(e){if(!this.field.equals(e.field))throw new D("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){const s=t;t=n,n=s}let r=new Int32Array(n.length);const i=n.length-t.length;ne.arraycopy(n,0,r,0,i);for(let s=i;s<n.length;s++)r[s]=wt.addOrSubtract(t[s-i],n[s]);return new Fe(this.field,r)}multiply(e){if(!this.field.equals(e.field))throw new D("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,s=new Int32Array(n+i-1),a=this.field;for(let o=0;o<n;o++){const l=t[o];for(let c=0;c<i;c++)s[o+c]=wt.addOrSubtract(s[o+c],a.multiply(l,r[c]))}return new Fe(a,s)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,n=this.field,r=new Int32Array(t),i=this.coefficients;for(let s=0;s<t;s++)r[s]=n.multiply(i[s],e);return new Fe(n,r)}multiplyByMonomial(e,t){if(e<0)throw new D;if(t===0)return this.field.getZero();const n=this.coefficients,r=n.length,i=new Int32Array(r+e),s=this.field;for(let a=0;a<r;a++)i[a]=s.multiply(n[a],t);return new Fe(s,i)}divide(e){if(!this.field.equals(e.field))throw new D("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new D("Divide by 0");const t=this.field;let n=t.getZero(),r=this;const i=e.getCoefficient(e.getDegree()),s=t.inverse(i);for(;r.getDegree()>=e.getDegree()&&!r.isZero();){const a=r.getDegree()-e.getDegree(),o=t.multiply(r.getCoefficient(r.getDegree()),s),l=e.multiplyByMonomial(a,o),c=t.buildMonomial(a,o);n=n.addOrSubtract(c),r=r.addOrSubtract(l)}return[n,r]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),t===0||n!==1){const r=this.field.log(n);r===0?e+="1":r===1?e+="a":(e+="a^",e+=r)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class rn extends C{}rn.kind="ArithmeticException";class fe extends wt{constructor(e,t,n){super(),this.primitive=e,this.size=t,this.generatorBase=n;const r=new Int32Array(t);let i=1;for(let a=0;a<t;a++)r[a]=i,i*=2,i>=t&&(i^=e,i&=t-1);this.expTable=r;const s=new Int32Array(t);for(let a=0;a<t-1;a++)s[r[a]]=a;this.logTable=s,this.zero=new Fe(this,Int32Array.from([0])),this.one=new Fe(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new D;if(t===0)return this.zero;const n=new Int32Array(e+1);return n[0]=t,new Fe(this,n)}inverse(e){if(e===0)throw new rn;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+$.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}fe.AZTEC_DATA_12=new fe(4201,4096,1),fe.AZTEC_DATA_10=new fe(1033,1024,1),fe.AZTEC_DATA_6=new fe(67,64,1),fe.AZTEC_PARAM=new fe(19,16,1),fe.QR_CODE_FIELD_256=new fe(285,256,0),fe.DATA_MATRIX_FIELD_256=new fe(301,256,1),fe.AZTEC_DATA_8=fe.DATA_MATRIX_FIELD_256,fe.MAXICODE_FIELD_64=fe.AZTEC_DATA_6;class Gt extends C{}Gt.kind="ReedSolomonException";class Et extends C{}Et.kind="IllegalStateException";class Rt{constructor(e){this.field=e}decode(e,t){const n=this.field,r=new Fe(n,e),i=new Int32Array(t);let s=!0;for(let A=0;A<t;A++){const b=r.evaluateAt(n.exp(A+n.getGeneratorBase()));i[i.length-1-A]=b,b!==0&&(s=!1)}if(s)return;const a=new Fe(n,i),o=this.runEuclideanAlgorithm(n.buildMonomial(t,1),a,t),l=o[0],c=o[1],f=this.findErrorLocations(l),d=this.findErrorMagnitudes(c,f);for(let A=0;A<f.length;A++){const b=e.length-1-n.log(f[A]);if(b<0)throw new Gt("Bad error location");e[b]=fe.addOrSubtract(e[b],d[A])}}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){const A=e;e=t,t=A}const r=this.field;let i=e,s=t,a=r.getZero(),o=r.getOne();for(;s.getDegree()>=(n/2|0);){let A=i,b=a;if(i=s,a=o,i.isZero())throw new Gt("r_{i-1} was zero");s=A;let I=r.getZero();const S=i.getCoefficient(i.getDegree()),_=r.inverse(S);for(;s.getDegree()>=i.getDegree()&&!s.isZero();){const F=s.getDegree()-i.getDegree(),k=r.multiply(s.getCoefficient(s.getDegree()),_);I=I.addOrSubtract(r.buildMonomial(F,k)),s=s.addOrSubtract(i.multiplyByMonomial(F,k))}if(o=I.multiply(a).addOrSubtract(b),s.getDegree()>=i.getDegree())throw new Et("Division algorithm failed to reduce polynomial?")}const l=o.getCoefficient(0);if(l===0)throw new Gt("sigmaTilde(0) was zero");const c=r.inverse(l),f=o.multiplyScalar(c),d=s.multiplyScalar(c);return[f,d]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const n=new Int32Array(t);let r=0;const i=this.field;for(let s=1;s<i.getSize()&&r<t;s++)e.evaluateAt(s)===0&&(n[r]=i.inverse(s),r++);if(r!==t)throw new Gt("Error locator degree does not match number of roots");return n}findErrorMagnitudes(e,t){const n=t.length,r=new Int32Array(n),i=this.field;for(let s=0;s<n;s++){const a=i.inverse(t[s]);let o=1;for(let l=0;l<n;l++)if(s!==l){const c=i.multiply(t[l],a),f=(c&1)===0?c|1:c&-2;o=i.multiply(o,f)}r[s]=i.multiply(e.evaluateAt(a),i.inverse(o)),i.getGeneratorBase()!==0&&(r[s]=i.multiply(r[s],a))}return r}}var Me;(function(h){h[h.UPPER=0]="UPPER",h[h.LOWER=1]="LOWER",h[h.MIXED=2]="MIXED",h[h.DIGIT=3]="DIGIT",h[h.PUNCT=4]="PUNCT",h[h.BINARY=5]="BINARY"})(Me||(Me={}));class Ae{decode(e){this.ddata=e;let t=e.getBits(),n=this.extractBits(t),r=this.correctBits(n),i=Ae.convertBoolArrayToByteArray(r),s=Ae.getEncodedData(r),a=new Vt(i,s,null,null);return a.setNumBits(r.length),a}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,n=Me.UPPER,r=Me.UPPER,i="",s=0;for(;s<t;)if(r===Me.BINARY){if(t-s<5)break;let a=Ae.readCode(e,s,5);if(s+=5,a===0){if(t-s<11)break;a=Ae.readCode(e,s,11)+31,s+=11}for(let o=0;o<a;o++){if(t-s<8){s=t;break}const l=Ae.readCode(e,s,8);i+=Q.castAsNonUtf8Char(l),s+=8}r=n}else{let a=r===Me.DIGIT?4:5;if(t-s<a)break;let o=Ae.readCode(e,s,a);s+=a;let l=Ae.getCharacter(r,o);l.startsWith("CTRL_")?(n=r,r=Ae.getTable(l.charAt(5)),l.charAt(6)==="L"&&(n=r)):(i+=l,r=n)}return i}static getTable(e){switch(e){case"L":return Me.LOWER;case"P":return Me.PUNCT;case"M":return Me.MIXED;case"D":return Me.DIGIT;case"B":return Me.BINARY;case"U":default:return Me.UPPER}}static getCharacter(e,t){switch(e){case Me.UPPER:return Ae.UPPER_TABLE[t];case Me.LOWER:return Ae.LOWER_TABLE[t];case Me.MIXED:return Ae.MIXED_TABLE[t];case Me.PUNCT:return Ae.PUNCT_TABLE[t];case Me.DIGIT:return Ae.DIGIT_TABLE[t];default:throw new Et("Bad table")}}correctBits(e){let t,n;this.ddata.getNbLayers()<=2?(n=6,t=fe.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=fe.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=fe.AZTEC_DATA_10):(n=12,t=fe.AZTEC_DATA_12);let r=this.ddata.getNbDatablocks(),i=e.length/n;if(i<r)throw new G;let s=e.length%n,a=new Int32Array(i);for(let d=0;d<i;d++,s+=n)a[d]=Ae.readCode(e,s,n);try{new Rt(t).decode(a,i-r)}catch(d){throw new G(d)}let o=(1<<n)-1,l=0;for(let d=0;d<r;d++){let A=a[d];if(A===0||A===o)throw new G;(A===1||A===o-1)&&l++}let c=new Array(r*n-l),f=0;for(let d=0;d<r;d++){let A=a[d];if(A===1||A===o-1)c.fill(A>1,f,f+n-1),f+=n-1;else for(let b=n-1;b>=0;--b)c[f++]=(A&1<<b)!==0}return c}extractBits(e){let t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),r=(t?11:14)+n*4,i=new Int32Array(r),s=new Array(this.totalBitsInLayer(n,t));if(t)for(let a=0;a<i.length;a++)i[a]=a;else{let a=r+1+2*$.truncDivision($.truncDivision(r,2)-1,15),o=r/2,l=$.truncDivision(a,2);for(let c=0;c<o;c++){let f=c+$.truncDivision(c,15);i[o-c-1]=l-f-1,i[o+c]=l+f+1}}for(let a=0,o=0;a<n;a++){let l=(n-a)*4+(t?9:12),c=a*2,f=r-1-c;for(let d=0;d<l;d++){let A=d*2;for(let b=0;b<2;b++)s[o+A+b]=e.get(i[c+b],i[c+d]),s[o+2*l+A+b]=e.get(i[c+d],i[f-b]),s[o+4*l+A+b]=e.get(i[f-b],i[f-d]),s[o+6*l+A+b]=e.get(i[f-d],i[c+b])}o+=l*8}return s}static readCode(e,t,n){let r=0;for(let i=t;i<t+n;i++)r<<=1,e[i]&&(r|=1);return r}static readByte(e,t){let n=e.length-t;return n>=8?Ae.readCode(e,t,8):Ae.readCode(e,t,n)<<8-n}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let n=0;n<t.length;n++)t[n]=Ae.readByte(e,8*n);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Ae.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Ae.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Ae.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Ae.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Ae.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Z{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,n,r){const i=e-n,s=t-r;return Math.sqrt(i*i+s*s)}static sum(e){let t=0;for(let n=0,r=e.length;n!==r;n++){const i=e[n];t+=i}return t}}class sn{static floatToIntBits(e){return e}}sn.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Y{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof Y){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*sn.floatToIntBits(this.x)+sn.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),r=this.distance(e[0],e[2]);let i,s,a;if(n>=t&&n>=r?(s=e[0],i=e[1],a=e[2]):r>=n&&r>=t?(s=e[1],i=e[0],a=e[2]):(s=e[2],i=e[0],a=e[1]),this.crossProductZ(i,s,a)<0){const o=i;i=a,a=o}e[0]=i,e[1]=s,e[2]=a}static distance(e,t){return Z.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,n){const r=t.x,i=t.y;return(n.x-r)*(e.y-i)-(n.y-i)*(e.x-r)}}class Kt{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Dn extends Kt{constructor(e,t,n,r,i){super(e,t),this.compact=n,this.nbDatablocks=r,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class pt{constructor(e,t,n,r){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=pt.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),r==null&&(r=e.getHeight()/2|0);const i=t/2|0;if(this.leftInit=n-i,this.rightInit=n+i,this.upInit=r-i,this.downInit=r+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new O}detect(){let e=this.leftInit,t=this.rightInit,n=this.upInit,r=this.downInit,i=!1,s=!0,a=!1,o=!1,l=!1,c=!1,f=!1;const d=this.width,A=this.height;for(;s;){s=!1;let b=!0;for(;(b||!o)&&t<d;)b=this.containsBlackPoint(n,r,t,!1),b?(t++,s=!0,o=!0):o||t++;if(t>=d){i=!0;break}let I=!0;for(;(I||!l)&&r<A;)I=this.containsBlackPoint(e,t,r,!0),I?(r++,s=!0,l=!0):l||r++;if(r>=A){i=!0;break}let S=!0;for(;(S||!c)&&e>=0;)S=this.containsBlackPoint(n,r,e,!1),S?(e--,s=!0,c=!0):c||e--;if(e<0){i=!0;break}let _=!0;for(;(_||!f)&&n>=0;)_=this.containsBlackPoint(e,t,n,!0),_?(n--,s=!0,f=!0):f||n--;if(n<0){i=!0;break}s&&(a=!0)}if(!i&&a){const b=t-e;let I=null;for(let k=1;I===null&&k<b;k++)I=this.getBlackPointOnSegment(e,r-k,e+k,r);if(I==null)throw new O;let S=null;for(let k=1;S===null&&k<b;k++)S=this.getBlackPointOnSegment(e,n+k,e+k,n);if(S==null)throw new O;let _=null;for(let k=1;_===null&&k<b;k++)_=this.getBlackPointOnSegment(t,n+k,t-k,n);if(_==null)throw new O;let F=null;for(let k=1;F===null&&k<b;k++)F=this.getBlackPointOnSegment(t,r-k,t-k,r);if(F==null)throw new O;return this.centerEdges(F,I,_,S)}else throw new O}getBlackPointOnSegment(e,t,n,r){const i=Z.round(Z.distance(e,t,n,r)),s=(n-e)/i,a=(r-t)/i,o=this.image;for(let l=0;l<i;l++){const c=Z.round(e+l*s),f=Z.round(t+l*a);if(o.get(c,f))return new Y(c,f)}return null}centerEdges(e,t,n,r){const i=e.getX(),s=e.getY(),a=t.getX(),o=t.getY(),l=n.getX(),c=n.getY(),f=r.getX(),d=r.getY(),A=pt.CORR;return i<this.width/2?[new Y(f-A,d+A),new Y(a+A,o+A),new Y(l-A,c-A),new Y(i+A,s-A)]:[new Y(f+A,d+A),new Y(a+A,o-A),new Y(l-A,c+A),new Y(i-A,s-A)]}containsBlackPoint(e,t,n,r){const i=this.image;if(r){for(let s=e;s<=t;s++)if(i.get(s,n))return!0}else for(let s=e;s<=t;s++)if(i.get(n,s))return!0;return!1}}pt.INIT_SIZE=10,pt.CORR=1;class mn{static checkAndNudgePoints(e,t){const n=e.getWidth(),r=e.getHeight();let i=!0;for(let s=0;s<t.length&&i;s+=2){const a=Math.floor(t[s]),o=Math.floor(t[s+1]);if(a<-1||a>n||o<-1||o>r)throw new O;i=!1,a===-1?(t[s]=0,i=!0):a===n&&(t[s]=n-1,i=!0),o===-1?(t[s+1]=0,i=!0):o===r&&(t[s+1]=r-1,i=!0)}i=!0;for(let s=t.length-2;s>=0&&i;s-=2){const a=Math.floor(t[s]),o=Math.floor(t[s+1]);if(a<-1||a>n||o<-1||o>r)throw new O;i=!1,a===-1?(t[s]=0,i=!0):a===n&&(t[s]=n-1,i=!0),o===-1?(t[s+1]=0,i=!0):o===r&&(t[s+1]=r-1,i=!0)}}}class mt{constructor(e,t,n,r,i,s,a,o,l){this.a11=e,this.a21=t,this.a31=n,this.a12=r,this.a22=i,this.a32=s,this.a13=a,this.a23=o,this.a33=l}static quadrilateralToQuadrilateral(e,t,n,r,i,s,a,o,l,c,f,d,A,b,I,S){const _=mt.quadrilateralToSquare(e,t,n,r,i,s,a,o);return mt.squareToQuadrilateral(l,c,f,d,A,b,I,S).times(_)}transformPoints(e){const t=e.length,n=this.a11,r=this.a12,i=this.a13,s=this.a21,a=this.a22,o=this.a23,l=this.a31,c=this.a32,f=this.a33;for(let d=0;d<t;d+=2){const A=e[d],b=e[d+1],I=i*A+o*b+f;e[d]=(n*A+s*b+l)/I,e[d+1]=(r*A+a*b+c)/I}}transformPointsWithValues(e,t){const n=this.a11,r=this.a12,i=this.a13,s=this.a21,a=this.a22,o=this.a23,l=this.a31,c=this.a32,f=this.a33,d=e.length;for(let A=0;A<d;A++){const b=e[A],I=t[A],S=i*b+o*I+f;e[A]=(n*b+s*I+l)/S,t[A]=(r*b+a*I+c)/S}}static squareToQuadrilateral(e,t,n,r,i,s,a,o){const l=e-n+i-a,c=t-r+s-o;if(l===0&&c===0)return new mt(n-e,i-n,e,r-t,s-r,t,0,0,1);{const f=n-i,d=a-i,A=r-s,b=o-s,I=f*b-d*A,S=(l*b-d*c)/I,_=(f*c-l*A)/I;return new mt(n-e+S*n,a-e+_*a,e,r-t+S*r,o-t+_*o,t,S,_,1)}}static quadrilateralToSquare(e,t,n,r,i,s,a,o){return mt.squareToQuadrilateral(e,t,n,r,i,s,a,o).buildAdjoint()}buildAdjoint(){return new mt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new mt(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class An extends mn{sampleGrid(e,t,n,r,i,s,a,o,l,c,f,d,A,b,I,S,_,F,k){const P=mt.quadrilateralToQuadrilateral(r,i,s,a,o,l,c,f,d,A,b,I,S,_,F,k);return this.sampleGridWithTransform(e,t,n,P)}sampleGridWithTransform(e,t,n,r){if(t<=0||n<=0)throw new O;const i=new Re(t,n),s=new Float32Array(2*t);for(let a=0;a<n;a++){const o=s.length,l=a+.5;for(let c=0;c<o;c+=2)s[c]=c/2+.5,s[c+1]=l;r.transformPoints(s),mn.checkAndNudgePoints(e,s);try{for(let c=0;c<o;c+=2)e.get(Math.floor(s[c]),Math.floor(s[c+1]))&&i.set(c/2,a)}catch{throw new O}}return i}}class Ot{static setGridSampler(e){Ot.gridSampler=e}static getInstance(){return Ot.gridSampler}}Ot.gridSampler=new An;class M{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new Y(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class W{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){let s=n[0];n[0]=n[2],n[2]=s}this.extractParameters(n);let r=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),i=this.getMatrixCornerPoints(n);return new Dn(r,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new O;let t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);let r=0;for(let s=0;s<4;s++){let a=n[(this.shift+s)%4];this.compact?(r<<=7,r+=a>>1&127):(r<<=10,r+=(a>>2&992)+(a>>1&31))}let i=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=(i>>6)+1,this.nbDataBlocks=(i&63)+1):(this.nbLayers=(i>>11)+1,this.nbDataBlocks=(i&2047)+1)}getRotation(e,t){let n=0;e.forEach((r,i,s)=>{let a=(r>>t-2<<1)+(r&1);n=(n<<3)+a}),n=((n&1)<<11)+(n>>1);for(let r=0;r<4;r++)if($.bitCount(n^this.EXPECTED_CORNER_BITS[r])<=2)return r;throw new O}getCorrectedParameterData(e,t){let n,r;t?(n=7,r=2):(n=10,r=4);let i=n-r,s=new Int32Array(n);for(let o=n-1;o>=0;--o)s[o]=e&15,e>>=4;try{new Rt(fe.AZTEC_PARAM).decode(s,i)}catch{throw new O}let a=0;for(let o=0;o<r;o++)a=(a<<4)+s[o];return a}getBullsEyeCorners(e){let t=e,n=e,r=e,i=e,s=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let f=this.getFirstDifferent(t,s,1,-1),d=this.getFirstDifferent(n,s,1,1),A=this.getFirstDifferent(r,s,-1,1),b=this.getFirstDifferent(i,s,-1,-1);if(this.nbCenterLayers>2){let I=this.distancePoint(b,f)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(I<.75||I>1.25||!this.isWhiteOrBlackRectangle(f,d,A,b))break}t=f,n=d,r=A,i=b,s=!s}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new O;this.compact=this.nbCenterLayers===5;let a=new Y(t.getX()+.5,t.getY()-.5),o=new Y(n.getX()+.5,n.getY()+.5),l=new Y(r.getX()-.5,r.getY()+.5),c=new Y(i.getX()-.5,i.getY()-.5);return this.expandSquare([a,o,l,c],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,n,r;try{let a=new pt(this.image).detect();e=a[0],t=a[1],n=a[2],r=a[3]}catch{let o=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new M(o+7,l-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new M(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new M(o-7,l+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new M(o-7,l-7),!1,-1,-1).toResultPoint()}let i=Z.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=Z.round((e.getY()+r.getY()+t.getY()+n.getY())/4);try{let a=new pt(this.image,15,i,s).detect();e=a[0],t=a[1],n=a[2],r=a[3]}catch{e=this.getFirstDifferent(new M(i+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new M(i+7,s+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new M(i-7,s+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new M(i-7,s-7),!1,-1,-1).toResultPoint()}return i=Z.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=Z.round((e.getY()+r.getY()+t.getY()+n.getY())/4),new M(i,s)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,n,r,i){let s=Ot.getInstance(),a=this.getDimension(),o=a/2-this.nbCenterLayers,l=a/2+this.nbCenterLayers;return s.sampleGrid(e,a,a,o,o,l,o,l,l,o,l,t.getX(),t.getY(),n.getX(),n.getY(),r.getX(),r.getY(),i.getX(),i.getY())}sampleLine(e,t,n){let r=0,i=this.distanceResultPoint(e,t),s=i/n,a=e.getX(),o=e.getY(),l=s*(t.getX()-e.getX())/i,c=s*(t.getY()-e.getY())/i;for(let f=0;f<n;f++)this.image.get(Z.round(a+f*l),Z.round(o+f*c))&&(r|=1<<n-f-1);return r}isWhiteOrBlackRectangle(e,t,n,r){let i=3;e=new M(e.getX()-i,e.getY()+i),t=new M(t.getX()-i,t.getY()-i),n=new M(n.getX()+i,n.getY()-i),r=new M(r.getX()+i,r.getY()+i);let s=this.getColor(r,e);if(s===0)return!1;let a=this.getColor(e,t);return a!==s||(a=this.getColor(t,n),a!==s)?!1:(a=this.getColor(n,r),a===s)}getColor(e,t){let n=this.distancePoint(e,t),r=(t.getX()-e.getX())/n,i=(t.getY()-e.getY())/n,s=0,a=e.getX(),o=e.getY(),l=this.image.get(e.getX(),e.getY()),c=Math.ceil(n);for(let d=0;d<c;d++)a+=r,o+=i,this.image.get(Z.round(a),Z.round(o))!==l&&s++;let f=s/n;return f>.1&&f<.9?0:f<=.1===l?1:-1}getFirstDifferent(e,t,n,r){let i=e.getX()+n,s=e.getY()+r;for(;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=n,s+=r;for(i-=n,s-=r;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=n;for(i-=n;this.isValid(i,s)&&this.image.get(i,s)===t;)s+=r;return s-=r,new M(i,s)}expandSquare(e,t,n){let r=n/(2*t),i=e[0].getX()-e[2].getX(),s=e[0].getY()-e[2].getY(),a=(e[0].getX()+e[2].getX())/2,o=(e[0].getY()+e[2].getY())/2,l=new Y(a+r*i,o+r*s),c=new Y(a-r*i,o-r*s);i=e[1].getX()-e[3].getX(),s=e[1].getY()-e[3].getY(),a=(e[1].getX()+e[3].getX())/2,o=(e[1].getY()+e[3].getY())/2;let f=new Y(a+r*i,o+r*s),d=new Y(a-r*i,o-r*s);return[l,f,c,d]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=Z.round(e.getX()),n=Z.round(e.getY());return this.isValid(t,n)}distancePoint(e,t){return Z.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return Z.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*($.truncDivision(this.nbLayers-4,8)+1)+15}}class Ie{decode(e,t=null){let n=null,r=new W(e.getBlackMatrix()),i=null,s=null;try{let c=r.detectMirror(!1);i=c.getPoints(),this.reportFoundResultPoints(t,i),s=new Ae().decode(c)}catch(c){n=c}if(s==null)try{let c=r.detectMirror(!0);i=c.getPoints(),this.reportFoundResultPoints(t,i),s=new Ae().decode(c)}catch(c){throw n??c}let a=new Le(s.getText(),s.getRawBytes(),s.getNumBits(),i,z.AZTEC,ne.currentTimeMillis()),o=s.getByteSegments();o!=null&&a.putMetadata(Xe.BYTE_SEGMENTS,o);let l=s.getECLevel();return l!=null&&a.putMetadata(Xe.ERROR_CORRECTION_LEVEL,l),a}reportFoundResultPoints(e,t){if(e!=null){let n=e.get(le.NEED_RESULT_POINT_CALLBACK);n!=null&&t.forEach((r,i,s)=>{n.foundPossibleResultPoint(r)})}}reset(){}}class at extends Ft{constructor(e=500){super(new Ie,e)}}class Te{decode(e,t){try{return this.doDecode(e,t)}catch{if(t&&t.get(le.TRY_HARDER)===!0&&e.isRotateSupported()){const i=e.rotateCounterClockwise(),s=this.doDecode(i,t),a=s.getResultMetadata();let o=270;a!==null&&a.get(Xe.ORIENTATION)===!0&&(o=o+a.get(Xe.ORIENTATION)%360),s.putMetadata(Xe.ORIENTATION,o);const l=s.getResultPoints();if(l!==null){const c=i.getHeight();for(let f=0;f<l.length;f++)l[f]=new Y(c-l[f].getY()-1,l[f].getX())}return s}else throw new O}}reset(){}doDecode(e,t){const n=e.getWidth(),r=e.getHeight();let i=new oe(n);const s=t&&t.get(le.TRY_HARDER)===!0,a=Math.max(1,r>>(s?8:5));let o;s?o=r:o=15;const l=Math.trunc(r/2);for(let c=0;c<o;c++){const f=Math.trunc((c+1)/2),d=(c&1)===0,A=l+a*(d?f:-f);if(A<0||A>=r)break;try{i=e.getBlackRow(A,i)}catch{continue}for(let b=0;b<2;b++){if(b===1&&(i.reverse(),t&&t.get(le.NEED_RESULT_POINT_CALLBACK)===!0)){const I=new Map;t.forEach((S,_)=>I.set(_,S)),I.delete(le.NEED_RESULT_POINT_CALLBACK),t=I}try{const I=this.decodeRow(A,i,t);if(b===1){I.putMetadata(Xe.ORIENTATION,180);const S=I.getResultPoints();S!==null&&(S[0]=new Y(n-S[0].getX()-1,S[0].getY()),S[1]=new Y(n-S[1].getX()-1,S[1].getY()))}return I}catch{}}}throw new O}static recordPattern(e,t,n){const r=n.length;for(let l=0;l<r;l++)n[l]=0;const i=e.getSize();if(t>=i)throw new O;let s=!e.get(t),a=0,o=t;for(;o<i;){if(e.get(o)!==s)n[a]++;else{if(++a===r)break;n[a]=1,s=!s}o++}if(!(a===r||a===r-1&&o===i))throw new O}static recordPatternInReverse(e,t,n){let r=n.length,i=e.get(t);for(;t>0&&r>=0;)e.get(--t)!==i&&(r--,i=!i);if(r>=0)throw new O;Te.recordPattern(e,t+1,n)}static patternMatchVariance(e,t,n){const r=e.length;let i=0,s=0;for(let l=0;l<r;l++)i+=e[l],s+=t[l];if(i<s)return Number.POSITIVE_INFINITY;const a=i/s;n*=a;let o=0;for(let l=0;l<r;l++){const c=e[l],f=t[l]*a,d=c>f?c-f:f-c;if(d>n)return Number.POSITIVE_INFINITY;o+=d}return o/i}}class H extends Te{static findStartPattern(e){const t=e.getSize(),n=e.getNextSet(0);let r=0,i=Int32Array.from([0,0,0,0,0,0]),s=n,a=!1;const o=6;for(let l=n;l<t;l++)if(e.get(l)!==a)i[r]++;else{if(r===o-1){let c=H.MAX_AVG_VARIANCE,f=-1;for(let d=H.CODE_START_A;d<=H.CODE_START_C;d++){const A=Te.patternMatchVariance(i,H.CODE_PATTERNS[d],H.MAX_INDIVIDUAL_VARIANCE);A<c&&(c=A,f=d)}if(f>=0&&e.isRange(Math.max(0,s-(l-s)/2),s,!1))return Int32Array.from([s,l,f]);s+=i[0]+i[1],i=i.slice(2,i.length-1),i[r-1]=0,i[r]=0,r--}else r++;i[r]=1,a=!a}throw new O}static decodeCode(e,t,n){Te.recordPattern(e,n,t);let r=H.MAX_AVG_VARIANCE,i=-1;for(let s=0;s<H.CODE_PATTERNS.length;s++){const a=H.CODE_PATTERNS[s],o=this.patternMatchVariance(t,a,H.MAX_INDIVIDUAL_VARIANCE);o<r&&(r=o,i=s)}if(i>=0)return i;throw new O}decodeRow(e,t,n){const r=n&&n.get(le.ASSUME_GS1)===!0,i=H.findStartPattern(t),s=i[2];let a=0;const o=new Uint8Array(20);o[a++]=s;let l;switch(s){case H.CODE_START_A:l=H.CODE_CODE_A;break;case H.CODE_START_B:l=H.CODE_CODE_B;break;case H.CODE_START_C:l=H.CODE_CODE_C;break;default:throw new G}let c=!1,f=!1,d="",A=i[0],b=i[1];const I=Int32Array.from([0,0,0,0,0,0]);let S=0,_=0,F=s,k=0,P=!0,ce=!1,ie=!1;for(;!c;){const xn=f;switch(f=!1,S=_,_=H.decodeCode(t,I,b),o[a++]=_,_!==H.CODE_STOP&&(P=!0),_!==H.CODE_STOP&&(k++,F+=k*_),A=b,b+=I.reduce((Ii,yi)=>Ii+yi,0),_){case H.CODE_START_A:case H.CODE_START_B:case H.CODE_START_C:throw new G}switch(l){case H.CODE_CODE_A:if(_<64)ie===ce?d+=String.fromCharCode(32+_):d+=String.fromCharCode(32+_+128),ie=!1;else if(_<96)ie===ce?d+=String.fromCharCode(_-64):d+=String.fromCharCode(_+64),ie=!1;else switch(_!==H.CODE_STOP&&(P=!1),_){case H.CODE_FNC_1:r&&(d.length===0?d+="]C1":d+="");break;case H.CODE_FNC_2:case H.CODE_FNC_3:break;case H.CODE_FNC_4_A:!ce&&ie?(ce=!0,ie=!1):ce&&ie?(ce=!1,ie=!1):ie=!0;break;case H.CODE_SHIFT:f=!0,l=H.CODE_CODE_B;break;case H.CODE_CODE_B:l=H.CODE_CODE_B;break;case H.CODE_CODE_C:l=H.CODE_CODE_C;break;case H.CODE_STOP:c=!0;break}break;case H.CODE_CODE_B:if(_<96)ie===ce?d+=String.fromCharCode(32+_):d+=String.fromCharCode(32+_+128),ie=!1;else switch(_!==H.CODE_STOP&&(P=!1),_){case H.CODE_FNC_1:r&&(d.length===0?d+="]C1":d+="");break;case H.CODE_FNC_2:case H.CODE_FNC_3:break;case H.CODE_FNC_4_B:!ce&&ie?(ce=!0,ie=!1):ce&&ie?(ce=!1,ie=!1):ie=!0;break;case H.CODE_SHIFT:f=!0,l=H.CODE_CODE_A;break;case H.CODE_CODE_A:l=H.CODE_CODE_A;break;case H.CODE_CODE_C:l=H.CODE_CODE_C;break;case H.CODE_STOP:c=!0;break}break;case H.CODE_CODE_C:if(_<100)_<10&&(d+="0"),d+=_;else switch(_!==H.CODE_STOP&&(P=!1),_){case H.CODE_FNC_1:r&&(d.length===0?d+="]C1":d+="");break;case H.CODE_CODE_A:l=H.CODE_CODE_A;break;case H.CODE_CODE_B:l=H.CODE_CODE_B;break;case H.CODE_STOP:c=!0;break}break}xn&&(l=l===H.CODE_CODE_A?H.CODE_CODE_B:H.CODE_CODE_A)}const dt=b-A;if(b=t.getNextUnset(b),!t.isRange(b,Math.min(t.getSize(),b+(b-A)/2),!1))throw new O;if(F-=k*S,F%103!==S)throw new re;const _t=d.length;if(_t===0)throw new O;_t>0&&P&&(l===H.CODE_CODE_C?d=d.substring(0,_t-2):d=d.substring(0,_t-1));const xt=(i[1]+i[0])/2,Se=A+dt/2,nt=o.length,At=new Uint8Array(nt);for(let xn=0;xn<nt;xn++)At[xn]=o[xn];const dn=[new Y(xt,e),new Y(Se,e)];return new Le(d,At,0,dn,z.CODE_128,new Date().getTime())}}H.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],H.MAX_AVG_VARIANCE=.25,H.MAX_INDIVIDUAL_VARIANCE=.7,H.CODE_SHIFT=98,H.CODE_CODE_C=99,H.CODE_CODE_B=100,H.CODE_CODE_A=101,H.CODE_FNC_1=102,H.CODE_FNC_2=97,H.CODE_FNC_3=96,H.CODE_FNC_4_A=101,H.CODE_FNC_4_B=100,H.CODE_START_A=103,H.CODE_START_B=104,H.CODE_START_C=105,H.CODE_STOP=106;class ke extends Te{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,n){let r=this.counters;r.fill(0),this.decodeRowResult="";let i=ke.findAsteriskPattern(t,r),s=t.getNextSet(i[1]),a=t.getSize(),o,l;do{ke.recordPattern(t,s,r);let I=ke.toNarrowWidePattern(r);if(I<0)throw new O;o=ke.patternToChar(I),this.decodeRowResult+=o,l=s;for(let S of r)s+=S;s=t.getNextSet(s)}while(o!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let c=0;for(let I of r)c+=I;let f=s-l-c;if(s!==a&&f*2<c)throw new O;if(this.usingCheckDigit){let I=this.decodeRowResult.length-1,S=0;for(let _=0;_<I;_++)S+=ke.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(_));if(this.decodeRowResult.charAt(I)!==ke.ALPHABET_STRING.charAt(S%43))throw new re;this.decodeRowResult=this.decodeRowResult.substring(0,I)}if(this.decodeRowResult.length===0)throw new O;let d;this.extendedMode?d=ke.decodeExtended(this.decodeRowResult):d=this.decodeRowResult;let A=(i[1]+i[0])/2,b=l+c/2;return new Le(d,null,0,[new Y(A,e),new Y(b,e)],z.CODE_39,new Date().getTime())}static findAsteriskPattern(e,t){let n=e.getSize(),r=e.getNextSet(0),i=0,s=r,a=!1,o=t.length;for(let l=r;l<n;l++)if(e.get(l)!==a)t[i]++;else{if(i===o-1){if(this.toNarrowWidePattern(t)===ke.ASTERISK_ENCODING&&e.isRange(Math.max(0,s-Math.floor((l-s)/2)),s,!1))return[s,l];s+=t[0]+t[1],t.copyWithin(0,2,2+i-1),t[i-1]=0,t[i]=0,i--}else i++;t[i]=1,a=!a}throw new O}static toNarrowWidePattern(e){let t=e.length,n=0,r;do{let i=2147483647;for(let o of e)o<i&&o>n&&(i=o);n=i,r=0;let s=0,a=0;for(let o=0;o<t;o++){let l=e[o];l>n&&(a|=1<<t-1-o,r++,s+=l)}if(r===3){for(let o=0;o<t&&r>0;o++){let l=e[o];if(l>n&&(r--,l*2>=s))return-1}return a}}while(r>3);return-1}static patternToChar(e){for(let t=0;t<ke.CHARACTER_ENCODINGS.length;t++)if(ke.CHARACTER_ENCODINGS[t]===e)return ke.ALPHABET_STRING.charAt(t);if(e===ke.ASTERISK_ENCODING)return"*";throw new O}static decodeExtended(e){let t=e.length,n="";for(let r=0;r<t;r++){let i=e.charAt(r);if(i==="+"||i==="$"||i==="%"||i==="/"){let s=e.charAt(r+1),a="\0";switch(i){case"+":if(s>="A"&&s<="Z")a=String.fromCharCode(s.charCodeAt(0)+32);else throw new G;break;case"$":if(s>="A"&&s<="Z")a=String.fromCharCode(s.charCodeAt(0)-64);else throw new G;break;case"%":if(s>="A"&&s<="E")a=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")a=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")a=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")a=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")a="\0";else if(s==="V")a="@";else if(s==="W")a="`";else if(s==="X"||s==="Y"||s==="Z")a="";else throw new G;break;case"/":if(s>="A"&&s<="O")a=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")a=":";else throw new G;break}n+=a,r++}else n+=i}return n}}ke.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",ke.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],ke.ASTERISK_ENCODING=148;class Ce extends Te{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,n){let r=this.decodeStart(t),i=this.decodeEnd(t),s=new de;Ce.decodeMiddle(t,r[1],i[0],s);let a=s.toString(),o=null;n!=null&&(o=n.get(le.ALLOWED_LENGTHS)),o==null&&(o=Ce.DEFAULT_ALLOWED_LENGTHS);let l=a.length,c=!1,f=0;for(let b of o){if(l===b){c=!0;break}b>f&&(f=b)}if(!c&&l>f&&(c=!0),!c)throw new G;const d=[new Y(r[1],e),new Y(i[0],e)];return new Le(a,null,0,d,z.ITF,new Date().getTime())}static decodeMiddle(e,t,n,r){let i=new Int32Array(10),s=new Int32Array(5),a=new Int32Array(5);for(i.fill(0),s.fill(0),a.fill(0);t<n;){Te.recordPattern(e,t,i);for(let l=0;l<5;l++){let c=2*l;s[l]=i[c],a[l]=i[c+1]}let o=Ce.decodeDigit(s);r.append(o.toString()),o=this.decodeDigit(a),r.append(o.toString()),i.forEach(function(l){t+=l})}}decodeStart(e){let t=Ce.skipWhiteSpace(e),n=Ce.findGuardPattern(e,t,Ce.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n}validateQuietZone(e,t){let n=this.narrowLineWidth*10;n=n<t?n:t;for(let r=t-1;n>0&&r>=0&&!e.get(r);r--)n--;if(n!==0)throw new O}static skipWhiteSpace(e){const t=e.getSize(),n=e.getNextSet(0);if(n===t)throw new O;return n}decodeEnd(e){e.reverse();try{let t=Ce.skipWhiteSpace(e),n;try{n=Ce.findGuardPattern(e,t,Ce.END_PATTERN_REVERSED[0])}catch(i){i instanceof O&&(n=Ce.findGuardPattern(e,t,Ce.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,n[0]);let r=n[0];return n[0]=e.getSize()-n[1],n[1]=e.getSize()-r,n}finally{e.reverse()}}static findGuardPattern(e,t,n){let r=n.length,i=new Int32Array(r),s=e.getSize(),a=!1,o=0,l=t;i.fill(0);for(let c=t;c<s;c++)if(e.get(c)!==a)i[o]++;else{if(o===r-1){if(Te.patternMatchVariance(i,n,Ce.MAX_INDIVIDUAL_VARIANCE)<Ce.MAX_AVG_VARIANCE)return[l,c];l+=i[0]+i[1],ne.arraycopy(i,2,i,0,o-1),i[o-1]=0,i[o]=0,o--}else o++;i[o]=1,a=!a}throw new O}static decodeDigit(e){let t=Ce.MAX_AVG_VARIANCE,n=-1,r=Ce.PATTERNS.length;for(let i=0;i<r;i++){let s=Ce.PATTERNS[i],a=Te.patternMatchVariance(e,s,Ce.MAX_INDIVIDUAL_VARIANCE);a<t?(t=a,n=i):a===t&&(n=-1)}if(n>=0)return n%10;throw new O}}Ce.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ce.MAX_AVG_VARIANCE=.38,Ce.MAX_INDIVIDUAL_VARIANCE=.5,Ce.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ce.START_PATTERN=Int32Array.from([1,1,1,1]),Ce.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ue extends Te{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,n,r=0,i=Int32Array.from([0,0,0]);for(;!t;){i=Int32Array.from([0,0,0]),n=Ue.findGuardPattern(e,r,!1,this.START_END_PATTERN,i);let s=n[0];r=n[1];let a=s-(r-s);a>=0&&(t=e.isRange(a,s,!1))}return n}static checkChecksum(e){return Ue.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return Ue.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new G;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new G;n+=i}return(1e3-n)%10}static decodeEnd(e,t){return Ue.findGuardPattern(e,t,!1,Ue.START_END_PATTERN,new Int32Array(Ue.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,n,r){return this.findGuardPattern(e,t,n,r,new Int32Array(r.length))}static findGuardPattern(e,t,n,r,i){let s=e.getSize();t=n?e.getNextUnset(t):e.getNextSet(t);let a=0,o=t,l=r.length,c=n;for(let f=t;f<s;f++)if(e.get(f)!==c)i[a]++;else{if(a===l-1){if(Te.patternMatchVariance(i,r,Ue.MAX_INDIVIDUAL_VARIANCE)<Ue.MAX_AVG_VARIANCE)return Int32Array.from([o,f]);o+=i[0]+i[1];let d=i.slice(2,i.length-1);for(let A=0;A<a-1;A++)i[A]=d[A];i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,c=!c}throw new O}static decodeDigit(e,t,n,r){this.recordPattern(e,n,t);let i=this.MAX_AVG_VARIANCE,s=-1,a=r.length;for(let o=0;o<a;o++){let l=r[o],c=Te.patternMatchVariance(t,l,Ue.MAX_INDIVIDUAL_VARIANCE);c<i&&(i=c,s=o)}if(s>=0)return s;throw new O}}Ue.MAX_AVG_VARIANCE=.48,Ue.MAX_INDIVIDUAL_VARIANCE=.7,Ue.START_END_PATTERN=Int32Array.from([1,1,1]),Ue.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ue.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ue.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Cn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),s=r.toString(),a=Cn.parseExtensionString(s),o=[new Y((n[0]+n[1])/2,e),new Y(i,e)],l=new Le(s,null,0,o,z.UPC_EAN_EXTENSION,new Date().getTime());return a!=null&&l.putAllMetadata(a),l}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],a=0;for(let l=0;l<5&&s<i;l++){let c=Ue.decodeDigit(e,r,s,Ue.L_AND_G_PATTERNS);n+=String.fromCharCode(48+c%10);for(let f of r)s+=f;c>=10&&(a|=1<<4-l),l!==4&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(n.length!==5)throw new O;let o=this.determineCheckDigit(a);if(Cn.extensionChecksum(n.toString())!==o)throw new O;return s}static extensionChecksum(e){let t=e.length,n=0;for(let r=t-2;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-48;n*=3;for(let r=t-1;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-48;return n*=3,n%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new O}static parseExtensionString(e){if(e.length!==5)return null;let t=Cn.parseExtension5String(e);return t==null?null:new Map([[Xe.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}let n=parseInt(e.substring(1)),r=(n/100).toString(),i=n%100,s=i<10?"0"+i:i.toString();return t+r+"."+s}}class Yn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),s=r.toString(),a=Yn.parseExtensionString(s),o=[new Y((n[0]+n[1])/2,e),new Y(i,e)],l=new Le(s,null,0,o,z.UPC_EAN_EXTENSION,new Date().getTime());return a!=null&&l.putAllMetadata(a),l}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],a=0;for(let o=0;o<2&&s<i;o++){let l=Ue.decodeDigit(e,r,s,Ue.L_AND_G_PATTERNS);n+=String.fromCharCode(48+l%10);for(let c of r)s+=c;l>=10&&(a|=1<<1-o),o!==1&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(n.length!==2)throw new O;if(parseInt(n.toString())%4!==a)throw new O;return s}static parseExtensionString(e){return e.length!==2?null:new Map([[Xe.ISSUE_NUMBER,parseInt(e)]])}}class gr{static decodeRow(e,t,n){let r=Ue.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Cn().decodeRow(e,t,r)}catch{return new Yn().decodeRow(e,t,r)}}}gr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class we extends Ue{constructor(){super(),this.decodeRowStringBuffer="",we.L_AND_G_PATTERNS=we.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=we.L_PATTERNS[e-10],n=new Int32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[t.length-r-1];we.L_AND_G_PATTERNS[e]=n}}decodeRow(e,t,n){let r=we.findStartGuardPattern(t),i=n==null?null:n.get(le.NEED_RESULT_POINT_CALLBACK);if(i!=null){const P=new Y((r[0]+r[1])/2,e);i.foundPossibleResultPoint(P)}let s=this.decodeMiddle(t,r,this.decodeRowStringBuffer),a=s.rowOffset,o=s.resultString;if(i!=null){const P=new Y(a,e);i.foundPossibleResultPoint(P)}let l=this.decodeEnd(t,a);if(i!=null){const P=new Y((l[0]+l[1])/2,e);i.foundPossibleResultPoint(P)}let c=l[1],f=c+(c-l[0]);if(f>=t.getSize()||!t.isRange(c,f,!1))throw new O;let d=o.toString();if(d.length<8)throw new G;if(!we.checkChecksum(d))throw new re;let A=(r[1]+r[0])/2,b=(l[1]+l[0])/2,I=this.getBarcodeFormat(),S=[new Y(A,e),new Y(b,e)],_=new Le(d,null,0,S,I,new Date().getTime()),F=0;try{let P=gr.decodeRow(e,t,l[1]);_.putMetadata(Xe.UPC_EAN_EXTENSION,P.getText()),_.putAllMetadata(P.getResultMetadata()),_.addResultPoints(P.getResultPoints()),F=P.getText().length}catch{}let k=n==null?null:n.get(le.ALLOWED_EAN_EXTENSIONS);if(k!=null){let P=!1;for(let ce in k)if(F.toString()===ce){P=!0;break}if(!P)throw new O}return _}decodeEnd(e,t){return we.findGuardPattern(e,t,!1,we.START_END_PATTERN,new Int32Array(we.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return we.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return we.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new G;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new G;n+=i}return(1e3-n)%10}}class qt extends we{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],a=0;for(let l=0;l<6&&s<i;l++){let c=we.decodeDigit(e,r,s,we.L_AND_G_PATTERNS);n+=String.fromCharCode(48+c%10);for(let f of r)s+=f;c>=10&&(a|=1<<5-l)}n=qt.determineFirstDigit(n,a),s=we.findGuardPattern(e,s,!0,we.MIDDLE_PATTERN,new Int32Array(we.MIDDLE_PATTERN.length).fill(0))[1];for(let l=0;l<6&&s<i;l++){let c=we.decodeDigit(e,r,s,we.L_PATTERNS);n+=String.fromCharCode(48+c);for(let f of r)s+=f}return{rowOffset:s,resultString:n}}getBarcodeFormat(){return z.EAN_13}static determineFirstDigit(e,t){for(let n=0;n<10;n++)if(t===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode(48+n)+e,e;throw new O}}qt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class wr extends we{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1];for(let o=0;o<4&&s<i;o++){let l=we.decodeDigit(e,r,s,we.L_PATTERNS);n+=String.fromCharCode(48+l);for(let c of r)s+=c}s=we.findGuardPattern(e,s,!0,we.MIDDLE_PATTERN,new Int32Array(we.MIDDLE_PATTERN.length).fill(0))[1];for(let o=0;o<4&&s<i;o++){let l=we.decodeDigit(e,r,s,we.L_PATTERNS);n+=String.fromCharCode(48+l);for(let c of r)s+=c}return{rowOffset:s,resultString:n}}getBarcodeFormat(){return z.EAN_8}}class mr extends we{constructor(){super(...arguments),this.ean13Reader=new qt}getBarcodeFormat(){return z.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,n))}decodeMiddle(e,t,n){return this.ean13Reader.decodeMiddle(e,t,n)}maybeReturnResult(e){let t=e.getText();if(t.charAt(0)==="0"){let n=new Le(t.substring(1),null,null,e.getResultPoints(),z.UPC_A);return e.getResultMetadata()!=null&&n.putAllMetadata(e.getResultMetadata()),n}else throw new O}reset(){this.ean13Reader.reset()}}class Tt extends we{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters.map(l=>l);r[0]=0,r[1]=0,r[2]=0,r[3]=0;const i=e.getSize();let s=t[1],a=0;for(let l=0;l<6&&s<i;l++){const c=Tt.decodeDigit(e,r,s,Tt.L_AND_G_PATTERNS);n+=String.fromCharCode(48+c%10);for(let f of r)s+=f;c>=10&&(a|=1<<5-l)}let o=Tt.determineNumSysAndCheckDigit(n,a);return{rowOffset:s,resultString:o}}decodeEnd(e,t){return Tt.findGuardPatternWithoutCounters(e,t,!0,Tt.MIDDLE_END_PATTERN)}checkChecksum(e){return we.checkChecksum(Tt.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let n=0;n<=1;n++)for(let r=0;r<10;r++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][r]){let i=String.fromCharCode(48+n),s=String.fromCharCode(48+r);return i+e+s}throw O.getNotFoundInstance()}getBarcodeFormat(){return z.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(i=>i.charCodeAt(0)),n=new de;n.append(e.charAt(0));let r=t[5];switch(r){case 0:case 1:case 2:n.appendChars(t,0,2),n.append(r),n.append("0000"),n.appendChars(t,2,3);break;case 3:n.appendChars(t,0,3),n.append("00000"),n.appendChars(t,3,2);break;case 4:n.appendChars(t,0,4),n.append("00000"),n.append(t[4]);break;default:n.appendChars(t,0,5),n.append("0000"),n.append(r);break}return e.length>=8&&n.append(e.charAt(7)),n.toString()}}Tt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Tt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class zn extends Te{constructor(e){super();let t=e==null?null:e.get(le.POSSIBLE_FORMATS),n=[];E(t)?(n.push(new qt),n.push(new mr),n.push(new wr),n.push(new Tt)):(t.indexOf(z.EAN_13)>-1&&n.push(new qt),t.indexOf(z.UPC_A)>-1&&n.push(new mr),t.indexOf(z.EAN_8)>-1&&n.push(new wr),t.indexOf(z.UPC_E)>-1&&n.push(new Tt)),this.readers=n}decodeRow(e,t,n){for(let r of this.readers)try{const i=r.decodeRow(e,t,n),s=i.getBarcodeFormat()===z.EAN_13&&i.getText().charAt(0)==="0",a=n==null?null:n.get(le.POSSIBLE_FORMATS),o=a==null||a.includes(z.UPC_A);if(s&&o){const l=i.getRawBytes(),c=new Le(i.getText().substring(1),l,l?l.length:null,i.getResultPoints(),z.UPC_A);return c.putAllMetadata(i.getResultMetadata()),c}return i}catch{}throw new O}reset(){for(let e of this.readers)e.reset()}}class it extends Te{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let n=0;n<t.length;n++)if(Te.patternMatchVariance(e,t[n],it.MAX_INDIVIDUAL_VARIANCE)<it.MAX_AVG_VARIANCE)return n;throw new O}static count(e){return Z.sum(new Int32Array(e))}static increment(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]>r&&(r=t[i],n=i);e[n]++}static decrement(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]<r&&(r=t[i],n=i);e[n]--}static isFinderPattern(e){let t=e[0]+e[1],n=t+e[2]+e[3],r=t/n;if(r>=it.MIN_FINDER_PATTERN_RATIO&&r<=it.MAX_FINDER_PATTERN_RATIO){let i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(let a of e)a>s&&(s=a),a<i&&(i=a);return s<10*i}return!1}}it.MAX_AVG_VARIANCE=.2,it.MAX_INDIVIDUAL_VARIANCE=.45,it.MIN_FINDER_PATTERN_RATIO=9.5/12,it.MAX_FINDER_PATTERN_RATIO=12.5/14;class an{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof an))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Mn{constructor(e,t,n,r,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new Y(n,i)),this.resultPoints.push(new Y(r,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof Mn))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class Dt{constructor(){}static getRSSvalue(e,t,n){let r=0;for(let o of e)r+=o;let i=0,s=0,a=e.length;for(let o=0;o<a-1;o++){let l;for(l=1,s|=1<<o;l<e[o];l++,s&=~(1<<o)){let c=Dt.combins(r-l-1,a-o-2);if(n&&s===0&&r-l-(a-o-1)>=a-o-1&&(c-=Dt.combins(r-l-(a-o),a-o-2)),a-o-1>1){let f=0;for(let d=r-l-(a-o-2);d>t;d--)f+=Dt.combins(r-l-d-1,a-o-3);c-=f*(a-1-o)}else r-l>t&&c--;i+=c}r-=l}return i}static combins(e,t){let n,r;e-t>t?(r=t,n=e-t):(r=e-t,n=t);let i=1,s=1;for(let a=e;a>n;a--)i*=a,s<=r&&(i/=s,s++);for(;s<=r;)i/=s,s++;return i}}class Kr{static buildBitArray(e){let t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);let n=12*t,r=new oe(n),i=0,a=e[0].getRightChar().getValue();for(let o=11;o>=0;--o)(a&1<<o)!=0&&r.set(i),i++;for(let o=1;o<e.length;++o){let l=e[o],c=l.getLeftChar().getValue();for(let f=11;f>=0;--f)(c&1<<f)!=0&&r.set(i),i++;if(l.getRightChar()!=null){let f=l.getRightChar().getValue();for(let d=11;d>=0;--d)(f&1<<d)!=0&&r.set(i),i++}}return r}}class Qt{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Zn{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class ut extends Zn{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===ut.FNC1}}ut.FNC1="$";class Jt extends Zn{constructor(e,t,n){super(e),n?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class bt extends Zn{constructor(e,t,n){if(super(e),t<0||t>10||n<0||n>10)throw new G;this.firstDigit=t,this.secondDigit=n}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===bt.FNC1}isSecondDigitFNC1(){return this.secondDigit===bt.FNC1}isAnyFNC1(){return this.firstDigit===bt.FNC1||this.secondDigit===bt.FNC1}}bt.FNC1=10;class X{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new O;let t=e.substring(0,2);for(let i of X.TWO_DIGIT_DATA_LENGTH)if(i[0]===t)return i[1]===X.VARIABLE_LENGTH?X.processVariableAI(2,i[2],e):X.processFixedAI(2,i[1],e);if(e.length<3)throw new O;let n=e.substring(0,3);for(let i of X.THREE_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===X.VARIABLE_LENGTH?X.processVariableAI(3,i[2],e):X.processFixedAI(3,i[1],e);for(let i of X.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===X.VARIABLE_LENGTH?X.processVariableAI(4,i[2],e):X.processFixedAI(4,i[1],e);if(e.length<4)throw new O;let r=e.substring(0,4);for(let i of X.FOUR_DIGIT_DATA_LENGTH)if(i[0]===r)return i[1]===X.VARIABLE_LENGTH?X.processVariableAI(4,i[2],e):X.processFixedAI(4,i[1],e);throw new O}static processFixedAI(e,t,n){if(n.length<e)throw new O;let r=n.substring(0,e);if(n.length<e+t)throw new O;let i=n.substring(e,e+t),s=n.substring(e+t),a="("+r+")"+i,o=X.parseFieldsInGeneralPurpose(s);return o==null?a:a+o}static processVariableAI(e,t,n){let r=n.substring(0,e),i;n.length<e+t?i=n.length:i=e+t;let s=n.substring(e,i),a=n.substring(i),o="("+r+")"+s,l=X.parseFieldsInGeneralPurpose(a);return l==null?o:o+l}}X.VARIABLE_LENGTH=[],X.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",X.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",X.VARIABLE_LENGTH,20],["22",X.VARIABLE_LENGTH,29],["30",X.VARIABLE_LENGTH,8],["37",X.VARIABLE_LENGTH,8],["90",X.VARIABLE_LENGTH,30],["91",X.VARIABLE_LENGTH,30],["92",X.VARIABLE_LENGTH,30],["93",X.VARIABLE_LENGTH,30],["94",X.VARIABLE_LENGTH,30],["95",X.VARIABLE_LENGTH,30],["96",X.VARIABLE_LENGTH,30],["97",X.VARIABLE_LENGTH,3],["98",X.VARIABLE_LENGTH,30],["99",X.VARIABLE_LENGTH,30]],X.THREE_DIGIT_DATA_LENGTH=[["240",X.VARIABLE_LENGTH,30],["241",X.VARIABLE_LENGTH,30],["242",X.VARIABLE_LENGTH,6],["250",X.VARIABLE_LENGTH,30],["251",X.VARIABLE_LENGTH,30],["253",X.VARIABLE_LENGTH,17],["254",X.VARIABLE_LENGTH,20],["400",X.VARIABLE_LENGTH,30],["401",X.VARIABLE_LENGTH,30],["402",17],["403",X.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",X.VARIABLE_LENGTH,20],["421",X.VARIABLE_LENGTH,15],["422",3],["423",X.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],X.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",X.VARIABLE_LENGTH,15],["391",X.VARIABLE_LENGTH,18],["392",X.VARIABLE_LENGTH,15],["393",X.VARIABLE_LENGTH,18],["703",X.VARIABLE_LENGTH,30]],X.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",X.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",X.VARIABLE_LENGTH,20],["8003",X.VARIABLE_LENGTH,30],["8004",X.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",X.VARIABLE_LENGTH,30],["8008",X.VARIABLE_LENGTH,12],["8018",18],["8020",X.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",X.VARIABLE_LENGTH,70],["8200",X.VARIABLE_LENGTH,70]];class on{constructor(e){this.buffer=new de,this.information=e}decodeAllCodes(e,t){let n=t,r=null;do{let i=this.decodeGeneralPurposeField(n,r),s=X.parseFieldsInGeneralPurpose(i.getNewString());if(s!=null&&e.append(s),i.isRemaining()?r=""+i.getRemainingValue():r=null,n===i.getNewPosition())break;n=i.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let i=this.extractNumericValueFromBitArray(e,4);return i===0?new bt(this.information.getSize(),bt.FNC1,bt.FNC1):new bt(this.information.getSize(),i-1,bt.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),n=(t-8)/11,r=(t-8)%11;return new bt(e+7,n,r)}extractNumericValueFromBitArray(e,t){return on.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,n){let r=0;for(let i=0;i<n;++i)e.get(t+i)&&(r|=1<<n-i-1);return r}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);let n=this.parseBlocks();return n!=null&&n.isRemaining()?new Jt(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Jt(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let n=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(n!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return e.isSecondDigitFNC1()?t=new Jt(this.current.getPosition(),this.buffer.toString()):t=new Jt(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Qt(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let t=new Jt(this.current.getPosition(),this.buffer.toString());return new Qt(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Qt(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Jt(this.current.getPosition(),this.buffer.toString());return new Qt(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Qt(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Jt(this.current.getPosition(),this.buffer.toString());return new Qt(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Qt(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,8);return r>=232&&r<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new ut(e+5,ut.FNC1);if(t>=5&&t<15)return new ut(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new ut(e+7,""+(n+1));if(n>=90&&n<116)return new ut(e+7,""+(n+7));let r=this.extractNumericValueFromBitArray(e,8),i;switch(r){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new G}return new ut(e+8,i)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new ut(e+5,ut.FNC1);if(t>=5&&t<15)return new ut(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new ut(e+6,""+(n+33));let r;switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new Et("Decoding invalid alphanumeric value: "+n)}return new ut(e+6,r)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class Kn{constructor(e){this.information=e,this.generalDecoder=new on(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class ht extends Kn{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,n)}encodeCompressedGtinWithoutAI(e,t,n){for(let r=0;r<4;++r){let i=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*r,10);i/100===0&&e.append("0"),i/10===0&&e.append("0"),e.append(i)}ht.appendCheckDigit(e,n)}static appendCheckDigit(e,t){let n=0;for(let r=0;r<13;r++){let i=e.charAt(r+t).charCodeAt(0)-48;n+=(r&1)===0?3*i:i}n=10-n%10,n===10&&(n=0),e.append(n)}}ht.GTIN_SIZE=40;class ln extends ht{constructor(e){super(e)}parseInformation(){let e=new de;e.append("(01)");let t=e.length(),n=this.getGeneralDecoder().extractNumericValueFromBitArray(ln.HEADER_SIZE,4);return e.append(n),this.encodeCompressedGtinWithoutAI(e,ln.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,ln.HEADER_SIZE+44)}}ln.HEADER_SIZE=4;class vn extends Kn{constructor(e){super(e)}parseInformation(){let e=new de;return this.getGeneralDecoder().decodeAllCodes(e,vn.HEADER_SIZE)}}vn.HEADER_SIZE=5;class Bn extends ht{constructor(e){super(e)}encodeCompressedWeight(e,t,n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,n);this.addWeightCode(e,r);let i=this.checkWeight(r),s=1e5;for(let a=0;a<5;++a)i/s===0&&e.append("0"),s/=10;e.append(i)}}class Mt extends Bn{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=Mt.HEADER_SIZE+Bn.GTIN_SIZE+Mt.WEIGHT_SIZE)throw new O;let e=new de;return this.encodeCompressedGtin(e,Mt.HEADER_SIZE),this.encodeCompressedWeight(e,Mt.HEADER_SIZE+Bn.GTIN_SIZE,Mt.WEIGHT_SIZE),e.toString()}}Mt.HEADER_SIZE=5,Mt.WEIGHT_SIZE=15;class qr extends Mt{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class Qr extends Mt{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class vt extends ht{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<vt.HEADER_SIZE+ht.GTIN_SIZE)throw new O;let e=new de;this.encodeCompressedGtin(e,vt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(vt.HEADER_SIZE+ht.GTIN_SIZE,vt.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let n=this.getGeneralDecoder().decodeGeneralPurposeField(vt.HEADER_SIZE+ht.GTIN_SIZE+vt.LAST_DIGIT_SIZE,null);return e.append(n.getNewString()),e.toString()}}vt.HEADER_SIZE=8,vt.LAST_DIGIT_SIZE=2;class ot extends ht{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<ot.HEADER_SIZE+ht.GTIN_SIZE)throw new O;let e=new de;this.encodeCompressedGtin(e,ot.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(ot.HEADER_SIZE+ht.GTIN_SIZE,ot.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let n=this.getGeneralDecoder().extractNumericValueFromBitArray(ot.HEADER_SIZE+ht.GTIN_SIZE+ot.LAST_DIGIT_SIZE,ot.FIRST_THREE_DIGITS_SIZE);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n);let r=this.getGeneralDecoder().decodeGeneralPurposeField(ot.HEADER_SIZE+ht.GTIN_SIZE+ot.LAST_DIGIT_SIZE+ot.FIRST_THREE_DIGITS_SIZE,null);return e.append(r.getNewString()),e.toString()}}ot.HEADER_SIZE=8,ot.LAST_DIGIT_SIZE=2,ot.FIRST_THREE_DIGITS_SIZE=10;class ve extends Bn{constructor(e,t,n){super(e),this.dateCode=n,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=ve.HEADER_SIZE+ve.GTIN_SIZE+ve.WEIGHT_SIZE+ve.DATE_SIZE)throw new O;let e=new de;return this.encodeCompressedGtin(e,ve.HEADER_SIZE),this.encodeCompressedWeight(e,ve.HEADER_SIZE+ve.GTIN_SIZE,ve.WEIGHT_SIZE),this.encodeCompressedDate(e,ve.HEADER_SIZE+ve.GTIN_SIZE+ve.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,ve.DATE_SIZE);if(n==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let r=n%32;n/=32;let i=n%12+1;n/=12;let s=n;s/10==0&&e.append("0"),e.append(s),i/10==0&&e.append("0"),e.append(i),r/10==0&&e.append("0"),e.append(r)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}ve.HEADER_SIZE=8,ve.WEIGHT_SIZE=20,ve.DATE_SIZE=16;function Ar(h){try{if(h.get(1))return new ln(h);if(!h.get(2))return new vn(h);switch(on.extractNumericValueFromBitArray(h,1,4)){case 4:return new qr(h);case 5:return new Qr(h)}switch(on.extractNumericValueFromBitArray(h,1,5)){case 12:return new vt(h);case 13:return new ot(h)}switch(on.extractNumericValueFromBitArray(h,1,7)){case 56:return new ve(h,"310","11");case 57:return new ve(h,"320","11");case 58:return new ve(h,"310","13");case 59:return new ve(h,"320","13");case 60:return new ve(h,"310","15");case 61:return new ve(h,"320","15");case 62:return new ve(h,"310","17");case 63:return new ve(h,"320","17")}}catch(e){throw console.log(e),new Et("unknown decoder: "+h)}}class Ht{constructor(e,t,n,r){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=r}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof Ht?Ht.equalsOrNull(e.leftchar,t.leftchar)&&Ht.equalsOrNull(e.rightchar,t.rightchar)&&Ht.equalsOrNull(e.finderpattern,t.finderpattern):!1}static equalsOrNull(e,t){return e===null?t===null:Ht.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class qn{constructor(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof qn?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1}checkEqualitity(e,t){if(!e||!t)return;let n;return e.forEach((r,i)=>{t.forEach(s=>{r.getLeftChar().getValue()===s.getLeftChar().getValue()&&r.getRightChar().getValue()===s.getRightChar().getValue()&&r.getFinderPatter().getValue()===s.getFinderPatter().getValue()&&(n=!0)})}),n}}class v extends it{constructor(e){super(...arguments),this.pairs=new Array(v.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,t,n){this.pairs.length=0,this.startFromEven=!1;try{return v.constructResult(this.decodeRow2pairs(e,t))}catch(r){this.verbose&&console.log(r)}return this.pairs.length=0,this.startFromEven=!0,v.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(i){if(i instanceof O){if(!this.pairs.length)throw new O;n=!0}}if(this.checkChecksum())return this.pairs;let r;if(this.rows.length?r=!0:r=!1,this.storeRow(e,!1),r){let i=this.checkRowsBoolean(!1);if(i!=null||(i=this.checkRowsBoolean(!0),i!=null))return i}throw new O}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(n){this.verbose&&console.log(n)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let n=t;n<this.rows.length;n++){let r=this.rows[n];this.pairs.length=0;for(let s of e)this.pairs.push(s.getPairs());if(this.pairs.push(r.getPairs()),!v.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let i=new Array(e);i.push(r);try{return this.checkRows(i,n+1)}catch(s){this.verbose&&console.log(s)}}throw new O}static isValidSequence(e){for(let t of v.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let n=!0;for(let r=0;r<e.length;r++)if(e[r].getFinderPattern().getValue()!=t[r]){n=!1;break}if(n)return!0}return!1}storeRow(e,t){let n=0,r=!1,i=!1;for(;n<this.rows.length;){let s=this.rows[n];if(s.getRowNumber()>e){i=s.isEquivalent(this.pairs);break}r=s.isEquivalent(this.pairs),n++}i||r||v.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new qn(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let n of t)if(n.getPairs().length!==e.length){for(let r of n.getPairs())for(let i of e)if(Ht.equals(r,i))break}}static isPartialRow(e,t){for(let n of t){let r=!0;for(let i of e){let s=!1;for(let a of n.getPairs())if(i.equals(a)){s=!0;break}if(!s){r=!1;break}}if(r)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=Kr.buildBitArray(e),r=Ar(t).parseInformation(),i=e[0].getFinderPattern().getResultPoints(),s=e[e.length-1].getFinderPattern().getResultPoints(),a=[i[0],i[1],s[0],s[1]];return new Le(r,null,null,a,z.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),n=e.getRightChar();if(n==null)return!1;let r=n.getChecksumPortion(),i=2;for(let a=1;a<this.pairs.size();++a){let o=this.pairs.get(a);r+=o.getLeftChar().getChecksumPortion(),i++;let l=o.getRightChar();l!=null&&(r+=l.getChecksumPortion(),i++)}return r%=211,211*(i-4)+r==t.getValue()}static getNextSecondBar(e,t){let n;return e.get(t)?(n=e.getNextUnset(t),n=e.getNextSet(n)):(n=e.getNextSet(t),n=e.getNextUnset(n)),n}retrieveNextPair(e,t,n){let r=t.length%2==0;this.startFromEven&&(r=!r);let i,s=!0,a=-1;do this.findNextPair(e,t,a),i=this.parseFoundFinderPattern(e,n,r),i==null?a=v.getNextSecondBar(e,this.startEnd[0]):s=!1;while(s);let o=this.decodeDataCharacter(e,i,r,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new O;let l;try{l=this.decodeDataCharacter(e,i,r,!1)}catch(c){l=null,this.verbose&&console.log(c)}return new Ht(o,l,i,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,t,n){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s;n>=0?s=n:this.isEmptyPair(t)?s=0:s=t[t.length-1].getFinderPattern().getStartEnd()[1];let a=t.length%2!=0;this.startFromEven&&(a=!a);let o=!1;for(;s<i&&(o=!e.get(s),!!o);)s++;let l=0,c=s;for(let f=s;f<i;f++)if(e.get(f)!=o)r[l]++;else{if(l==3){if(a&&v.reverseCounters(r),v.isFinderPattern(r)){this.startEnd[0]=c,this.startEnd[1]=f;return}a&&v.reverseCounters(r),c+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,l--}else l++;r[l]=1,o=!o}throw new O}static reverseCounters(e){let t=e.length;for(let n=0;n<t/2;++n){let r=e[n];e[n]=e[t-n-1],e[t-n-1]=r}}parseFoundFinderPattern(e,t,n){let r,i,s;if(n){let l=this.startEnd[0]-1;for(;l>=0&&!e.get(l);)l--;l++,r=this.startEnd[0]-l,i=l,s=this.startEnd[1]}else i=this.startEnd[0],s=e.getNextUnset(this.startEnd[1]+1),r=s-this.startEnd[1];let a=this.getDecodeFinderCounters();ne.arraycopy(a,0,a,1,a.length-1),a[0]=r;let o;try{o=this.parseFinderValue(a,v.FINDER_PATTERNS)}catch{return null}return new Mn(o,[i,s],i,s,t)}decodeDataCharacter(e,t,n,r){let i=this.getDataCharacterCounters();for(let Se=0;Se<i.length;Se++)i[Se]=0;if(r)v.recordPatternInReverse(e,t.getStartEnd()[0],i);else{v.recordPattern(e,t.getStartEnd()[1],i);for(let Se=0,nt=i.length-1;Se<nt;Se++,nt--){let At=i[Se];i[Se]=i[nt],i[nt]=At}}let s=17,a=Z.sum(new Int32Array(i))/s,o=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(a-o)/o>.3)throw new O;let l=this.getOddCounts(),c=this.getEvenCounts(),f=this.getOddRoundingErrors(),d=this.getEvenRoundingErrors();for(let Se=0;Se<i.length;Se++){let nt=1*i[Se]/a,At=nt+.5;if(At<1){if(nt<.3)throw new O;At=1}else if(At>8){if(nt>8.7)throw new O;At=8}let dn=Se/2;(Se&1)==0?(l[dn]=At,f[dn]=nt-At):(c[dn]=At,d[dn]=nt-At)}this.adjustOddEvenCounts(s);let A=4*t.getValue()+(n?0:2)+(r?0:1)-1,b=0,I=0;for(let Se=l.length-1;Se>=0;Se--){if(v.isNotA1left(t,n,r)){let nt=v.WEIGHTS[A][2*Se];I+=l[Se]*nt}b+=l[Se]}let S=0;for(let Se=c.length-1;Se>=0;Se--)if(v.isNotA1left(t,n,r)){let nt=v.WEIGHTS[A][2*Se+1];S+=c[Se]*nt}let _=I+S;if((b&1)!=0||b>13||b<4)throw new O;let F=(13-b)/2,k=v.SYMBOL_WIDEST[F],P=9-k,ce=Dt.getRSSvalue(l,k,!0),ie=Dt.getRSSvalue(c,P,!1),dt=v.EVEN_TOTAL_SUBSET[F],_t=v.GSUM[F],xt=ce*dt+ie+_t;return new an(xt,_)}static isNotA1left(e,t,n){return!(e.getValue()==0&&t&&n)}adjustOddEvenCounts(e){let t=Z.sum(new Int32Array(this.getOddCounts())),n=Z.sum(new Int32Array(this.getEvenCounts())),r=!1,i=!1;t>13?i=!0:t<4&&(r=!0);let s=!1,a=!1;n>13?a=!0:n<4&&(s=!0);let o=t+n-e,l=(t&1)==1,c=(n&1)==0;if(o==1)if(l){if(c)throw new O;i=!0}else{if(!c)throw new O;a=!0}else if(o==-1)if(l){if(c)throw new O;r=!0}else{if(!c)throw new O;s=!0}else if(o==0){if(l){if(!c)throw new O;t<n?(r=!0,a=!0):(i=!0,s=!0)}else if(c)throw new O}else throw new O;if(r){if(i)throw new O;v.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&v.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(a)throw new O;v.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&v.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}v.SYMBOL_WIDEST=[7,5,4,3,1],v.EVEN_TOTAL_SUBSET=[4,20,52,104,204],v.GSUM=[0,348,1388,2948,3988],v.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],v.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],v.FINDER_PAT_A=0,v.FINDER_PAT_B=1,v.FINDER_PAT_C=2,v.FINDER_PAT_D=3,v.FINDER_PAT_E=4,v.FINDER_PAT_F=5,v.FINDER_PATTERN_SEQUENCES=[[v.FINDER_PAT_A,v.FINDER_PAT_A],[v.FINDER_PAT_A,v.FINDER_PAT_B,v.FINDER_PAT_B],[v.FINDER_PAT_A,v.FINDER_PAT_C,v.FINDER_PAT_B,v.FINDER_PAT_D],[v.FINDER_PAT_A,v.FINDER_PAT_E,v.FINDER_PAT_B,v.FINDER_PAT_D,v.FINDER_PAT_C],[v.FINDER_PAT_A,v.FINDER_PAT_E,v.FINDER_PAT_B,v.FINDER_PAT_D,v.FINDER_PAT_D,v.FINDER_PAT_F],[v.FINDER_PAT_A,v.FINDER_PAT_E,v.FINDER_PAT_B,v.FINDER_PAT_D,v.FINDER_PAT_E,v.FINDER_PAT_F,v.FINDER_PAT_F],[v.FINDER_PAT_A,v.FINDER_PAT_A,v.FINDER_PAT_B,v.FINDER_PAT_B,v.FINDER_PAT_C,v.FINDER_PAT_C,v.FINDER_PAT_D,v.FINDER_PAT_D],[v.FINDER_PAT_A,v.FINDER_PAT_A,v.FINDER_PAT_B,v.FINDER_PAT_B,v.FINDER_PAT_C,v.FINDER_PAT_C,v.FINDER_PAT_D,v.FINDER_PAT_E,v.FINDER_PAT_E],[v.FINDER_PAT_A,v.FINDER_PAT_A,v.FINDER_PAT_B,v.FINDER_PAT_B,v.FINDER_PAT_C,v.FINDER_PAT_C,v.FINDER_PAT_D,v.FINDER_PAT_E,v.FINDER_PAT_F,v.FINDER_PAT_F],[v.FINDER_PAT_A,v.FINDER_PAT_A,v.FINDER_PAT_B,v.FINDER_PAT_B,v.FINDER_PAT_C,v.FINDER_PAT_D,v.FINDER_PAT_D,v.FINDER_PAT_E,v.FINDER_PAT_E,v.FINDER_PAT_F,v.FINDER_PAT_F]],v.MAX_PAIRS=11;class Jr extends an{constructor(e,t,n){super(e,t),this.count=0,this.finderPattern=n}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ve extends it{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,n){const r=this.decodePair(t,!1,e,n);Ve.addOrTally(this.possibleLeftPairs,r),t.reverse();let i=this.decodePair(t,!0,e,n);Ve.addOrTally(this.possibleRightPairs,i),t.reverse();for(let s of this.possibleLeftPairs)if(s.getCount()>1){for(let a of this.possibleRightPairs)if(a.getCount()>1&&Ve.checkChecksum(s,a))return Ve.constructResult(s,a)}throw new O}static addOrTally(e,t){if(t==null)return;let n=!1;for(let r of e)if(r.getValue()===t.getValue()){r.incrementCount(),n=!0;break}n||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let n=4537077*e.getValue()+t.getValue(),r=new String(n).toString(),i=new de;for(let l=13-r.length;l>0;l--)i.append("0");i.append(r);let s=0;for(let l=0;l<13;l++){let c=i.charAt(l).charCodeAt(0)-48;s+=(l&1)===0?3*c:c}s=10-s%10,s===10&&(s=0),i.append(s.toString());let a=e.getFinderPattern().getResultPoints(),o=t.getFinderPattern().getResultPoints();return new Le(i.toString(),null,0,[a[0],a[1],o[0],o[1]],z.RSS_14,new Date().getTime())}static checkChecksum(e,t){let n=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,r=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,n===r}decodePair(e,t,n,r){try{let i=this.findFinderPattern(e,t),s=this.parseFoundFinderPattern(e,n,t,i),a=r==null?null:r.get(le.NEED_RESULT_POINT_CALLBACK);if(a!=null){let c=(i[0]+i[1])/2;t&&(c=e.getSize()-1-c),a.foundPossibleResultPoint(new Y(c,n))}let o=this.decodeDataCharacter(e,s,!0),l=this.decodeDataCharacter(e,s,!1);return new Jr(1597*o.getValue()+l.getValue(),o.getChecksumPortion()+4*l.getChecksumPortion(),s)}catch{return null}}decodeDataCharacter(e,t,n){let r=this.getDataCharacterCounters();for(let S=0;S<r.length;S++)r[S]=0;if(n)Te.recordPatternInReverse(e,t.getStartEnd()[0],r);else{Te.recordPattern(e,t.getStartEnd()[1]+1,r);for(let S=0,_=r.length-1;S<_;S++,_--){let F=r[S];r[S]=r[_],r[_]=F}}let i=n?16:15,s=Z.sum(new Int32Array(r))/i,a=this.getOddCounts(),o=this.getEvenCounts(),l=this.getOddRoundingErrors(),c=this.getEvenRoundingErrors();for(let S=0;S<r.length;S++){let _=r[S]/s,F=Math.floor(_+.5);F<1?F=1:F>8&&(F=8);let k=Math.floor(S/2);(S&1)===0?(a[k]=F,l[k]=_-F):(o[k]=F,c[k]=_-F)}this.adjustOddEvenCounts(n,i);let f=0,d=0;for(let S=a.length-1;S>=0;S--)d*=9,d+=a[S],f+=a[S];let A=0,b=0;for(let S=o.length-1;S>=0;S--)A*=9,A+=o[S],b+=o[S];let I=d+3*A;if(n){if((f&1)!==0||f>12||f<4)throw new O;let S=(12-f)/2,_=Ve.OUTSIDE_ODD_WIDEST[S],F=9-_,k=Dt.getRSSvalue(a,_,!1),P=Dt.getRSSvalue(o,F,!0),ce=Ve.OUTSIDE_EVEN_TOTAL_SUBSET[S],ie=Ve.OUTSIDE_GSUM[S];return new an(k*ce+P+ie,I)}else{if((b&1)!==0||b>10||b<4)throw new O;let S=(10-b)/2,_=Ve.INSIDE_ODD_WIDEST[S],F=9-_,k=Dt.getRSSvalue(a,_,!0),P=Dt.getRSSvalue(o,F,!1),ce=Ve.INSIDE_ODD_TOTAL_SUBSET[S],ie=Ve.INSIDE_GSUM[S];return new an(P*ce+k+ie,I)}}findFinderPattern(e,t){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let r=e.getSize(),i=!1,s=0;for(;s<r&&(i=!e.get(s),t!==i);)s++;let a=0,o=s;for(let l=s;l<r;l++)if(e.get(l)!==i)n[a]++;else{if(a===3){if(it.isFinderPattern(n))return[o,l];o+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,a--}else a++;n[a]=1,i=!i}throw new O}parseFoundFinderPattern(e,t,n,r){let i=e.get(r[0]),s=r[0]-1;for(;s>=0&&i!==e.get(s);)s--;s++;const a=r[0]-s,o=this.getDecodeFinderCounters(),l=new Int32Array(o.length);ne.arraycopy(o,0,l,1,o.length-1),l[0]=a;const c=this.parseFinderValue(l,Ve.FINDER_PATTERNS);let f=s,d=r[1];return n&&(f=e.getSize()-1-f,d=e.getSize()-1-d),new Mn(c,[s,r[1]],f,d,t)}adjustOddEvenCounts(e,t){let n=Z.sum(new Int32Array(this.getOddCounts())),r=Z.sum(new Int32Array(this.getEvenCounts())),i=!1,s=!1,a=!1,o=!1;e?(n>12?s=!0:n<4&&(i=!0),r>12?o=!0:r<4&&(a=!0)):(n>11?s=!0:n<5&&(i=!0),r>10?o=!0:r<4&&(a=!0));let l=n+r-t,c=(n&1)===(e?1:0),f=(r&1)===1;if(l===1)if(c){if(f)throw new O;s=!0}else{if(!f)throw new O;o=!0}else if(l===-1)if(c){if(f)throw new O;i=!0}else{if(!f)throw new O;a=!0}else if(l===0){if(c){if(!f)throw new O;n<r?(i=!0,o=!0):(s=!0,a=!0)}else if(f)throw new O}else throw new O;if(i){if(s)throw new O;it.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&it.decrement(this.getOddCounts(),this.getOddRoundingErrors()),a){if(o)throw new O;it.increment(this.getEvenCounts(),this.getOddRoundingErrors())}o&&it.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ve.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ve.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ve.OUTSIDE_GSUM=[0,161,961,2015,2715],Ve.INSIDE_GSUM=[0,336,1036,1516],Ve.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ve.INSIDE_ODD_WIDEST=[2,4,6,8],Ve.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class cn extends Te{constructor(e,t){super(),this.readers=[],this.verbose=t===!0;const n=e?e.get(le.POSSIBLE_FORMATS):null,r=e&&e.get(le.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;n?((n.includes(z.EAN_13)||n.includes(z.UPC_A)||n.includes(z.EAN_8)||n.includes(z.UPC_E))&&this.readers.push(new zn(e)),n.includes(z.CODE_39)&&this.readers.push(new ke(r)),n.includes(z.CODE_128)&&this.readers.push(new H),n.includes(z.ITF)&&this.readers.push(new Ce),n.includes(z.RSS_14)&&this.readers.push(new Ve),n.includes(z.RSS_EXPANDED)&&this.readers.push(new v(this.verbose))):(this.readers.push(new zn(e)),this.readers.push(new ke),this.readers.push(new zn(e)),this.readers.push(new H),this.readers.push(new Ce),this.readers.push(new Ve),this.readers.push(new v(this.verbose)))}decodeRow(e,t,n){for(let r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(e,t,n)}catch{}throw new O}reset(){this.readers.forEach(e=>e.reset())}}class $r extends Ft{constructor(e=500,t){super(new cn(t),e,t)}}class Ee{constructor(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class me{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class he{constructor(e,t,n,r,i,s){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=i,this.ecBlocks=s;let a=0;const o=s.getECCodewords(),l=s.getECBlocks();for(let c of l)a+=c.getCount()*(c.getDataCodewords()+o);this.totalCodewords=a}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if((e&1)!==0||(t&1)!==0)throw new G;for(let n of he.VERSIONS)if(n.symbolSizeRows===e&&n.symbolSizeColumns===t)return n;throw new G}toString(){return""+this.versionNumber}static buildVersions(){return[new he(1,10,10,8,8,new Ee(5,new me(1,3))),new he(2,12,12,10,10,new Ee(7,new me(1,5))),new he(3,14,14,12,12,new Ee(10,new me(1,8))),new he(4,16,16,14,14,new Ee(12,new me(1,12))),new he(5,18,18,16,16,new Ee(14,new me(1,18))),new he(6,20,20,18,18,new Ee(18,new me(1,22))),new he(7,22,22,20,20,new Ee(20,new me(1,30))),new he(8,24,24,22,22,new Ee(24,new me(1,36))),new he(9,26,26,24,24,new Ee(28,new me(1,44))),new he(10,32,32,14,14,new Ee(36,new me(1,62))),new he(11,36,36,16,16,new Ee(42,new me(1,86))),new he(12,40,40,18,18,new Ee(48,new me(1,114))),new he(13,44,44,20,20,new Ee(56,new me(1,144))),new he(14,48,48,22,22,new Ee(68,new me(1,174))),new he(15,52,52,24,24,new Ee(42,new me(2,102))),new he(16,64,64,14,14,new Ee(56,new me(2,140))),new he(17,72,72,16,16,new Ee(36,new me(4,92))),new he(18,80,80,18,18,new Ee(48,new me(4,114))),new he(19,88,88,20,20,new Ee(56,new me(4,144))),new he(20,96,96,22,22,new Ee(68,new me(4,174))),new he(21,104,104,24,24,new Ee(56,new me(6,136))),new he(22,120,120,18,18,new Ee(68,new me(6,175))),new he(23,132,132,20,20,new Ee(62,new me(8,163))),new he(24,144,144,22,22,new Ee(62,new me(8,156),new me(2,155))),new he(25,8,18,6,16,new Ee(7,new me(1,5))),new he(26,8,32,6,14,new Ee(11,new me(1,10))),new he(27,12,26,10,24,new Ee(14,new me(1,16))),new he(28,12,36,10,16,new Ee(18,new me(1,22))),new he(29,16,36,14,16,new Ee(24,new me(1,32))),new he(30,16,48,14,22,new Ee(28,new me(1,49)))]}}he.VERSIONS=he.buildVersions();class Qn{constructor(e){const t=e.getHeight();if(t<8||t>144||(t&1)!==0)throw new G;this.version=Qn.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new Re(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),n=e.getWidth();return he.getVersionForDimensions(t,n)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,n=4,r=0;const i=this.mappingBitMatrix.getHeight(),s=this.mappingBitMatrix.getWidth();let a=!1,o=!1,l=!1,c=!1;do if(n===i&&r===0&&!a)e[t++]=this.readCorner1(i,s)&255,n-=2,r+=2,a=!0;else if(n===i-2&&r===0&&(s&3)!==0&&!o)e[t++]=this.readCorner2(i,s)&255,n-=2,r+=2,o=!0;else if(n===i+4&&r===2&&(s&7)===0&&!l)e[t++]=this.readCorner3(i,s)&255,n-=2,r+=2,l=!0;else if(n===i-2&&r===0&&(s&7)===4&&!c)e[t++]=this.readCorner4(i,s)&255,n-=2,r+=2,c=!0;else{do n<i&&r>=0&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,s)&255),n-=2,r+=2;while(n>=0&&r<s);n+=1,r+=3;do n>=0&&r<s&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,s)&255),n+=2,r-=2;while(n<i&&r>=0);n+=3,r+=1}while(n<i||r<s);if(t!==this.version.getTotalCodewords())throw new G;return e}readModule(e,t,n,r){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=r,e+=4-(r+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,n,r){let i=0;return this.readModule(e-2,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-2,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t,n,r)&&(i|=1),i<<=1,this.readModule(e,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e,t,n,r)&&(i|=1),i}readCorner1(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}readCorner2(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner3(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner4(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new D("Dimension of bitMatrix must match the version size");const r=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),s=t/r|0,a=n/i|0,o=s*r,l=a*i,c=new Re(l,o);for(let f=0;f<s;++f){const d=f*r;for(let A=0;A<a;++A){const b=A*i;for(let I=0;I<r;++I){const S=f*(r+2)+1+I,_=d+I;for(let F=0;F<i;++F){const k=A*(i+2)+1+F;if(e.get(k,S)){const P=b+F;c.set(P,_)}}}}}return c}}class Jn{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const n=t.getECBlocks();let r=0;const i=n.getECBlocks();for(let I of i)r+=I.getCount();const s=new Array(r);let a=0;for(let I of i)for(let S=0;S<I.getCount();S++){const _=I.getDataCodewords(),F=n.getECCodewords()+_;s[a++]=new Jn(_,new Uint8Array(F))}const l=s[0].codewords.length-n.getECCodewords(),c=l-1;let f=0;for(let I=0;I<c;I++)for(let S=0;S<a;S++)s[S].codewords[I]=e[f++];const d=t.getVersionNumber()===24,A=d?8:a;for(let I=0;I<A;I++)s[I].codewords[l-1]=e[f++];const b=s[0].codewords.length;for(let I=l;I<b;I++)for(let S=0;S<a;S++){const _=d?(S+8)%a:S,F=d&&_>7?I-1:I;s[_].codewords[F]=e[f++]}if(f!==e.length)throw new D;return s}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class $n{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new D(""+e);let t=0,n=this.bitOffset,r=this.byteOffset;const i=this.bytes;if(n>0){const s=8-n,a=e<s?e:s,o=s-a,l=255>>8-a<<o;t=(i[r]&l)>>o,e-=a,n+=a,n===8&&(n=0,r++)}if(e>0){for(;e>=8;)t=t<<8|i[r]&255,r++,e-=8;if(e>0){const s=8-e,a=255>>s<<s;t=t<<e|(i[r]&a)>>s,n+=e}}return this.bitOffset=n,this.byteOffset=r,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Ye;(function(h){h[h.PAD_ENCODE=0]="PAD_ENCODE",h[h.ASCII_ENCODE=1]="ASCII_ENCODE",h[h.C40_ENCODE=2]="C40_ENCODE",h[h.TEXT_ENCODE=3]="TEXT_ENCODE",h[h.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",h[h.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",h[h.BASE256_ENCODE=6]="BASE256_ENCODE"})(Ye||(Ye={}));class Wt{static decode(e){const t=new $n(e),n=new de,r=new de,i=new Array;let s=Ye.ASCII_ENCODE;do if(s===Ye.ASCII_ENCODE)s=this.decodeAsciiSegment(t,n,r);else{switch(s){case Ye.C40_ENCODE:this.decodeC40Segment(t,n);break;case Ye.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case Ye.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case Ye.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case Ye.BASE256_ENCODE:this.decodeBase256Segment(t,n,i);break;default:throw new G}s=Ye.ASCII_ENCODE}while(s!==Ye.PAD_ENCODE&&t.available()>0);return r.length()>0&&n.append(r.toString()),new Vt(e,n.toString(),i.length===0?null:i,null)}static decodeAsciiSegment(e,t,n){let r=!1;do{let i=e.readBits(8);if(i===0)throw new G;if(i<=128)return r&&(i+=128),t.append(String.fromCharCode(i-1)),Ye.ASCII_ENCODE;if(i===129)return Ye.PAD_ENCODE;if(i<=229){const s=i-130;s<10&&t.append("0"),t.append(""+s)}else switch(i){case 230:return Ye.C40_ENCODE;case 231:return Ye.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:r=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return Ye.ANSIX12_ENCODE;case 239:return Ye.TEXT_ENCODE;case 240:return Ye.EDIFACT_ENCODE;case 241:break;default:if(i!==254||e.available()!==0)throw new G;break}}while(e.available()>0);return Ye.ASCII_ENCODE}static decodeC40Segment(e,t){let n=!1;const r=[];let i=0;do{if(e.available()===8)return;const s=e.readBits(8);if(s===254)return;this.parseTwoBytes(s,e.readBits(8),r);for(let a=0;a<3;a++){const o=r[a];switch(i){case 0:if(o<3)i=o+1;else if(o<this.C40_BASIC_SET_CHARS.length){const l=this.C40_BASIC_SET_CHARS[o];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else throw new G;break;case 1:n?(t.append(String.fromCharCode(o+128)),n=!1):t.append(String.fromCharCode(o)),i=0;break;case 2:if(o<this.C40_SHIFT2_SET_CHARS.length){const l=this.C40_SHIFT2_SET_CHARS[o];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(o){case 27:t.append("");break;case 30:n=!0;break;default:throw new G}i=0;break;case 3:n?(t.append(String.fromCharCode(o+224)),n=!1):t.append(String.fromCharCode(o+96)),i=0;break;default:throw new G}}}while(e.available()>0)}static decodeTextSegment(e,t){let n=!1,r=[],i=0;do{if(e.available()===8)return;const s=e.readBits(8);if(s===254)return;this.parseTwoBytes(s,e.readBits(8),r);for(let a=0;a<3;a++){const o=r[a];switch(i){case 0:if(o<3)i=o+1;else if(o<this.TEXT_BASIC_SET_CHARS.length){const l=this.TEXT_BASIC_SET_CHARS[o];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else throw new G;break;case 1:n?(t.append(String.fromCharCode(o+128)),n=!1):t.append(String.fromCharCode(o)),i=0;break;case 2:if(o<this.TEXT_SHIFT2_SET_CHARS.length){const l=this.TEXT_SHIFT2_SET_CHARS[o];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(o){case 27:t.append("");break;case 30:n=!0;break;default:throw new G}i=0;break;case 3:if(o<this.TEXT_SHIFT3_SET_CHARS.length){const l=this.TEXT_SHIFT3_SET_CHARS[o];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l),i=0}else throw new G;break;default:throw new G}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const n=[];do{if(e.available()===8)return;const r=e.readBits(8);if(r===254)return;this.parseTwoBytes(r,e.readBits(8),n);for(let i=0;i<3;i++){const s=n[i];switch(s){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(s<14)t.append(String.fromCharCode(s+44));else if(s<40)t.append(String.fromCharCode(s+51));else throw new G;break}}}while(e.available()>0)}static parseTwoBytes(e,t,n){let r=(e<<8)+t-1,i=Math.floor(r/1600);n[0]=i,r-=i*1600,i=Math.floor(r/40),n[1]=i,n[2]=r-i*40}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let n=0;n<4;n++){let r=e.readBits(6);if(r===31){const i=8-e.getBitOffset();i!==8&&e.readBits(i);return}(r&32)===0&&(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)}static decodeBase256Segment(e,t,n){let r=1+e.getByteOffset();const i=this.unrandomize255State(e.readBits(8),r++);let s;if(i===0?s=e.available()/8|0:i<250?s=i:s=250*(i-249)+this.unrandomize255State(e.readBits(8),r++),s<0)throw new G;const a=new Uint8Array(s);for(let o=0;o<s;o++){if(e.available()<8)throw new G;a[o]=this.unrandomize255State(e.readBits(8),r++)}n.push(a);try{t.append(We.decode(a,Q.ISO88591))}catch(o){throw new Et("Platform does not support required encoding: "+o.message)}}static unrandomize255State(e,t){const n=149*t%255+1,r=e-n;return r>=0?r:r+256}}Wt.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Wt.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Wt.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Wt.TEXT_SHIFT2_SET_CHARS=Wt.C40_SHIFT2_SET_CHARS,Wt.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class ei{constructor(){this.rsDecoder=new Rt(fe.DATA_MATRIX_FIELD_256)}decode(e){const t=new Qn(e),n=t.getVersion(),r=t.readCodewords(),i=Jn.getDataBlocks(r,n);let s=0;for(let l of i)s+=l.getNumDataCodewords();const a=new Uint8Array(s),o=i.length;for(let l=0;l<o;l++){const c=i[l],f=c.getCodewords(),d=c.getNumDataCodewords();this.correctErrors(f,d);for(let A=0;A<d;A++)a[A*o+l]=f[A]}return Wt.decode(a)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new re}for(let r=0;r<t;r++)e[r]=n[r]}}class je{constructor(e){this.image=e,this.rectangleDetector=new pt(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new O;t=this.shiftToModuleCenter(t);const n=t[0],r=t[1],i=t[2],s=t[3];let a=this.transitionsBetween(n,s)+1,o=this.transitionsBetween(i,s)+1;(a&1)===1&&(a+=1),(o&1)===1&&(o+=1),4*a<7*o&&4*o<7*a&&(a=o=Math.max(a,o));let l=je.sampleGrid(this.image,n,r,i,s,a,o);return new Kt(l,[n,r,i,s])}static shiftPoint(e,t,n){let r=(t.getX()-e.getX())/(n+1),i=(t.getY()-e.getY())/(n+1);return new Y(e.getX()+r,e.getY()+i)}static moveAway(e,t,n){let r=e.getX(),i=e.getY();return r<t?r-=1:r+=1,i<n?i-=1:i+=1,new Y(r,i)}detectSolid1(e){let t=e[0],n=e[1],r=e[3],i=e[2],s=this.transitionsBetween(t,n),a=this.transitionsBetween(n,r),o=this.transitionsBetween(r,i),l=this.transitionsBetween(i,t),c=s,f=[i,t,n,r];return c>a&&(c=a,f[0]=t,f[1]=n,f[2]=r,f[3]=i),c>o&&(c=o,f[0]=n,f[1]=r,f[2]=i,f[3]=t),c>l&&(f[0]=r,f[1]=i,f[2]=t,f[3]=n),f}detectSolid2(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i),a=je.shiftPoint(n,r,(s+1)*4),o=je.shiftPoint(r,n,(s+1)*4),l=this.transitionsBetween(a,t),c=this.transitionsBetween(o,i);return l<c?(e[0]=t,e[1]=n,e[2]=r,e[3]=i):(e[0]=n,e[1]=r,e[2]=i,e[3]=t),e}correctTopRight(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i),a=this.transitionsBetween(n,i),o=je.shiftPoint(t,n,(a+1)*4),l=je.shiftPoint(r,n,(s+1)*4);s=this.transitionsBetween(o,i),a=this.transitionsBetween(l,i);let c=new Y(i.getX()+(r.getX()-n.getX())/(s+1),i.getY()+(r.getY()-n.getY())/(s+1)),f=new Y(i.getX()+(t.getX()-n.getX())/(a+1),i.getY()+(t.getY()-n.getY())/(a+1));if(!this.isValid(c))return this.isValid(f)?f:null;if(!this.isValid(f))return c;let d=this.transitionsBetween(o,c)+this.transitionsBetween(l,c),A=this.transitionsBetween(o,f)+this.transitionsBetween(l,f);return d>A?c:f}shiftToModuleCenter(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i)+1,a=this.transitionsBetween(r,i)+1,o=je.shiftPoint(t,n,a*4),l=je.shiftPoint(r,n,s*4);s=this.transitionsBetween(o,i)+1,a=this.transitionsBetween(l,i)+1,(s&1)===1&&(s+=1),(a&1)===1&&(a+=1);let c=(t.getX()+n.getX()+r.getX()+i.getX())/4,f=(t.getY()+n.getY()+r.getY()+i.getY())/4;t=je.moveAway(t,c,f),n=je.moveAway(n,c,f),r=je.moveAway(r,c,f),i=je.moveAway(i,c,f);let d,A;return o=je.shiftPoint(t,n,a*4),o=je.shiftPoint(o,i,s*4),d=je.shiftPoint(n,t,a*4),d=je.shiftPoint(d,r,s*4),l=je.shiftPoint(r,i,a*4),l=je.shiftPoint(l,n,s*4),A=je.shiftPoint(i,r,a*4),A=je.shiftPoint(A,t,s*4),[o,d,l,A]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,n,r,i,s,a){return Ot.getInstance().sampleGrid(e,s,a,.5,.5,s-.5,.5,s-.5,a-.5,.5,a-.5,t.getX(),t.getY(),i.getX(),i.getY(),r.getX(),r.getY(),n.getX(),n.getY())}transitionsBetween(e,t){let n=Math.trunc(e.getX()),r=Math.trunc(e.getY()),i=Math.trunc(t.getX()),s=Math.trunc(t.getY()),a=Math.abs(s-r)>Math.abs(i-n);if(a){let I=n;n=r,r=I,I=i,i=s,s=I}let o=Math.abs(i-n),l=Math.abs(s-r),c=-o/2,f=r<s?1:-1,d=n<i?1:-1,A=0,b=this.image.get(a?r:n,a?n:r);for(let I=n,S=r;I!==i;I+=d){let _=this.image.get(a?S:I,a?I:S);if(_!==b&&(A++,b=_),c+=l,c>0){if(S===s)break;S+=f,c-=o}}return A}}class Xt{constructor(){this.decoder=new ei}decode(e,t=null){let n,r;if(t!=null&&t.has(le.PURE_BARCODE)){const l=Xt.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(l),r=Xt.NO_POINTS}else{const l=new je(e.getBlackMatrix()).detect();n=this.decoder.decode(l.getBits()),r=l.getPoints()}const i=n.getRawBytes(),s=new Le(n.getText(),i,8*i.length,r,z.DATA_MATRIX,ne.currentTimeMillis()),a=n.getByteSegments();a!=null&&s.putMetadata(Xe.BYTE_SEGMENTS,a);const o=n.getECLevel();return o!=null&&s.putMetadata(Xe.ERROR_CORRECTION_LEVEL,o),s}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t==null||n==null)throw new O;const r=this.moduleSize(t,e);let i=t[1];const s=n[1];let a=t[0];const l=(n[0]-a+1)/r,c=(s-i+1)/r;if(l<=0||c<=0)throw new O;const f=r/2;i+=f,a+=f;const d=new Re(l,c);for(let A=0;A<c;A++){const b=i+A*r;for(let I=0;I<l;I++)e.get(a+I*r,b)&&d.set(I,A)}return d}static moduleSize(e,t){const n=t.getWidth();let r=e[0];const i=e[1];for(;r<n&&t.get(r,i);)r++;if(r===n)throw new O;const s=r-e[0];if(s===0)throw new O;return s}}Xt.NO_POINTS=[];class ti extends Ft{constructor(e=500){super(new Xt,e)}}var un;(function(h){h[h.L=0]="L",h[h.M=1]="M",h[h.Q=2]="Q",h[h.H=3]="H"})(un||(un={}));class _e{constructor(e,t,n){this.value=e,this.stringValue=t,this.bits=n,_e.FOR_BITS.set(n,this),_e.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return _e.L;case"M":return _e.M;case"Q":return _e.Q;case"H":return _e.H;default:throw new L(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof _e))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=_e.FOR_BITS.size)throw new D;return _e.FOR_BITS.get(e)}}_e.FOR_BITS=new Map,_e.FOR_VALUE=new Map,_e.L=new _e(un.L,"L",1),_e.M=new _e(un.M,"M",0),_e.Q=new _e(un.Q,"Q",3),_e.H=new _e(un.H,"H",2);class st{constructor(e){this.errorCorrectionLevel=_e.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,t){return $.bitCount(e^t)}static decodeFormatInformation(e,t){const n=st.doDecodeFormatInformation(e,t);return n!==null?n:st.doDecodeFormatInformation(e^st.FORMAT_INFO_MASK_QR,t^st.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;for(const i of st.FORMAT_INFO_DECODE_LOOKUP){const s=i[0];if(s===e||s===t)return new st(i[1]);let a=st.numBitsDiffering(e,s);a<n&&(r=i[1],n=a),e!==t&&(a=st.numBitsDiffering(t,s),a<n&&(r=i[1],n=a))}return n<=3?new st(r):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof st))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}st.FORMAT_INFO_MASK_QR=21522,st.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class N{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const n of t)e+=n.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class m{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class K{constructor(e,t,...n){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=n;let r=0;const i=n[0].getECCodewordsPerBlock(),s=n[0].getECBlocks();for(const a of s)r+=a.getCount()*(a.getDataCodewords()+i);this.totalCodewords=r}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new G;try{return this.getVersionForNumber((e-17)/4)}catch{throw new G}}static getVersionForNumber(e){if(e<1||e>40)throw new D;return K.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,n=0;for(let r=0;r<K.VERSION_DECODE_INFO.length;r++){const i=K.VERSION_DECODE_INFO[r];if(i===e)return K.getVersionForNumber(r+7);const s=st.numBitsDiffering(e,i);s<t&&(n=r+7,t=s)}return t<=3?K.getVersionForNumber(n):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new Re(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const n=this.alignmentPatternCenters.length;for(let r=0;r<n;r++){const i=this.alignmentPatternCenters[r]-2;for(let s=0;s<n;s++)r===0&&(s===0||s===n-1)||r===n-1&&s===0||t.setRegion(this.alignmentPatternCenters[s]-2,i,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}K.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),K.VERSIONS=[new K(1,new Int32Array(0),new N(7,new m(1,19)),new N(10,new m(1,16)),new N(13,new m(1,13)),new N(17,new m(1,9))),new K(2,Int32Array.from([6,18]),new N(10,new m(1,34)),new N(16,new m(1,28)),new N(22,new m(1,22)),new N(28,new m(1,16))),new K(3,Int32Array.from([6,22]),new N(15,new m(1,55)),new N(26,new m(1,44)),new N(18,new m(2,17)),new N(22,new m(2,13))),new K(4,Int32Array.from([6,26]),new N(20,new m(1,80)),new N(18,new m(2,32)),new N(26,new m(2,24)),new N(16,new m(4,9))),new K(5,Int32Array.from([6,30]),new N(26,new m(1,108)),new N(24,new m(2,43)),new N(18,new m(2,15),new m(2,16)),new N(22,new m(2,11),new m(2,12))),new K(6,Int32Array.from([6,34]),new N(18,new m(2,68)),new N(16,new m(4,27)),new N(24,new m(4,19)),new N(28,new m(4,15))),new K(7,Int32Array.from([6,22,38]),new N(20,new m(2,78)),new N(18,new m(4,31)),new N(18,new m(2,14),new m(4,15)),new N(26,new m(4,13),new m(1,14))),new K(8,Int32Array.from([6,24,42]),new N(24,new m(2,97)),new N(22,new m(2,38),new m(2,39)),new N(22,new m(4,18),new m(2,19)),new N(26,new m(4,14),new m(2,15))),new K(9,Int32Array.from([6,26,46]),new N(30,new m(2,116)),new N(22,new m(3,36),new m(2,37)),new N(20,new m(4,16),new m(4,17)),new N(24,new m(4,12),new m(4,13))),new K(10,Int32Array.from([6,28,50]),new N(18,new m(2,68),new m(2,69)),new N(26,new m(4,43),new m(1,44)),new N(24,new m(6,19),new m(2,20)),new N(28,new m(6,15),new m(2,16))),new K(11,Int32Array.from([6,30,54]),new N(20,new m(4,81)),new N(30,new m(1,50),new m(4,51)),new N(28,new m(4,22),new m(4,23)),new N(24,new m(3,12),new m(8,13))),new K(12,Int32Array.from([6,32,58]),new N(24,new m(2,92),new m(2,93)),new N(22,new m(6,36),new m(2,37)),new N(26,new m(4,20),new m(6,21)),new N(28,new m(7,14),new m(4,15))),new K(13,Int32Array.from([6,34,62]),new N(26,new m(4,107)),new N(22,new m(8,37),new m(1,38)),new N(24,new m(8,20),new m(4,21)),new N(22,new m(12,11),new m(4,12))),new K(14,Int32Array.from([6,26,46,66]),new N(30,new m(3,115),new m(1,116)),new N(24,new m(4,40),new m(5,41)),new N(20,new m(11,16),new m(5,17)),new N(24,new m(11,12),new m(5,13))),new K(15,Int32Array.from([6,26,48,70]),new N(22,new m(5,87),new m(1,88)),new N(24,new m(5,41),new m(5,42)),new N(30,new m(5,24),new m(7,25)),new N(24,new m(11,12),new m(7,13))),new K(16,Int32Array.from([6,26,50,74]),new N(24,new m(5,98),new m(1,99)),new N(28,new m(7,45),new m(3,46)),new N(24,new m(15,19),new m(2,20)),new N(30,new m(3,15),new m(13,16))),new K(17,Int32Array.from([6,30,54,78]),new N(28,new m(1,107),new m(5,108)),new N(28,new m(10,46),new m(1,47)),new N(28,new m(1,22),new m(15,23)),new N(28,new m(2,14),new m(17,15))),new K(18,Int32Array.from([6,30,56,82]),new N(30,new m(5,120),new m(1,121)),new N(26,new m(9,43),new m(4,44)),new N(28,new m(17,22),new m(1,23)),new N(28,new m(2,14),new m(19,15))),new K(19,Int32Array.from([6,30,58,86]),new N(28,new m(3,113),new m(4,114)),new N(26,new m(3,44),new m(11,45)),new N(26,new m(17,21),new m(4,22)),new N(26,new m(9,13),new m(16,14))),new K(20,Int32Array.from([6,34,62,90]),new N(28,new m(3,107),new m(5,108)),new N(26,new m(3,41),new m(13,42)),new N(30,new m(15,24),new m(5,25)),new N(28,new m(15,15),new m(10,16))),new K(21,Int32Array.from([6,28,50,72,94]),new N(28,new m(4,116),new m(4,117)),new N(26,new m(17,42)),new N(28,new m(17,22),new m(6,23)),new N(30,new m(19,16),new m(6,17))),new K(22,Int32Array.from([6,26,50,74,98]),new N(28,new m(2,111),new m(7,112)),new N(28,new m(17,46)),new N(30,new m(7,24),new m(16,25)),new N(24,new m(34,13))),new K(23,Int32Array.from([6,30,54,78,102]),new N(30,new m(4,121),new m(5,122)),new N(28,new m(4,47),new m(14,48)),new N(30,new m(11,24),new m(14,25)),new N(30,new m(16,15),new m(14,16))),new K(24,Int32Array.from([6,28,54,80,106]),new N(30,new m(6,117),new m(4,118)),new N(28,new m(6,45),new m(14,46)),new N(30,new m(11,24),new m(16,25)),new N(30,new m(30,16),new m(2,17))),new K(25,Int32Array.from([6,32,58,84,110]),new N(26,new m(8,106),new m(4,107)),new N(28,new m(8,47),new m(13,48)),new N(30,new m(7,24),new m(22,25)),new N(30,new m(22,15),new m(13,16))),new K(26,Int32Array.from([6,30,58,86,114]),new N(28,new m(10,114),new m(2,115)),new N(28,new m(19,46),new m(4,47)),new N(28,new m(28,22),new m(6,23)),new N(30,new m(33,16),new m(4,17))),new K(27,Int32Array.from([6,34,62,90,118]),new N(30,new m(8,122),new m(4,123)),new N(28,new m(22,45),new m(3,46)),new N(30,new m(8,23),new m(26,24)),new N(30,new m(12,15),new m(28,16))),new K(28,Int32Array.from([6,26,50,74,98,122]),new N(30,new m(3,117),new m(10,118)),new N(28,new m(3,45),new m(23,46)),new N(30,new m(4,24),new m(31,25)),new N(30,new m(11,15),new m(31,16))),new K(29,Int32Array.from([6,30,54,78,102,126]),new N(30,new m(7,116),new m(7,117)),new N(28,new m(21,45),new m(7,46)),new N(30,new m(1,23),new m(37,24)),new N(30,new m(19,15),new m(26,16))),new K(30,Int32Array.from([6,26,52,78,104,130]),new N(30,new m(5,115),new m(10,116)),new N(28,new m(19,47),new m(10,48)),new N(30,new m(15,24),new m(25,25)),new N(30,new m(23,15),new m(25,16))),new K(31,Int32Array.from([6,30,56,82,108,134]),new N(30,new m(13,115),new m(3,116)),new N(28,new m(2,46),new m(29,47)),new N(30,new m(42,24),new m(1,25)),new N(30,new m(23,15),new m(28,16))),new K(32,Int32Array.from([6,34,60,86,112,138]),new N(30,new m(17,115)),new N(28,new m(10,46),new m(23,47)),new N(30,new m(10,24),new m(35,25)),new N(30,new m(19,15),new m(35,16))),new K(33,Int32Array.from([6,30,58,86,114,142]),new N(30,new m(17,115),new m(1,116)),new N(28,new m(14,46),new m(21,47)),new N(30,new m(29,24),new m(19,25)),new N(30,new m(11,15),new m(46,16))),new K(34,Int32Array.from([6,34,62,90,118,146]),new N(30,new m(13,115),new m(6,116)),new N(28,new m(14,46),new m(23,47)),new N(30,new m(44,24),new m(7,25)),new N(30,new m(59,16),new m(1,17))),new K(35,Int32Array.from([6,30,54,78,102,126,150]),new N(30,new m(12,121),new m(7,122)),new N(28,new m(12,47),new m(26,48)),new N(30,new m(39,24),new m(14,25)),new N(30,new m(22,15),new m(41,16))),new K(36,Int32Array.from([6,24,50,76,102,128,154]),new N(30,new m(6,121),new m(14,122)),new N(28,new m(6,47),new m(34,48)),new N(30,new m(46,24),new m(10,25)),new N(30,new m(2,15),new m(64,16))),new K(37,Int32Array.from([6,28,54,80,106,132,158]),new N(30,new m(17,122),new m(4,123)),new N(28,new m(29,46),new m(14,47)),new N(30,new m(49,24),new m(10,25)),new N(30,new m(24,15),new m(46,16))),new K(38,Int32Array.from([6,32,58,84,110,136,162]),new N(30,new m(4,122),new m(18,123)),new N(28,new m(13,46),new m(32,47)),new N(30,new m(48,24),new m(14,25)),new N(30,new m(42,15),new m(32,16))),new K(39,Int32Array.from([6,26,54,82,110,138,166]),new N(30,new m(20,117),new m(4,118)),new N(28,new m(40,47),new m(7,48)),new N(30,new m(43,24),new m(22,25)),new N(30,new m(10,15),new m(67,16))),new K(40,Int32Array.from([6,30,58,86,114,142,170]),new N(30,new m(19,118),new m(6,119)),new N(28,new m(18,47),new m(31,48)),new N(30,new m(34,24),new m(34,25)),new N(30,new m(20,15),new m(61,16)))];var Ke;(function(h){h[h.DATA_MASK_000=0]="DATA_MASK_000",h[h.DATA_MASK_001=1]="DATA_MASK_001",h[h.DATA_MASK_010=2]="DATA_MASK_010",h[h.DATA_MASK_011=3]="DATA_MASK_011",h[h.DATA_MASK_100=4]="DATA_MASK_100",h[h.DATA_MASK_101=5]="DATA_MASK_101",h[h.DATA_MASK_110=6]="DATA_MASK_110",h[h.DATA_MASK_111=7]="DATA_MASK_111"})(Ke||(Ke={}));class It{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let n=0;n<t;n++)for(let r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)}}It.values=new Map([[Ke.DATA_MASK_000,new It(Ke.DATA_MASK_000,(h,e)=>(h+e&1)===0)],[Ke.DATA_MASK_001,new It(Ke.DATA_MASK_001,(h,e)=>(h&1)===0)],[Ke.DATA_MASK_010,new It(Ke.DATA_MASK_010,(h,e)=>e%3===0)],[Ke.DATA_MASK_011,new It(Ke.DATA_MASK_011,(h,e)=>(h+e)%3===0)],[Ke.DATA_MASK_100,new It(Ke.DATA_MASK_100,(h,e)=>(Math.floor(h/2)+Math.floor(e/3)&1)===0)],[Ke.DATA_MASK_101,new It(Ke.DATA_MASK_101,(h,e)=>h*e%6===0)],[Ke.DATA_MASK_110,new It(Ke.DATA_MASK_110,(h,e)=>h*e%6<3)],[Ke.DATA_MASK_111,new It(Ke.DATA_MASK_111,(h,e)=>(h+e+h*e%3&1)===0)]]);class ni{constructor(e){const t=e.getHeight();if(t<21||(t&3)!==1)throw new G;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let i=0;i<6;i++)e=this.copyBit(i,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let i=5;i>=0;i--)e=this.copyBit(8,i,e);const t=this.bitMatrix.getHeight();let n=0;const r=t-7;for(let i=t-1;i>=r;i--)n=this.copyBit(8,i,n);for(let i=t-8;i<t;i++)n=this.copyBit(i,8,n);if(this.parsedFormatInfo=st.decodeFormatInformation(e,n),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new G}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return K.getVersionForNumber(t);let n=0;const r=e-11;for(let s=5;s>=0;s--)for(let a=e-9;a>=r;a--)n=this.copyBit(a,s,n);let i=K.decodeVersionInformation(n);if(i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;n=0;for(let s=5;s>=0;s--)for(let a=e-9;a>=r;a--)n=this.copyBit(s,a,n);if(i=K.decodeVersionInformation(n),i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;throw new G}copyBit(e,t,n){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?n<<1|1:n<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),n=It.values.get(e.getDataMask()),r=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,r);const i=t.buildFunctionPattern();let s=!0;const a=new Uint8Array(t.getTotalCodewords());let o=0,l=0,c=0;for(let f=r-1;f>0;f-=2){f===6&&f--;for(let d=0;d<r;d++){const A=s?r-1-d:d;for(let b=0;b<2;b++)i.get(f-b,A)||(c++,l<<=1,this.bitMatrix.get(f-b,A)&&(l|=1),c===8&&(a[o++]=l,c=0,l=0))}s=!s}if(o!==t.getTotalCodewords())throw new G;return a}remask(){if(this.parsedFormatInfo===null)return;const e=It.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,n=e.getWidth();t<n;t++)for(let r=t+1,i=e.getHeight();r<i;r++)e.get(t,r)!==e.get(r,t)&&(e.flip(r,t),e.flip(t,r))}}class er{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,n){if(e.length!==t.getTotalCodewords())throw new D;const r=t.getECBlocksForLevel(n);let i=0;const s=r.getECBlocks();for(const b of s)i+=b.getCount();const a=new Array(i);let o=0;for(const b of s)for(let I=0;I<b.getCount();I++){const S=b.getDataCodewords(),_=r.getECCodewordsPerBlock()+S;a[o++]=new er(S,new Uint8Array(_))}const l=a[0].codewords.length;let c=a.length-1;for(;c>=0&&a[c].codewords.length!==l;)c--;c++;const f=l-r.getECCodewordsPerBlock();let d=0;for(let b=0;b<f;b++)for(let I=0;I<o;I++)a[I].codewords[b]=e[d++];for(let b=c;b<o;b++)a[b].codewords[f]=e[d++];const A=a[0].codewords.length;for(let b=f;b<A;b++)for(let I=0;I<o;I++){const S=I<c?b:b+1;a[I].codewords[S]=e[d++]}return a}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var yt;(function(h){h[h.TERMINATOR=0]="TERMINATOR",h[h.NUMERIC=1]="NUMERIC",h[h.ALPHANUMERIC=2]="ALPHANUMERIC",h[h.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",h[h.BYTE=4]="BYTE",h[h.ECI=5]="ECI",h[h.KANJI=6]="KANJI",h[h.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",h[h.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",h[h.HANZI=9]="HANZI"})(yt||(yt={}));class q{constructor(e,t,n,r){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=r,q.FOR_BITS.set(r,this),q.FOR_VALUE.set(e,this)}static forBits(e){const t=q.FOR_BITS.get(e);if(t===void 0)throw new D;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let n;return t<=9?n=0:t<=26?n=1:n=2,this.characterCountBitsForVersions[n]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof q))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}q.FOR_BITS=new Map,q.FOR_VALUE=new Map,q.TERMINATOR=new q(yt.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),q.NUMERIC=new q(yt.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),q.ALPHANUMERIC=new q(yt.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),q.STRUCTURED_APPEND=new q(yt.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),q.BYTE=new q(yt.BYTE,"BYTE",Int32Array.from([8,16,16]),4),q.ECI=new q(yt.ECI,"ECI",Int32Array.from([0,0,0]),7),q.KANJI=new q(yt.KANJI,"KANJI",Int32Array.from([8,10,12]),8),q.FNC1_FIRST_POSITION=new q(yt.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),q.FNC1_SECOND_POSITION=new q(yt.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),q.HANZI=new q(yt.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Pe{static decode(e,t,n,r){const i=new $n(e);let s=new de;const a=new Array;let o=-1,l=-1;try{let c=null,f=!1,d;do{if(i.available()<4)d=q.TERMINATOR;else{const A=i.readBits(4);d=q.forBits(A)}switch(d){case q.TERMINATOR:break;case q.FNC1_FIRST_POSITION:case q.FNC1_SECOND_POSITION:f=!0;break;case q.STRUCTURED_APPEND:if(i.available()<16)throw new G;o=i.readBits(8),l=i.readBits(8);break;case q.ECI:const A=Pe.parseECIValue(i);if(c=U.getCharacterSetECIByValue(A),c===null)throw new G;break;case q.HANZI:const b=i.readBits(4),I=i.readBits(d.getCharacterCountBits(t));b===Pe.GB2312_SUBSET&&Pe.decodeHanziSegment(i,s,I);break;default:const S=i.readBits(d.getCharacterCountBits(t));switch(d){case q.NUMERIC:Pe.decodeNumericSegment(i,s,S);break;case q.ALPHANUMERIC:Pe.decodeAlphanumericSegment(i,s,S,f);break;case q.BYTE:Pe.decodeByteSegment(i,s,S,c,a,r);break;case q.KANJI:Pe.decodeKanjiSegment(i,s,S);break;default:throw new G}break}}while(d!==q.TERMINATOR)}catch{throw new G}return new Vt(e,s.toString(),a.length===0?null:a,n===null?null:n.toString(),o,l)}static decodeHanziSegment(e,t,n){if(n*13>e.available())throw new G;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const s=e.readBits(13);let a=s/96<<8&4294967295|s%96;a<959?a+=41377:a+=42657,r[i]=a>>8&255,r[i+1]=a&255,i+=2,n--}try{t.append(We.decode(r,Q.GB2312))}catch(s){throw new G(s)}}static decodeKanjiSegment(e,t,n){if(n*13>e.available())throw new G;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const s=e.readBits(13);let a=s/192<<8&4294967295|s%192;a<7936?a+=33088:a+=49472,r[i]=a>>8,r[i+1]=a,i+=2,n--}try{t.append(We.decode(r,Q.SHIFT_JIS))}catch(s){throw new G(s)}}static decodeByteSegment(e,t,n,r,i,s){if(8*n>e.available())throw new G;const a=new Uint8Array(n);for(let l=0;l<n;l++)a[l]=e.readBits(8);let o;r===null?o=Q.guessEncoding(a,s):o=r.getName();try{t.append(We.decode(a,o))}catch(l){throw new G(l)}i.push(a)}static toAlphaNumericChar(e){if(e>=Pe.ALPHANUMERIC_CHARS.length)throw new G;return Pe.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,n,r){const i=t.length();for(;n>1;){if(e.available()<11)throw new G;const s=e.readBits(11);t.append(Pe.toAlphaNumericChar(Math.floor(s/45))),t.append(Pe.toAlphaNumericChar(s%45)),n-=2}if(n===1){if(e.available()<6)throw new G;t.append(Pe.toAlphaNumericChar(e.readBits(6)))}if(r)for(let s=i;s<t.length();s++)t.charAt(s)==="%"&&(s<t.length()-1&&t.charAt(s+1)==="%"?t.deleteCharAt(s+1):t.setCharAt(s,""))}static decodeNumericSegment(e,t,n){for(;n>=3;){if(e.available()<10)throw new G;const r=e.readBits(10);if(r>=1e3)throw new G;t.append(Pe.toAlphaNumericChar(Math.floor(r/100))),t.append(Pe.toAlphaNumericChar(Math.floor(r/10)%10)),t.append(Pe.toAlphaNumericChar(r%10)),n-=3}if(n===2){if(e.available()<7)throw new G;const r=e.readBits(7);if(r>=100)throw new G;t.append(Pe.toAlphaNumericChar(Math.floor(r/10))),t.append(Pe.toAlphaNumericChar(r%10))}else if(n===1){if(e.available()<4)throw new G;const r=e.readBits(4);if(r>=10)throw new G;t.append(Pe.toAlphaNumericChar(r))}}static parseECIValue(e){const t=e.readBits(8);if((t&128)===0)return t&127;if((t&192)===128){const n=e.readBits(8);return(t&63)<<8&4294967295|n}if((t&224)===192){const n=e.readBits(16);return(t&31)<<16&4294967295|n}throw new G}}Pe.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Pe.GB2312_SUBSET=1;class Cr{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class ri{constructor(){this.rsDecoder=new Rt(fe.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(Re.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const n=new ni(e);let r=null;try{return this.decodeBitMatrixParser(n,t)}catch(i){r=i}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();const i=this.decodeBitMatrixParser(n,t);return i.setOther(new Cr(!0)),i}catch(i){throw r!==null?r:i}}decodeBitMatrixParser(e,t){const n=e.readVersion(),r=e.readFormatInformation().getErrorCorrectionLevel(),i=e.readCodewords(),s=er.getDataBlocks(i,n,r);let a=0;for(const c of s)a+=c.getNumDataCodewords();const o=new Uint8Array(a);let l=0;for(const c of s){const f=c.getCodewords(),d=c.getNumDataCodewords();this.correctErrors(f,d);for(let A=0;A<d;A++)o[l++]=f[A]}return Pe.decode(o,n,r,t)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new re}for(let r=0;r<t;r++)e[r]=n[r]}}class tr extends Y{constructor(e,t,n){super(e,t),this.estimatedModuleSize=n}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=(this.getX()+t)/2,i=(this.getY()+e)/2,s=(this.estimatedModuleSize+n)/2;return new tr(r,i,s)}}class Pn{constructor(e,t,n,r,i,s,a){this.image=e,this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=s,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,n=this.width,r=e+n,i=this.startY+t/2,s=new Int32Array(3),a=this.image;for(let o=0;o<t;o++){const l=i+((o&1)===0?Math.floor((o+1)/2):-Math.floor((o+1)/2));s[0]=0,s[1]=0,s[2]=0;let c=e;for(;c<r&&!a.get(c,l);)c++;let f=0;for(;c<r;){if(a.get(c,l))if(f===1)s[1]++;else if(f===2){if(this.foundPatternCross(s)){const d=this.handlePossibleCenter(s,l,c);if(d!==null)return d}s[0]=s[2],s[1]=1,s[2]=0,f=1}else s[++f]++;else f===1&&f++,s[f]++;c++}if(this.foundPatternCross(s)){const d=this.handlePossibleCenter(s,l,r);if(d!==null)return d}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new O}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,n=t/2;for(let r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0}crossCheckVertical(e,t,n,r){const i=this.image,s=i.getHeight(),a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;let o=e;for(;o>=0&&i.get(t,o)&&a[1]<=n;)a[1]++,o--;if(o<0||a[1]>n)return NaN;for(;o>=0&&!i.get(t,o)&&a[0]<=n;)a[0]++,o--;if(a[0]>n)return NaN;for(o=e+1;o<s&&i.get(t,o)&&a[1]<=n;)a[1]++,o++;if(o===s||a[1]>n)return NaN;for(;o<s&&!i.get(t,o)&&a[2]<=n;)a[2]++,o++;if(a[2]>n)return NaN;const l=a[0]+a[1]+a[2];return 5*Math.abs(l-r)>=2*r?NaN:this.foundPatternCross(a)?Pn.centerFromEnd(a,o):NaN}handlePossibleCenter(e,t,n){const r=e[0]+e[1]+e[2],i=Pn.centerFromEnd(e,n),s=this.crossCheckVertical(t,i,2*e[1],r);if(!isNaN(s)){const a=(e[0]+e[1]+e[2])/3;for(const l of this.possibleCenters)if(l.aboutEquals(a,s,i))return l.combineEstimate(s,i,a);const o=new tr(i,s,a);this.possibleCenters.push(o),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(o)}return null}}class nr extends Y{constructor(e,t,n,r){super(e,t),this.estimatedModuleSize=n,this.count=r,r===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=this.count+1,i=(this.count*this.getX()+t)/r,s=(this.count*this.getY()+e)/r,a=(this.count*this.estimatedModuleSize+n)/r;return new nr(i,s,a,r)}}class ii{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class qe{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get(le.TRY_HARDER)!==void 0,n=e!=null&&e.get(le.PURE_BARCODE)!==void 0,r=this.image,i=r.getHeight(),s=r.getWidth();let a=Math.floor(3*i/(4*qe.MAX_MODULES));(a<qe.MIN_SKIP||t)&&(a=qe.MIN_SKIP);let o=!1;const l=new Int32Array(5);for(let f=a-1;f<i&&!o;f+=a){l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0;let d=0;for(let A=0;A<s;A++)if(r.get(A,f))(d&1)===1&&d++,l[d]++;else if((d&1)===0)if(d===4)if(qe.foundPatternCross(l)){if(this.handlePossibleCenter(l,f,A,n)===!0)if(a=2,this.hasSkipped===!0)o=this.haveMultiplyConfirmedCenters();else{const I=this.findRowSkip();I>l[2]&&(f+=I-l[2]-a,A=s-1)}else{l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,d=3;continue}d=0,l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0}else l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,d=3;else l[++d]++;else l[d]++;qe.foundPatternCross(l)&&this.handlePossibleCenter(l,f,s,n)===!0&&(a=l[0],this.hasSkipped&&(o=this.haveMultiplyConfirmedCenters()))}const c=this.selectBestPatterns();return Y.orderBestPatterns(c),new ii(c)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let i=0;i<5;i++){const s=e[i];if(s===0)return!1;t+=s}if(t<7)return!1;const n=t/7,r=n/2;return Math.abs(n-e[0])<r&&Math.abs(n-e[1])<r&&Math.abs(3*n-e[2])<3*r&&Math.abs(n-e[3])<r&&Math.abs(n-e[4])<r}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,n,r){const i=this.getCrossCheckStateCount();let s=0;const a=this.image;for(;e>=s&&t>=s&&a.get(t-s,e-s);)i[2]++,s++;if(e<s||t<s)return!1;for(;e>=s&&t>=s&&!a.get(t-s,e-s)&&i[1]<=n;)i[1]++,s++;if(e<s||t<s||i[1]>n)return!1;for(;e>=s&&t>=s&&a.get(t-s,e-s)&&i[0]<=n;)i[0]++,s++;if(i[0]>n)return!1;const o=a.getHeight(),l=a.getWidth();for(s=1;e+s<o&&t+s<l&&a.get(t+s,e+s);)i[2]++,s++;if(e+s>=o||t+s>=l)return!1;for(;e+s<o&&t+s<l&&!a.get(t+s,e+s)&&i[3]<n;)i[3]++,s++;if(e+s>=o||t+s>=l||i[3]>=n)return!1;for(;e+s<o&&t+s<l&&a.get(t+s,e+s)&&i[4]<n;)i[4]++,s++;if(i[4]>=n)return!1;const c=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(c-r)<2*r&&qe.foundPatternCross(i)}crossCheckVertical(e,t,n,r){const i=this.image,s=i.getHeight(),a=this.getCrossCheckStateCount();let o=e;for(;o>=0&&i.get(t,o);)a[2]++,o--;if(o<0)return NaN;for(;o>=0&&!i.get(t,o)&&a[1]<=n;)a[1]++,o--;if(o<0||a[1]>n)return NaN;for(;o>=0&&i.get(t,o)&&a[0]<=n;)a[0]++,o--;if(a[0]>n)return NaN;for(o=e+1;o<s&&i.get(t,o);)a[2]++,o++;if(o===s)return NaN;for(;o<s&&!i.get(t,o)&&a[3]<n;)a[3]++,o++;if(o===s||a[3]>=n)return NaN;for(;o<s&&i.get(t,o)&&a[4]<n;)a[4]++,o++;if(a[4]>=n)return NaN;const l=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(l-r)>=2*r?NaN:qe.foundPatternCross(a)?qe.centerFromEnd(a,o):NaN}crossCheckHorizontal(e,t,n,r){const i=this.image,s=i.getWidth(),a=this.getCrossCheckStateCount();let o=e;for(;o>=0&&i.get(o,t);)a[2]++,o--;if(o<0)return NaN;for(;o>=0&&!i.get(o,t)&&a[1]<=n;)a[1]++,o--;if(o<0||a[1]>n)return NaN;for(;o>=0&&i.get(o,t)&&a[0]<=n;)a[0]++,o--;if(a[0]>n)return NaN;for(o=e+1;o<s&&i.get(o,t);)a[2]++,o++;if(o===s)return NaN;for(;o<s&&!i.get(o,t)&&a[3]<n;)a[3]++,o++;if(o===s||a[3]>=n)return NaN;for(;o<s&&i.get(o,t)&&a[4]<n;)a[4]++,o++;if(a[4]>=n)return NaN;const l=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(l-r)>=r?NaN:qe.foundPatternCross(a)?qe.centerFromEnd(a,o):NaN}handlePossibleCenter(e,t,n,r){const i=e[0]+e[1]+e[2]+e[3]+e[4];let s=qe.centerFromEnd(e,n),a=this.crossCheckVertical(t,Math.floor(s),e[2],i);if(!isNaN(a)&&(s=this.crossCheckHorizontal(Math.floor(s),Math.floor(a),e[2],i),!isNaN(s)&&(!r||this.crossCheckDiagonal(Math.floor(a),Math.floor(s),e[2],i)))){const o=i/7;let l=!1;const c=this.possibleCenters;for(let f=0,d=c.length;f<d;f++){const A=c[f];if(A.aboutEquals(o,a,s)){c[f]=A.combineEstimate(a,s,o),l=!0;break}}if(!l){const f=new nr(s,a,o);c.push(f),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(f)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const n of this.possibleCenters)if(n.getCount()>=qe.CENTER_QUORUM)if(t==null)t=n;else return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-n.getX())-Math.abs(t.getY()-n.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const n=this.possibleCenters.length;for(const s of this.possibleCenters)s.getCount()>=qe.CENTER_QUORUM&&(e++,t+=s.getEstimatedModuleSize());if(e<3)return!1;const r=t/n;let i=0;for(const s of this.possibleCenters)i+=Math.abs(s.getEstimatedModuleSize()-r);return i<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new O;const t=this.possibleCenters;let n;if(e>3){let r=0,i=0;for(const o of this.possibleCenters){const l=o.getEstimatedModuleSize();r+=l,i+=l*l}n=r/e;let s=Math.sqrt(i/e-n*n);t.sort((o,l)=>{const c=Math.abs(l.getEstimatedModuleSize()-n),f=Math.abs(o.getEstimatedModuleSize()-n);return c<f?-1:c>f?1:0});const a=Math.max(.2*n,s);for(let o=0;o<t.length&&t.length>3;o++){const l=t[o];Math.abs(l.getEstimatedModuleSize()-n)>a&&(t.splice(o,1),o--)}}if(t.length>3){let r=0;for(const i of t)r+=i.getEstimatedModuleSize();n=r/t.length,t.sort((i,s)=>{if(s.getCount()===i.getCount()){const a=Math.abs(s.getEstimatedModuleSize()-n),o=Math.abs(i.getEstimatedModuleSize()-n);return a<o?1:a>o?-1:0}else return s.getCount()-i.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}qe.CENTER_QUORUM=2,qe.MIN_SKIP=3,qe.MAX_MODULES=57;class En{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(le.NEED_RESULT_POINT_CALLBACK);const n=new qe(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(n)}processFinderPatternInfo(e){const t=e.getTopLeft(),n=e.getTopRight(),r=e.getBottomLeft(),i=this.calculateModuleSize(t,n,r);if(i<1)throw new O("No pattern found in proccess finder.");const s=En.computeDimension(t,n,r,i),a=K.getProvisionalVersionForDimension(s),o=a.getDimensionForVersion()-7;let l=null;if(a.getAlignmentPatternCenters().length>0){const A=n.getX()-t.getX()+r.getX(),b=n.getY()-t.getY()+r.getY(),I=1-3/o,S=Math.floor(t.getX()+I*(A-t.getX())),_=Math.floor(t.getY()+I*(b-t.getY()));for(let F=4;F<=16;F<<=1)try{l=this.findAlignmentInRegion(i,S,_,F);break}catch(k){if(!(k instanceof O))throw k}}const c=En.createTransform(t,n,r,l,s),f=En.sampleGrid(this.image,c,s);let d;return l===null?d=[r,t,n]:d=[r,t,n,l],new Kt(f,d)}static createTransform(e,t,n,r,i){const s=i-3.5;let a,o,l,c;return r!==null?(a=r.getX(),o=r.getY(),l=s-3,c=l):(a=t.getX()-e.getX()+n.getX(),o=t.getY()-e.getY()+n.getY(),l=s,c=s),mt.quadrilateralToQuadrilateral(3.5,3.5,s,3.5,l,c,3.5,s,e.getX(),e.getY(),t.getX(),t.getY(),a,o,n.getX(),n.getY())}static sampleGrid(e,t,n){return Ot.getInstance().sampleGridWithTransform(e,n,n,t)}static computeDimension(e,t,n,r){const i=Z.round(Y.distance(e,t)/r),s=Z.round(Y.distance(e,n)/r);let a=Math.floor((i+s)/2)+7;switch(a&3){case 0:a++;break;case 2:a--;break;case 3:throw new O("Dimensions could be not found.")}return a}calculateModuleSize(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2}calculateModuleSizeOneWay(e,t){const n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,n,r){let i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),s=1,a=e-(n-e);a<0?(s=e/(e-a),a=0):a>=this.image.getWidth()&&(s=(this.image.getWidth()-1-e)/(a-e),a=this.image.getWidth()-1);let o=Math.floor(t-(r-t)*s);return s=1,o<0?(s=t/(t-o),o=0):o>=this.image.getHeight()&&(s=(this.image.getHeight()-1-t)/(o-t),o=this.image.getHeight()-1),a=Math.floor(e+(a-e)*s),i+=this.sizeOfBlackWhiteBlackRun(e,t,a,o),i-1}sizeOfBlackWhiteBlackRun(e,t,n,r){const i=Math.abs(r-t)>Math.abs(n-e);if(i){let A=e;e=t,t=A,A=n,n=r,r=A}const s=Math.abs(n-e),a=Math.abs(r-t);let o=-s/2;const l=e<n?1:-1,c=t<r?1:-1;let f=0;const d=n+l;for(let A=e,b=t;A!==d;A+=l){const I=i?b:A,S=i?A:b;if(f===1===this.image.get(I,S)){if(f===2)return Z.distance(A,b,e,t);f++}if(o+=a,o>0){if(b===r)break;b+=c,o-=s}}return f===2?Z.distance(n+l,r,e,t):NaN}findAlignmentInRegion(e,t,n,r){const i=Math.floor(r*e),s=Math.max(0,t-i),a=Math.min(this.image.getWidth()-1,t+i);if(a-s<e*3)throw new O("Alignment top exceeds estimated module size.");const o=Math.max(0,n-i),l=Math.min(this.image.getHeight()-1,n+i);if(l-o<e*3)throw new O("Alignment bottom exceeds estimated module size.");return new Pn(this.image,s,o,a-s,l-o,e,this.resultPointCallback).find()}}class jt{constructor(){this.decoder=new ri}getDecoder(){return this.decoder}decode(e,t){let n,r;if(t!=null&&t.get(le.PURE_BARCODE)!==void 0){const o=jt.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(o,t),r=jt.NO_POINTS}else{const o=new En(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(o.getBits(),t),r=o.getPoints()}n.getOther()instanceof Cr&&n.getOther().applyMirroredCorrection(r);const i=new Le(n.getText(),n.getRawBytes(),void 0,r,z.QR_CODE,void 0),s=n.getByteSegments();s!==null&&i.putMetadata(Xe.BYTE_SEGMENTS,s);const a=n.getECLevel();return a!==null&&i.putMetadata(Xe.ERROR_CORRECTION_LEVEL,a),n.hasStructuredAppend()&&(i.putMetadata(Xe.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),i.putMetadata(Xe.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t===null||n===null)throw new O;const r=this.moduleSize(t,e);let i=t[1],s=n[1],a=t[0],o=n[0];if(a>=o||i>=s)throw new O;if(s-i!==o-a&&(o=a+(s-i),o>=e.getWidth()))throw new O;const l=Math.round((o-a+1)/r),c=Math.round((s-i+1)/r);if(l<=0||c<=0)throw new O;if(c!==l)throw new O;const f=Math.floor(r/2);i+=f,a+=f;const d=a+Math.floor((l-1)*r)-o;if(d>0){if(d>f)throw new O;a-=d}const A=i+Math.floor((c-1)*r)-s;if(A>0){if(A>f)throw new O;i-=A}const b=new Re(l,c);for(let I=0;I<c;I++){const S=i+Math.floor(I*r);for(let _=0;_<l;_++)e.get(a+Math.floor(_*r),S)&&b.set(_,I)}return b}static moduleSize(e,t){const n=t.getHeight(),r=t.getWidth();let i=e[0],s=e[1],a=!0,o=0;for(;i<r&&s<n;){if(a!==t.get(i,s)){if(++o===5)break;a=!a}i++,s++}if(i===r||s===n)throw new O;return(i-e[0])/7}}jt.NO_POINTS=new Array;class ee{PDF417Common(){}static getBitCountSum(e){return Z.sum(e)}static toIntArray(e){if(e==null||!e.length)return ee.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let n=0;for(const r of e)t[n++]=r;return t}static getCodeword(e){const t=pe.binarySearch(ee.SYMBOL_TABLE,e&262143);return t<0?-1:(ee.CODEWORD_TABLE[t]-1)%ee.NUMBER_OF_CODEWORDS}}ee.NUMBER_OF_CODEWORDS=929,ee.MAX_CODEWORDS_IN_BARCODE=ee.NUMBER_OF_CODEWORDS-1,ee.MIN_ROWS_IN_BARCODE=3,ee.MAX_ROWS_IN_BARCODE=90,ee.MODULES_IN_CODEWORD=17,ee.MODULES_IN_STOP_PATTERN=18,ee.BARS_IN_MODULE=8,ee.EMPTY_INT_ARRAY=new Int32Array([]),ee.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ee.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class si{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class se{static detectMultiple(e,t,n){let r=e.getBlackMatrix(),i=se.detect(n,r);return i.length||(r=r.clone(),r.rotate180(),i=se.detect(n,r)),new si(r,i)}static detect(e,t){const n=new Array;let r=0,i=0,s=!1;for(;r<t.getHeight();){const a=se.findVertices(t,r,i);if(a[0]==null&&a[3]==null){if(!s)break;s=!1,i=0;for(const o of n)o[1]!=null&&(r=Math.trunc(Math.max(r,o[1].getY()))),o[3]!=null&&(r=Math.max(r,Math.trunc(o[3].getY())));r+=se.ROW_STEP;continue}if(s=!0,n.push(a),!e)break;a[2]!=null?(i=Math.trunc(a[2].getX()),r=Math.trunc(a[2].getY())):(i=Math.trunc(a[4].getX()),r=Math.trunc(a[4].getY()))}return n}static findVertices(e,t,n){const r=e.getHeight(),i=e.getWidth(),s=new Array(8);return se.copyToResult(s,se.findRowsWithPattern(e,r,i,t,n,se.START_PATTERN),se.INDEXES_START_PATTERN),s[4]!=null&&(n=Math.trunc(s[4].getX()),t=Math.trunc(s[4].getY())),se.copyToResult(s,se.findRowsWithPattern(e,r,i,t,n,se.STOP_PATTERN),se.INDEXES_STOP_PATTERN),s}static copyToResult(e,t,n){for(let r=0;r<n.length;r++)e[n[r]]=t[r]}static findRowsWithPattern(e,t,n,r,i,s){const a=new Array(4);let o=!1;const l=new Int32Array(s.length);for(;r<t;r+=se.ROW_STEP){let f=se.findGuardPattern(e,i,r,n,!1,s,l);if(f!=null){for(;r>0;){const d=se.findGuardPattern(e,i,--r,n,!1,s,l);if(d!=null)f=d;else{r++;break}}a[0]=new Y(f[0],r),a[1]=new Y(f[1],r),o=!0;break}}let c=r+1;if(o){let f=0,d=Int32Array.from([Math.trunc(a[0].getX()),Math.trunc(a[1].getX())]);for(;c<t;c++){const A=se.findGuardPattern(e,d[0],c,n,!1,s,l);if(A!=null&&Math.abs(d[0]-A[0])<se.MAX_PATTERN_DRIFT&&Math.abs(d[1]-A[1])<se.MAX_PATTERN_DRIFT)d=A,f=0;else{if(f>se.SKIPPED_ROW_COUNT_MAX)break;f++}}c-=f+1,a[2]=new Y(d[0],c),a[3]=new Y(d[1],c)}return c-r<se.BARCODE_MIN_HEIGHT&&pe.fill(a,null),a}static findGuardPattern(e,t,n,r,i,s,a){pe.fillWithin(a,0,a.length,0);let o=t,l=0;for(;e.get(o,n)&&o>0&&l++<se.MAX_PIXEL_DRIFT;)o--;let c=o,f=0,d=s.length;for(let A=i;c<r;c++)if(e.get(c,n)!==A)a[f]++;else{if(f===d-1){if(se.patternMatchVariance(a,s,se.MAX_INDIVIDUAL_VARIANCE)<se.MAX_AVG_VARIANCE)return new Int32Array([o,c]);o+=a[0]+a[1],ne.arraycopy(a,2,a,0,f-1),a[f-1]=0,a[f]=0,f--}else f++;a[f]=1,A=!A}return f===d-1&&se.patternMatchVariance(a,s,se.MAX_INDIVIDUAL_VARIANCE)<se.MAX_AVG_VARIANCE?new Int32Array([o,c-1]):null}static patternMatchVariance(e,t,n){let r=e.length,i=0,s=0;for(let l=0;l<r;l++)i+=e[l],s+=t[l];if(i<s)return 1/0;let a=i/s;n*=a;let o=0;for(let l=0;l<r;l++){let c=e[l],f=t[l]*a,d=c>f?c-f:f-c;if(d>n)return 1/0;o+=d}return o/i}}se.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),se.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),se.MAX_AVG_VARIANCE=.42,se.MAX_INDIVIDUAL_VARIANCE=.8,se.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),se.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),se.MAX_PIXEL_DRIFT=3,se.MAX_PATTERN_DRIFT=5,se.SKIPPED_ROW_COUNT_MAX=25,se.ROW_STEP=5,se.BARCODE_MIN_HEIGHT=10;class et{constructor(e,t){if(t.length===0)throw new D;this.field=e;let n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-r),ne.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let r=0;for(let i of this.coefficients)r=this.field.add(r,i);return r}let t=this.coefficients[0],n=this.coefficients.length;for(let r=1;r<n;r++)t=this.field.add(this.field.multiply(e,t),this.coefficients[r]);return t}add(e){if(!this.field.equals(e.field))throw new D("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){let s=t;t=n,n=s}let r=new Int32Array(n.length),i=n.length-t.length;ne.arraycopy(n,0,r,0,i);for(let s=i;s<n.length;s++)r[s]=this.field.add(t[s-i],n[s]);return new et(this.field,r)}subtract(e){if(!this.field.equals(e.field))throw new D("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof et?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new D("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new et(this.field,new Int32Array([0]));let t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,s=new Int32Array(n+i-1);for(let a=0;a<n;a++){let o=t[a];for(let l=0;l<i;l++)s[a+l]=this.field.add(s[a+l],this.field.multiply(o,r[l]))}return new et(this.field,s)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new et(this.field,t)}multiplyScalar(e){if(e===0)return new et(this.field,new Int32Array([0]));if(e===1)return this;let t=this.coefficients.length,n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new et(this.field,n)}multiplyByMonomial(e,t){if(e<0)throw new D;if(t===0)return new et(this.field,new Int32Array([0]));let n=this.coefficients.length,r=new Int32Array(n+e);for(let i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new et(this.field,r)}toString(){let e=new de;for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(t===0||n!==1)&&e.append(n),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class ai{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new D;return this.logTable[e]}inverse(e){if(e===0)throw new rn;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class rr extends ai{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let n=1;for(let r=0;r<e;r++)this.expTable[r]=n,n=n*t%e;for(let r=0;r<e-1;r++)this.logTable[this.expTable[r]]=r;this.zero=new et(this,new Int32Array([0])),this.one=new et(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new D;if(t===0)return this.zero;let n=new Int32Array(e+1);return n[0]=t,new et(this,n)}}rr.PDF417_GF=new rr(ee.NUMBER_OF_CODEWORDS,3);class Er{constructor(){this.field=rr.PDF417_GF}decode(e,t,n){let r=new et(this.field,e),i=new Int32Array(t),s=!1;for(let b=t;b>0;b--){let I=r.evaluateAt(this.field.exp(b));i[t-b]=I,I!==0&&(s=!0)}if(!s)return 0;let a=this.field.getOne();if(n!=null)for(const b of n){let I=this.field.exp(e.length-1-b),S=new et(this.field,new Int32Array([this.field.subtract(0,I),1]));a=a.multiply(S)}let o=new et(this.field,i),l=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),o,t),c=l[0],f=l[1],d=this.findErrorLocations(c),A=this.findErrorMagnitudes(f,c,d);for(let b=0;b<d.length;b++){let I=e.length-1-this.field.log(d[b]);if(I<0)throw re.getChecksumInstance();e[I]=this.field.subtract(e[I],A[b])}return d.length}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){let d=e;e=t,t=d}let r=e,i=t,s=this.field.getZero(),a=this.field.getOne();for(;i.getDegree()>=Math.round(n/2);){let d=r,A=s;if(r=i,s=a,r.isZero())throw re.getChecksumInstance();i=d;let b=this.field.getZero(),I=r.getCoefficient(r.getDegree()),S=this.field.inverse(I);for(;i.getDegree()>=r.getDegree()&&!i.isZero();){let _=i.getDegree()-r.getDegree(),F=this.field.multiply(i.getCoefficient(i.getDegree()),S);b=b.add(this.field.buildMonomial(_,F)),i=i.subtract(r.multiplyByMonomial(_,F))}a=b.multiply(s).subtract(A).negative()}let o=a.getCoefficient(0);if(o===0)throw re.getChecksumInstance();let l=this.field.inverse(o),c=a.multiply(l),f=i.multiply(l);return[c,f]}findErrorLocations(e){let t=e.getDegree(),n=new Int32Array(t),r=0;for(let i=1;i<this.field.getSize()&&r<t;i++)e.evaluateAt(i)===0&&(n[r]=this.field.inverse(i),r++);if(r!==t)throw re.getChecksumInstance();return n}findErrorMagnitudes(e,t,n){let r=t.getDegree(),i=new Int32Array(r);for(let l=1;l<=r;l++)i[r-l]=this.field.multiply(l,t.getCoefficient(l));let s=new et(this.field,i),a=n.length,o=new Int32Array(a);for(let l=0;l<a;l++){let c=this.field.inverse(n[l]),f=this.field.subtract(0,e.evaluateAt(c)),d=this.field.inverse(s.evaluateAt(c));o[l]=this.field.multiply(f,d)}return o}}class $t{constructor(e,t,n,r,i){e instanceof $t?this.constructor_2(e):this.constructor_1(e,t,n,r,i)}constructor_1(e,t,n,r,i){const s=t==null||n==null,a=r==null||i==null;if(s&&a)throw new O;s?(t=new Y(0,r.getY()),n=new Y(0,i.getY())):a&&(r=new Y(e.getWidth()-1,t.getY()),i=new Y(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=r,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(r.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),r.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return e==null?t:t==null?e:new $t(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,n){let r=this.topLeft,i=this.bottomLeft,s=this.topRight,a=this.bottomRight;if(e>0){let o=n?this.topLeft:this.topRight,l=Math.trunc(o.getY()-e);l<0&&(l=0);let c=new Y(o.getX(),l);n?r=c:s=c}if(t>0){let o=n?this.bottomLeft:this.bottomRight,l=Math.trunc(o.getY()+t);l>=this.image.getHeight()&&(l=this.image.getHeight()-1);let c=new Y(o.getX(),l);n?i=c:a=c}return new $t(this.image,r,i,s,a)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class oi{constructor(e,t,n,r){this.columnCount=e,this.errorCorrectionLevel=r,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class pn{constructor(){this.buffer=""}static form(e,t){let n=-1;function r(s,a,o,l,c,f){if(s==="%%")return"%";if(t[++n]===void 0)return;s=l?parseInt(l.substr(1)):void 0;let d=c?parseInt(c.substr(1)):void 0,A;switch(f){case"s":A=t[n];break;case"c":A=t[n][0];break;case"f":A=parseFloat(t[n]).toFixed(s);break;case"p":A=parseFloat(t[n]).toPrecision(s);break;case"e":A=parseFloat(t[n]).toExponential(s);break;case"x":A=parseInt(t[n]).toString(d||16);break;case"d":A=parseFloat(parseInt(t[n],d||10).toPrecision(s)).toFixed(0);break}A=typeof A=="object"?JSON.stringify(A):(+A).toString(d);let b=parseInt(o),I=o&&o[0]+""=="0"?"0":" ";for(;A.length<b;)A=a!==void 0?A+I:I+A;return A}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}format(e,...t){this.buffer+=pn.form(e,t)}toString(){return this.buffer}}class bn{constructor(e){this.boundingBox=new $t(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(t!=null)return t;for(let n=1;n<bn.MAX_NEARBY_DISTANCE;n++){let r=this.imageRowToCodewordIndex(e)-n;if(r>=0&&(t=this.codewords[r],t!=null)||(r=this.imageRowToCodewordIndex(e)+n,r<this.codewords.length&&(t=this.codewords[r],t!=null)))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new pn;let t=0;for(const n of this.codewords){if(n==null){e.format("%3d:    |   %n",t++);continue}e.format("%3d: %3d|%3d%n",t++,n.getRowNumber(),n.getValue())}return e.toString()}}bn.MAX_NEARBY_DISTANCE=5;class In{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[n,r]of this.values.entries()){const i={getKey:()=>n,getValue:()=>r};i.getValue()>e?(e=i.getValue(),t=[],t.push(i.getKey())):i.getValue()===e&&t.push(i.getKey())}return ee.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class pr extends bn{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())e!=null&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(r.getY())),a=this.imageRowToCodewordIndex(Math.trunc(i.getY())),o=-1,l=1,c=0;for(let f=s;f<a;f++){if(t[f]==null)continue;let d=t[f],A=d.getRowNumber()-o;if(A===0)c++;else if(A===1)l=Math.max(l,c),c=1,o=d.getRowNumber();else if(A<0||d.getRowNumber()>=e.getRowCount()||A>f)t[f]=null;else{let b;l>2?b=(l-2)*A:b=A;let I=b>=f;for(let S=1;S<=b&&!I;S++)I=t[f-S]!=null;I?t[f]=null:(o=d.getRowNumber(),c=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let n of this.getCodewords())if(n!=null){let r=n.getRowNumber();if(r>=t.length)continue;t[r]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),n=this._isLeft?t.getTopLeft():t.getTopRight(),r=this._isLeft?t.getBottomLeft():t.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.imageRowToCodewordIndex(Math.trunc(r.getY())),a=this.getCodewords(),o=-1;for(let l=i;l<s;l++){if(a[l]==null)continue;let c=a[l];c.setRowNumberAsRowIndicatorColumn();let f=c.getRowNumber()-o;f===0||(f===1?o=c.getRowNumber():c.getRowNumber()>=e.getRowCount()?a[l]=null:o=c.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new In,n=new In,r=new In,i=new In;for(let a of e){if(a==null)continue;a.setRowNumberAsRowIndicatorColumn();let o=a.getValue()%30,l=a.getRowNumber();switch(this._isLeft||(l+=2),l%3){case 0:n.setValue(o*3+1);break;case 1:i.setValue(o/3),r.setValue(o%3);break;case 2:t.setValue(o+1);break}}if(t.getValue().length===0||n.getValue().length===0||r.getValue().length===0||i.getValue().length===0||t.getValue()[0]<1||n.getValue()[0]+r.getValue()[0]<ee.MIN_ROWS_IN_BARCODE||n.getValue()[0]+r.getValue()[0]>ee.MAX_ROWS_IN_BARCODE)return null;let s=new oi(t.getValue()[0],n.getValue()[0],r.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(e,s),s}removeIncorrectCodewords(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(e[n]==null)continue;let i=r.getValue()%30,s=r.getRowNumber();if(s>t.getRowCount()){e[n]=null;continue}switch(this._isLeft||(s+=2),s%3){case 0:i*3+1!==t.getRowCountUpperPart()&&(e[n]=null);break;case 1:(Math.trunc(i/3)!==t.getErrorCorrectionLevel()||i%3!==t.getRowCountLowerPart())&&(e[n]=null);break;case 2:i+1!==t.getColumnCount()&&(e[n]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class yn{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=ee.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let n=this.detectionResultColumns[t].getCodewords();for(let r=0;r<n.length;r++)n[r]!=null&&(n[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,n))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<e.length;n++)if(e[n]!=null&&t[n]!=null&&e[n].getRowNumber()===t[n].getRowNumber())for(let r=1;r<=this.barcodeColumnCount;r++){let i=this.detectionResultColumns[r].getCodewords()[n];i!=null&&(i.setRowNumber(e[n].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[r].getCodewords()[n]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let s=this.barcodeColumnCount+1;s>0&&i<this.ADJUST_ROW_NUMBER_SKIP;s--){let a=this.detectionResultColumns[s].getCodewords()[n];a!=null&&(i=yn.adjustRowNumberIfValid(r,i,a),a.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let s=1;s<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;s++){let a=this.detectionResultColumns[s].getCodewords()[n];a!=null&&(i=yn.adjustRowNumberIfValid(r,i,a),a.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,n){if(!this.detectionResultColumns[e-1])return;let r=n[t],i=this.detectionResultColumns[e-1].getCodewords(),s=i;this.detectionResultColumns[e+1]!=null&&(s=this.detectionResultColumns[e+1].getCodewords());let a=new Array(14);a[2]=i[t],a[3]=s[t],t>0&&(a[0]=n[t-1],a[4]=i[t-1],a[5]=s[t-1]),t>1&&(a[8]=n[t-2],a[10]=i[t-2],a[11]=s[t-2]),t<n.length-1&&(a[1]=n[t+1],a[6]=i[t+1],a[7]=s[t+1]),t<n.length-2&&(a[9]=n[t+2],a[12]=i[t+2],a[13]=s[t+2]);for(let o of a)if(yn.adjustRowNumber(r,o))return}static adjustRowNumber(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new pn;for(let n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(let r=0;r<this.barcodeColumnCount+2;r++){if(this.detectionResultColumns[r]==null){t.format("    |   ");continue}let i=this.detectionResultColumns[r].getCodewords()[n];if(i==null){t.format("    |   ");continue}t.format(" %3d|%3d",i.getRowNumber(),i.getValue())}t.format("%n")}return t.toString()}}class Sn{constructor(e,t,n,r){this.rowNumber=Sn.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(r)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==Sn.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}Sn.BARCODE_ROW_UNKNOWN=-1;class ft{static initialize(){for(let e=0;e<ee.SYMBOL_TABLE.length;e++){let t=ee.SYMBOL_TABLE[e],n=t&1;for(let r=0;r<ee.BARS_IN_MODULE;r++){let i=0;for(;(t&1)===n;)i+=1,t>>=1;n=t&1,ft.RATIOS_TABLE[e]||(ft.RATIOS_TABLE[e]=new Array(ee.BARS_IN_MODULE)),ft.RATIOS_TABLE[e][ee.BARS_IN_MODULE-r-1]=Math.fround(i/ee.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=ft.getDecodedCodewordValue(ft.sampleBitCounts(e));return t!==-1?t:ft.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=Z.sum(e),n=new Int32Array(ee.BARS_IN_MODULE),r=0,i=0;for(let s=0;s<ee.MODULES_IN_CODEWORD;s++){let a=t/(2*ee.MODULES_IN_CODEWORD)+s*t/ee.MODULES_IN_CODEWORD;i+e[r]<=a&&(i+=e[r],r++),n[r]++}return n}static getDecodedCodewordValue(e){let t=ft.getBitValue(e);return ee.getCodeword(t)===-1?-1:t}static getBitValue(e){let t=0;for(let n=0;n<e.length;n++)for(let r=0;r<e[n];r++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=Z.sum(e),n=new Array(ee.BARS_IN_MODULE);if(t>1)for(let s=0;s<n.length;s++)n[s]=Math.fround(e[s]/t);let r=sn.MAX_VALUE,i=-1;this.bSymbolTableReady||ft.initialize();for(let s=0;s<ft.RATIOS_TABLE.length;s++){let a=0,o=ft.RATIOS_TABLE[s];for(let l=0;l<ee.BARS_IN_MODULE;l++){let c=Math.fround(o[l]-n[l]);if(a+=Math.fround(c*c),a>=r)break}a<r&&(r=a,i=ee.SYMBOL_TABLE[s])}return i}}ft.bSymbolTableReady=!1,ft.RATIOS_TABLE=new Array(ee.SYMBOL_TABLE.length).map(h=>new Array(ee.BARS_IN_MODULE));class br{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Ir{static parseLong(e,t=void 0){return parseInt(e,t)}}class yr extends C{}yr.kind="NullPointerException";class li{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,n){if(e==null)throw new yr;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new lt;if(n===0)return;for(let r=0;r<n;r++)this.write(e[t+r])}flush(){}close(){}}class ci extends C{}class ui extends li{constructor(e=32){if(super(),this.count=0,e<0)throw new D("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let n=this.buf.length<<1;if(n-e<0&&(n=e),n<0){if(e<0)throw new ci;n=$.MAX_VALUE}this.buf=pe.copyOfUint8Array(this.buf,n)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,n){if(t<0||t>e.length||n<0||t+n-e.length>0)throw new lt;this.ensureCapacity(this.count+n),ne.arraycopy(e,t,this.buf,this.count,n),this.count+=n}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return pe.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var be;(function(h){h[h.ALPHA=0]="ALPHA",h[h.LOWER=1]="LOWER",h[h.MIXED=2]="MIXED",h[h.PUNCT=3]="PUNCT",h[h.ALPHA_SHIFT=4]="ALPHA_SHIFT",h[h.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(be||(be={}));function Sr(){if(typeof window<"u")return window.BigInt||null;if(typeof Gn<"u")return Gn.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ln;function Yt(h){if(typeof Ln>"u"&&(Ln=Sr()),Ln===null)throw new Error("BigInt is not supported!");return Ln(h)}function hi(){let h=[];h[0]=Yt(1);let e=Yt(900);h[1]=e;for(let t=2;t<16;t++)h[t]=h[t-1]*e;return h}class T{static decode(e,t){let n=new de(""),r=U.ISO8859_1;n.enableDecoding(r);let i=1,s=e[i++],a=new br;for(;i<e[0];){switch(s){case T.TEXT_COMPACTION_MODE_LATCH:i=T.textCompaction(e,i,n);break;case T.BYTE_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH_6:i=T.byteCompaction(s,e,r,i,n);break;case T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[i++]);break;case T.NUMERIC_COMPACTION_MODE_LATCH:i=T.numericCompaction(e,i,n);break;case T.ECI_CHARSET:U.getCharacterSetECIByValue(e[i++]);break;case T.ECI_GENERAL_PURPOSE:i+=2;break;case T.ECI_USER_DEFINED:i++;break;case T.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=T.decodeMacroBlock(e,i,a);break;case T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case T.MACRO_PDF417_TERMINATOR:throw new G;default:i--,i=T.textCompaction(e,i,n);break}if(i<e.length)s=e[i++];else throw G.getFormatInstance()}if(n.length()===0)throw G.getFormatInstance();let o=new Vt(null,n.toString(),null,t);return o.setOther(a),o}static decodeMacroBlock(e,t,n){if(t+T.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw G.getFormatInstance();let r=new Int32Array(T.NUMBER_OF_SEQUENCE_CODEWORDS);for(let a=0;a<T.NUMBER_OF_SEQUENCE_CODEWORDS;a++,t++)r[a]=e[t];n.setSegmentIndex($.parseInt(T.decodeBase900toBase10(r,T.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new de;t=T.textCompaction(e,t,i),n.setFileId(i.toString());let s=-1;for(e[t]===T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=t+1);t<e[0];)switch(e[t]){case T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case T.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let a=new de;t=T.textCompaction(e,t+1,a),n.setFileName(a.toString());break;case T.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let o=new de;t=T.textCompaction(e,t+1,o),n.setSender(o.toString());break;case T.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let l=new de;t=T.textCompaction(e,t+1,l),n.setAddressee(l.toString());break;case T.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let c=new de;t=T.numericCompaction(e,t+1,c),n.setSegmentCount($.parseInt(c.toString()));break;case T.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let f=new de;t=T.numericCompaction(e,t+1,f),n.setTimestamp(Ir.parseLong(f.toString()));break;case T.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let d=new de;t=T.numericCompaction(e,t+1,d),n.setChecksum($.parseInt(d.toString()));break;case T.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let A=new de;t=T.numericCompaction(e,t+1,A),n.setFileSize(Ir.parseLong(A.toString()));break;default:throw G.getFormatInstance()}break;case T.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw G.getFormatInstance()}if(s!==-1){let a=t-s;n.isLastSegment()&&a--,n.setOptionalData(pe.copyOfRange(e,s,s+a))}return t}static textCompaction(e,t,n){let r=new Int32Array((e[0]-t)*2),i=new Int32Array((e[0]-t)*2),s=0,a=!1;for(;t<e[0]&&!a;){let o=e[t++];if(o<T.TEXT_COMPACTION_MODE_LATCH)r[s]=o/30,r[s+1]=o%30,s+=2;else switch(o){case T.TEXT_COMPACTION_MODE_LATCH:r[s++]=T.TEXT_COMPACTION_MODE_LATCH;break;case T.BYTE_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH_6:case T.NUMERIC_COMPACTION_MODE_LATCH:case T.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case T.MACRO_PDF417_TERMINATOR:t--,a=!0;break;case T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[s]=T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,o=e[t++],i[s]=o,s++;break}}return T.decodeTextCompaction(r,i,s,n),t}static decodeTextCompaction(e,t,n,r){let i=be.ALPHA,s=be.ALPHA,a=0;for(;a<n;){let o=e[a],l="";switch(i){case be.ALPHA:if(o<26)l=String.fromCharCode(65+o);else switch(o){case 26:l=" ";break;case T.LL:i=be.LOWER;break;case T.ML:i=be.MIXED;break;case T.PS:s=i,i=be.PUNCT_SHIFT;break;case T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[a]);break;case T.TEXT_COMPACTION_MODE_LATCH:i=be.ALPHA;break}break;case be.LOWER:if(o<26)l=String.fromCharCode(97+o);else switch(o){case 26:l=" ";break;case T.AS:s=i,i=be.ALPHA_SHIFT;break;case T.ML:i=be.MIXED;break;case T.PS:s=i,i=be.PUNCT_SHIFT;break;case T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[a]);break;case T.TEXT_COMPACTION_MODE_LATCH:i=be.ALPHA;break}break;case be.MIXED:if(o<T.PL)l=T.MIXED_CHARS[o];else switch(o){case T.PL:i=be.PUNCT;break;case 26:l=" ";break;case T.LL:i=be.LOWER;break;case T.AL:i=be.ALPHA;break;case T.PS:s=i,i=be.PUNCT_SHIFT;break;case T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[a]);break;case T.TEXT_COMPACTION_MODE_LATCH:i=be.ALPHA;break}break;case be.PUNCT:if(o<T.PAL)l=T.PUNCT_CHARS[o];else switch(o){case T.PAL:i=be.ALPHA;break;case T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[a]);break;case T.TEXT_COMPACTION_MODE_LATCH:i=be.ALPHA;break}break;case be.ALPHA_SHIFT:if(i=s,o<26)l=String.fromCharCode(65+o);else switch(o){case 26:l=" ";break;case T.TEXT_COMPACTION_MODE_LATCH:i=be.ALPHA;break}break;case be.PUNCT_SHIFT:if(i=s,o<T.PAL)l=T.PUNCT_CHARS[o];else switch(o){case T.PAL:i=be.ALPHA;break;case T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[a]);break;case T.TEXT_COMPACTION_MODE_LATCH:i=be.ALPHA;break}break}l!==""&&r.append(l),a++}}static byteCompaction(e,t,n,r,i){let s=new ui,a=0,o=0,l=!1;switch(e){case T.BYTE_COMPACTION_MODE_LATCH:let c=new Int32Array(6),f=t[r++];for(;r<t[0]&&!l;)switch(c[a++]=f,o=900*o+f,f=t[r++],f){case T.TEXT_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH:case T.NUMERIC_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH_6:case T.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case T.MACRO_PDF417_TERMINATOR:r--,l=!0;break;default:if(a%5===0&&a>0){for(let d=0;d<6;++d)s.write(Number(Yt(o)>>Yt(8*(5-d))));o=0,a=0}break}r===t[0]&&f<T.TEXT_COMPACTION_MODE_LATCH&&(c[a++]=f);for(let d=0;d<a;d++)s.write(c[d]);break;case T.BYTE_COMPACTION_MODE_LATCH_6:for(;r<t[0]&&!l;){let d=t[r++];if(d<T.TEXT_COMPACTION_MODE_LATCH)a++,o=900*o+d;else switch(d){case T.TEXT_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH:case T.NUMERIC_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH_6:case T.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case T.MACRO_PDF417_TERMINATOR:r--,l=!0;break}if(a%5===0&&a>0){for(let A=0;A<6;++A)s.write(Number(Yt(o)>>Yt(8*(5-A))));o=0,a=0}}break}return i.append(We.decode(s.toByteArray(),n)),r}static numericCompaction(e,t,n){let r=0,i=!1,s=new Int32Array(T.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!i;){let a=e[t++];if(t===e[0]&&(i=!0),a<T.TEXT_COMPACTION_MODE_LATCH)s[r]=a,r++;else switch(a){case T.TEXT_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH:case T.BYTE_COMPACTION_MODE_LATCH_6:case T.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case T.MACRO_PDF417_TERMINATOR:t--,i=!0;break}(r%T.MAX_NUMERIC_CODEWORDS===0||a===T.NUMERIC_COMPACTION_MODE_LATCH||i)&&r>0&&(n.append(T.decodeBase900toBase10(s,r)),r=0)}return t}static decodeBase900toBase10(e,t){let n=Yt(0);for(let i=0;i<t;i++)n+=T.EXP900[t-i-1]*Yt(e[i]);let r=n.toString();if(r.charAt(0)!=="1")throw new G;return r.substring(1)}}T.TEXT_COMPACTION_MODE_LATCH=900,T.BYTE_COMPACTION_MODE_LATCH=901,T.NUMERIC_COMPACTION_MODE_LATCH=902,T.BYTE_COMPACTION_MODE_LATCH_6=924,T.ECI_USER_DEFINED=925,T.ECI_GENERAL_PURPOSE=926,T.ECI_CHARSET=927,T.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,T.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,T.MACRO_PDF417_TERMINATOR=922,T.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,T.MAX_NUMERIC_CODEWORDS=15,T.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,T.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,T.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,T.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,T.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,T.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,T.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,T.PL=25,T.LL=27,T.AS=27,T.ML=28,T.AL=28,T.PS=29,T.PAL=29,T.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,T.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",T.EXP900=Sr()?hi():[],T.NUMBER_OF_SEQUENCE_CODEWORDS=2;class ae{constructor(){}static decode(e,t,n,r,i,s,a){let o=new $t(e,t,n,r,i),l=null,c=null,f;for(let b=!0;;b=!1){if(t!=null&&(l=ae.getRowIndicatorColumn(e,o,t,!0,s,a)),r!=null&&(c=ae.getRowIndicatorColumn(e,o,r,!1,s,a)),f=ae.merge(l,c),f==null)throw O.getNotFoundInstance();let I=f.getBoundingBox();if(b&&I!=null&&(I.getMinY()<o.getMinY()||I.getMaxY()>o.getMaxY()))o=I;else break}f.setBoundingBox(o);let d=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,l),f.setDetectionResultColumn(d,c);let A=l!=null;for(let b=1;b<=d;b++){let I=A?b:d-b;if(f.getDetectionResultColumn(I)!==void 0)continue;let S;I===0||I===d?S=new pr(o,I===0):S=new bn(o),f.setDetectionResultColumn(I,S);let _=-1,F=_;for(let k=o.getMinY();k<=o.getMaxY();k++){if(_=ae.getStartColumn(f,I,k,A),_<0||_>o.getMaxX()){if(F===-1)continue;_=F}let P=ae.detectCodeword(e,o.getMinX(),o.getMaxX(),A,_,k,s,a);P!=null&&(S.setCodeword(k,P),F=_,s=Math.min(s,P.getWidth()),a=Math.max(a,P.getWidth()))}}return ae.createDecoderResult(f)}static merge(e,t){if(e==null&&t==null)return null;let n=ae.getBarcodeMetadata(e,t);if(n==null)return null;let r=$t.merge(ae.adjustBoundingBox(e),ae.adjustBoundingBox(t));return new yn(n,r)}static adjustBoundingBox(e){if(e==null)return null;let t=e.getRowHeights();if(t==null)return null;let n=ae.getMax(t),r=0;for(let a of t)if(r+=n-a,a>0)break;let i=e.getCodewords();for(let a=0;r>0&&i[a]==null;a++)r--;let s=0;for(let a=t.length-1;a>=0&&(s+=n-t[a],!(t[a]>0));a--);for(let a=i.length-1;s>0&&i[a]==null;a--)s--;return e.getBoundingBox().addMissingRows(r,s,e.isLeft())}static getMax(e){let t=-1;for(let n of e)t=Math.max(t,n);return t}static getBarcodeMetadata(e,t){let n;if(e==null||(n=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();let r;return t==null||(r=t.getBarcodeMetadata())==null?n:n.getColumnCount()!==r.getColumnCount()&&n.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&n.getRowCount()!==r.getRowCount()?null:n}static getRowIndicatorColumn(e,t,n,r,i,s){let a=new pr(t,r);for(let o=0;o<2;o++){let l=o===0?1:-1,c=Math.trunc(Math.trunc(n.getX()));for(let f=Math.trunc(Math.trunc(n.getY()));f<=t.getMaxY()&&f>=t.getMinY();f+=l){let d=ae.detectCodeword(e,0,e.getWidth(),r,c,f,i,s);d!=null&&(a.setCodeword(f,d),r?c=d.getStartX():c=d.getEndX())}}return a}static adjustCodewordCount(e,t){let n=t[0][1],r=n.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-ae.getNumberOfECCodeWords(e.getBarcodeECLevel());if(r.length===0){if(i<1||i>ee.MAX_CODEWORDS_IN_BARCODE)throw O.getNotFoundInstance();n.setValue(i)}else r[0]!==i&&n.setValue(i)}static createDecoderResult(e){let t=ae.createBarcodeMatrix(e);ae.adjustCodewordCount(e,t);let n=new Array,r=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],s=new Array;for(let o=0;o<e.getBarcodeRowCount();o++)for(let l=0;l<e.getBarcodeColumnCount();l++){let c=t[o][l+1].getValue(),f=o*e.getBarcodeColumnCount()+l;c.length===0?n.push(f):c.length===1?r[f]=c[0]:(s.push(f),i.push(c))}let a=new Array(i.length);for(let o=0;o<a.length;o++)a[o]=i[o];return ae.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),r,ee.toIntArray(n),ee.toIntArray(s),a)}static createDecoderResultFromAmbiguousValues(e,t,n,r,i){let s=new Int32Array(r.length),a=100;for(;a-- >0;){for(let o=0;o<s.length;o++)t[r[o]]=i[o][s[o]];try{return ae.decodeCodewords(t,e,n)}catch(o){if(!(o instanceof re))throw o}if(s.length===0)throw re.getChecksumInstance();for(let o=0;o<s.length;o++)if(s[o]<i[o].length-1){s[o]++;break}else if(s[o]=0,o===s.length-1)throw re.getChecksumInstance()}throw re.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++)t[r][i]=new In;let n=0;for(let r of e.getDetectionResultColumns()){if(r!=null){for(let i of r.getCodewords())if(i!=null){let s=i.getRowNumber();if(s>=0){if(s>=t.length)continue;t[s][n].setValue(i.getValue())}}}n++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,n,r){let i=r?1:-1,s=null;if(ae.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodeword(n)),s!=null)return r?s.getEndX():s.getStartX();if(s=e.getDetectionResultColumn(t).getCodewordNearby(n),s!=null)return r?s.getStartX():s.getEndX();if(ae.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodewordNearby(n)),s!=null)return r?s.getEndX():s.getStartX();let a=0;for(;ae.isValidBarcodeColumn(e,t-i);){t-=i;for(let o of e.getDetectionResultColumn(t).getCodewords())if(o!=null)return(r?o.getEndX():o.getStartX())+i*a*(o.getEndX()-o.getStartX());a++}return r?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,n,r,i,s,a,o){i=ae.adjustCodewordStartColumn(e,t,n,r,i,s);let l=ae.getModuleBitCount(e,t,n,r,i,s);if(l==null)return null;let c,f=Z.sum(l);if(r)c=i+f;else{for(let b=0;b<l.length/2;b++){let I=l[b];l[b]=l[l.length-1-b],l[l.length-1-b]=I}c=i,i=c-f}if(!ae.checkCodewordSkew(f,a,o))return null;let d=ft.getDecodedValue(l),A=ee.getCodeword(d);return A===-1?null:new Sn(i,c,ae.getCodewordBucketNumber(d),A)}static getModuleBitCount(e,t,n,r,i,s){let a=i,o=new Int32Array(8),l=0,c=r?1:-1,f=r;for(;(r?a<n:a>=t)&&l<o.length;)e.get(a,s)===f?(o[l]++,a+=c):(l++,f=!f);return l===o.length||a===(r?n:t)&&l===o.length-1?o:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,n,r,i,s){let a=i,o=r?-1:1;for(let l=0;l<2;l++){for(;(r?a>=t:a<n)&&r===e.get(a,s);){if(Math.abs(i-a)>ae.CODEWORD_SKEW_SIZE)return i;a+=o}o=-o,r=!r}return a}static checkCodewordSkew(e,t,n){return t-ae.CODEWORD_SKEW_SIZE<=e&&e<=n+ae.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,n){if(e.length===0)throw G.getFormatInstance();let r=1<<t+1,i=ae.correctErrors(e,n,r);ae.verifyCodewordCount(e,r);let s=T.decode(e,""+t);return s.setErrorsCorrected(i),s.setErasures(n.length),s}static correctErrors(e,t,n){if(t!=null&&t.length>n/2+ae.MAX_ERRORS||n<0||n>ae.MAX_EC_CODEWORDS)throw re.getChecksumInstance();return ae.errorCorrection.decode(e,n,t)}static verifyCodewordCount(e,t){if(e.length<4)throw G.getFormatInstance();let n=e[0];if(n>e.length)throw G.getFormatInstance();if(n===0)if(t<e.length)e[0]=e.length-t;else throw G.getFormatInstance()}static getBitCountForCodeword(e){let t=new Int32Array(8),n=0,r=t.length-1;for(;!((e&1)!==n&&(n=e&1,r--,r<0));)t[r]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return ae.getCodewordBucketNumber(ae.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new pn;for(let n=0;n<e.length;n++){t.format("Row %2d: ",n);for(let r=0;r<e[n].length;r++){let i=e[n][r];i.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()}}ae.CODEWORD_SKEW_SIZE=2,ae.MAX_ERRORS=3,ae.MAX_EC_CODEWORDS=512,ae.errorCorrection=new Er;class tt{decode(e,t=null){let n=tt.decode(e,t,!1);if(n==null||n.length===0||n[0]==null)throw O.getNotFoundInstance();return n[0]}decodeMultiple(e,t=null){try{return tt.decode(e,t,!0)}catch(n){throw n instanceof G||n instanceof re?O.getNotFoundInstance():n}}static decode(e,t,n){const r=new Array,i=se.detectMultiple(e,t,n);for(const s of i.getPoints()){const a=ae.decode(i.getBits(),s[4],s[5],s[6],s[7],tt.getMinCodewordWidth(s),tt.getMaxCodewordWidth(s)),o=new Le(a.getText(),a.getRawBytes(),void 0,s,z.PDF_417);o.putMetadata(Xe.ERROR_CORRECTION_LEVEL,a.getECLevel());const l=a.getOther();l!=null&&o.putMetadata(Xe.PDF417_EXTRA_METADATA,l),r.push(o)}return r.map(s=>s)}static getMaxWidth(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return e==null||t==null?$.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(tt.getMaxWidth(e[0],e[4]),tt.getMaxWidth(e[6],e[2])*ee.MODULES_IN_CODEWORD/ee.MODULES_IN_STOP_PATTERN),Math.max(tt.getMaxWidth(e[1],e[5]),tt.getMaxWidth(e[7],e[3])*ee.MODULES_IN_CODEWORD/ee.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(tt.getMinWidth(e[0],e[4]),tt.getMinWidth(e[6],e[2])*ee.MODULES_IN_CODEWORD/ee.MODULES_IN_STOP_PATTERN),Math.min(tt.getMinWidth(e[1],e[5]),tt.getMinWidth(e[7],e[3])*ee.MODULES_IN_CODEWORD/ee.MODULES_IN_STOP_PATTERN)))}reset(){}}class Fn extends C{}Fn.kind="ReaderException";class Nr{constructor(e,t){this.verbose=e===!0,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=!E(e)&&e.get(le.TRY_HARDER)===!0,n=E(e)?null:e.get(le.POSSIBLE_FORMATS),r=new Array;if(!E(n)){const i=n.some(s=>s===z.UPC_A||s===z.UPC_E||s===z.EAN_13||s===z.EAN_8||s===z.CODABAR||s===z.CODE_39||s===z.CODE_93||s===z.CODE_128||s===z.ITF||s===z.RSS_14||s===z.RSS_EXPANDED);i&&!t&&r.push(new cn(e,this.verbose)),n.includes(z.QR_CODE)&&r.push(new jt),n.includes(z.DATA_MATRIX)&&r.push(new Xt),n.includes(z.AZTEC)&&r.push(new Ie),n.includes(z.PDF_417)&&r.push(new tt),i&&t&&r.push(new cn(e,this.verbose))}r.length===0&&(t||r.push(new cn(e,this.verbose)),r.push(new jt),r.push(new Xt),r.push(new Ie),r.push(new tt),t&&r.push(new cn(e,this.verbose))),this.readers=r}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new Fn("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(n){if(n instanceof Fn)continue}throw new O("No MultiFormat Readers were able to detect the code.")}}class fi extends Ft{constructor(e=null,t=500){const n=new Nr;n.setHints(e),super(n,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class di extends Ft{constructor(e=500){super(new tt,e)}}class xi extends Ft{constructor(e=500){super(new jt,e)}}var ir;(function(h){h[h.ERROR_CORRECTION=0]="ERROR_CORRECTION",h[h.CHARACTER_SET=1]="CHARACTER_SET",h[h.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",h[h.MIN_SIZE=3]="MIN_SIZE",h[h.MAX_SIZE=4]="MAX_SIZE",h[h.MARGIN=5]="MARGIN",h[h.PDF417_COMPACT=6]="PDF417_COMPACT",h[h.PDF417_COMPACTION=7]="PDF417_COMPACTION",h[h.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",h[h.AZTEC_LAYERS=9]="AZTEC_LAYERS",h[h.QR_VERSION=10]="QR_VERSION"})(ir||(ir={}));var ze=ir;class sr{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new Fe(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let n=t[t.length-1];const r=this.field;for(let i=t.length;i<=e;i++){const s=n.multiply(new Fe(r,Int32Array.from([1,r.exp(i-1+r.getGeneratorBase())])));t.push(s),n=s}}return t[e]}encode(e,t){if(t===0)throw new D("No error correction bytes");const n=e.length-t;if(n<=0)throw new D("No data bytes provided");const r=this.buildGenerator(t),i=new Int32Array(n);ne.arraycopy(e,0,i,0,n);let s=new Fe(this.field,i);s=s.multiplyByMonomial(t,1);const o=s.divide(r)[1].getCoefficients(),l=t-o.length;for(let c=0;c<l;c++)e[n+c]=0;ne.arraycopy(o,0,e,n+l,o.length)}}class Ge{constructor(){}static applyMaskPenaltyRule1(e){return Ge.applyMaskPenaltyRule1Internal(e,!0)+Ge.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let s=0;s<i-1;s++){const a=n[s];for(let o=0;o<r-1;o++){const l=a[o];l===a[o+1]&&l===n[s+1][o]&&l===n[s+1][o+1]&&t++}}return Ge.N2*t}static applyMaskPenaltyRule3(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let s=0;s<i;s++)for(let a=0;a<r;a++){const o=n[s];a+6<r&&o[a]===1&&o[a+1]===0&&o[a+2]===1&&o[a+3]===1&&o[a+4]===1&&o[a+5]===0&&o[a+6]===1&&(Ge.isWhiteHorizontal(o,a-4,a)||Ge.isWhiteHorizontal(o,a+7,a+11))&&t++,s+6<i&&n[s][a]===1&&n[s+1][a]===0&&n[s+2][a]===1&&n[s+3][a]===1&&n[s+4][a]===1&&n[s+5][a]===0&&n[s+6][a]===1&&(Ge.isWhiteVertical(n,a,s-4,s)||Ge.isWhiteVertical(n,a,s+7,s+11))&&t++}return t*Ge.N3}static isWhiteHorizontal(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(let r=t;r<n;r++)if(e[r]===1)return!1;return!0}static isWhiteVertical(e,t,n,r){n=Math.max(n,0),r=Math.min(r,e.length);for(let i=n;i<r;i++)if(e[i][t]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let o=0;o<i;o++){const l=n[o];for(let c=0;c<r;c++)l[c]===1&&t++}const s=e.getHeight()*e.getWidth();return Math.floor(Math.abs(t*2-s)*10/s)*Ge.N4}static getDataMaskBit(e,t,n){let r,i;switch(e){case 0:r=n+t&1;break;case 1:r=n&1;break;case 2:r=t%3;break;case 3:r=(n+t)%3;break;case 4:r=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:i=n*t,r=(i&1)+i%3;break;case 6:i=n*t,r=(i&1)+i%3&1;break;case 7:i=n*t,r=i%3+(n+t&1)&1;break;default:throw new D("Invalid mask pattern: "+e)}return r===0}static applyMaskPenaltyRule1Internal(e,t){let n=0;const r=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),s=e.getArray();for(let a=0;a<r;a++){let o=0,l=-1;for(let c=0;c<i;c++){const f=t?s[a][c]:s[c][a];f===l?o++:(o>=5&&(n+=Ge.N1+(o-5)),o=1,l=f)}o>=5&&(n+=Ge.N1+(o-5))}return n}}Ge.N1=3,Ge.N2=3,Ge.N3=40,Ge.N4=10;class kn{constructor(e,t){this.width=e,this.height=t;const n=new Array(t);for(let r=0;r!==t;r++)n[r]=new Uint8Array(e);this.bytes=n}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,n){this.bytes[t][e]=n}setBoolean(e,t,n){this.bytes[t][e]=n?1:0}clear(e){for(const t of this.bytes)pe.fill(t,e)}equals(e){if(!(e instanceof kn))return!1;const t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(let n=0,r=this.height;n<r;++n){const i=this.bytes[n],s=t.bytes[n];for(let a=0,o=this.width;a<o;++a)if(i[a]!==s[a])return!1}return!0}toString(){const e=new de;for(let t=0,n=this.height;t<n;++t){const r=this.bytes[t];for(let i=0,s=this.width;i<s;++i)switch(r[i]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class en{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new de;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<en.NUM_MASK_PATTERNS}}en.NUM_MASK_PATTERNS=8;class ye extends C{}ye.kind="WriterException";class J{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,n,r,i){J.clearMatrix(i),J.embedBasicPatterns(n,i),J.embedTypeInfo(t,r,i),J.maybeEmbedVersionInfo(n,i),J.embedDataBits(e,r,i)}static embedBasicPatterns(e,t){J.embedPositionDetectionPatternsAndSeparators(t),J.embedDarkDotAtLeftBottomCorner(t),J.maybeEmbedPositionAdjustmentPatterns(e,t),J.embedTimingPatterns(t)}static embedTypeInfo(e,t,n){const r=new oe;J.makeTypeInfoBits(e,t,r);for(let i=0,s=r.getSize();i<s;++i){const a=r.get(r.getSize()-1-i),o=J.TYPE_INFO_COORDINATES[i],l=o[0],c=o[1];if(n.setBoolean(l,c,a),i<8){const f=n.getWidth()-i-1;n.setBoolean(f,8,a)}else{const d=n.getHeight()-7+(i-8);n.setBoolean(8,d,a)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const n=new oe;J.makeVersionInfoBits(e,n);let r=6*3-1;for(let i=0;i<6;++i)for(let s=0;s<3;++s){const a=n.get(r);r--,t.setBoolean(i,t.getHeight()-11+s,a),t.setBoolean(t.getHeight()-11+s,i,a)}}static embedDataBits(e,t,n){let r=0,i=-1,s=n.getWidth()-1,a=n.getHeight()-1;for(;s>0;){for(s===6&&(s-=1);a>=0&&a<n.getHeight();){for(let o=0;o<2;++o){const l=s-o;if(!J.isEmpty(n.get(l,a)))continue;let c;r<e.getSize()?(c=e.get(r),++r):c=!1,t!==255&&Ge.getDataMaskBit(t,l,a)&&(c=!c),n.setBoolean(l,a,c)}a+=i}i=-i,a+=i,s-=2}if(r!==e.getSize())throw new ye("Not all bits consumed: "+r+"/"+e.getSize())}static findMSBSet(e){return 32-$.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(t===0)throw new D("0 polynomial");const n=J.findMSBSet(t);for(e<<=n-1;J.findMSBSet(e)>=n;)e^=t<<J.findMSBSet(e)-n;return e}static makeTypeInfoBits(e,t,n){if(!en.isValidMaskPattern(t))throw new ye("Invalid mask pattern");const r=e.getBits()<<3|t;n.appendBits(r,5);const i=J.calculateBCHCode(r,J.TYPE_INFO_POLY);n.appendBits(i,10);const s=new oe;if(s.appendBits(J.TYPE_INFO_MASK_PATTERN,15),n.xor(s),n.getSize()!==15)throw new ye("should not happen but we got: "+n.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const n=J.calculateBCHCode(e.getVersionNumber(),J.VERSION_INFO_POLY);if(t.appendBits(n,12),t.getSize()!==18)throw new ye("should not happen but we got: "+t.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const n=(t+1)%2;J.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),J.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new ye;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,n){for(let r=0;r<8;++r){if(!J.isEmpty(n.get(e+r,t)))throw new ye;n.setNumber(e+r,t,0)}}static embedVerticalSeparationPattern(e,t,n){for(let r=0;r<7;++r){if(!J.isEmpty(n.get(e,t+r)))throw new ye;n.setNumber(e,t+r,0)}}static embedPositionAdjustmentPattern(e,t,n){for(let r=0;r<5;++r){const i=J.POSITION_ADJUSTMENT_PATTERN[r];for(let s=0;s<5;++s)n.setNumber(e+s,t+r,i[s])}}static embedPositionDetectionPattern(e,t,n){for(let r=0;r<7;++r){const i=J.POSITION_DETECTION_PATTERN[r];for(let s=0;s<7;++s)n.setNumber(e+s,t+r,i[s])}}static embedPositionDetectionPatternsAndSeparators(e){const t=J.POSITION_DETECTION_PATTERN[0].length;J.embedPositionDetectionPattern(0,0,e),J.embedPositionDetectionPattern(e.getWidth()-t,0,e),J.embedPositionDetectionPattern(0,e.getWidth()-t,e);const n=8;J.embedHorizontalSeparationPattern(0,n-1,e),J.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),J.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);const r=7;J.embedVerticalSeparationPattern(r,0,e),J.embedVerticalSeparationPattern(e.getHeight()-r-1,0,e),J.embedVerticalSeparationPattern(r,e.getHeight()-r,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const n=e.getVersionNumber()-1,r=J.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n];for(let i=0,s=r.length;i!==s;i++){const a=r[i];if(a>=0)for(let o=0;o!==s;o++){const l=r[o];l>=0&&J.isEmpty(t.get(l,a))&&J.embedPositionAdjustmentPattern(l-2,a-2,t)}}}}J.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),J.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),J.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),J.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),J.VERSION_INFO_POLY=7973,J.TYPE_INFO_POLY=1335,J.TYPE_INFO_MASK_PATTERN=21522;class gi{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Oe{constructor(){}static calculateMaskPenalty(e){return Ge.applyMaskPenaltyRule1(e)+Ge.applyMaskPenaltyRule2(e)+Ge.applyMaskPenaltyRule3(e)+Ge.applyMaskPenaltyRule4(e)}static encode(e,t,n=null){let r=Oe.DEFAULT_BYTE_MODE_ENCODING;const i=n!==null&&n.get(ze.CHARACTER_SET)!==void 0;i&&(r=n.get(ze.CHARACTER_SET).toString());const s=this.chooseMode(e,r),a=new oe;if(s===q.BYTE&&(i||Oe.DEFAULT_BYTE_MODE_ENCODING!==r)){const k=U.getCharacterSetECIByName(r);k!==void 0&&this.appendECI(k,a)}this.appendModeInfo(s,a);const o=new oe;this.appendBytes(e,s,o,r);let l;if(n!==null&&n.get(ze.QR_VERSION)!==void 0){const k=Number.parseInt(n.get(ze.QR_VERSION).toString(),10);l=K.getVersionForNumber(k);const P=this.calculateBitsNeeded(s,a,o,l);if(!this.willFit(P,l,t))throw new ye("Data too big for requested version")}else l=this.recommendVersion(t,s,a,o);const c=new oe;c.appendBitArray(a);const f=s===q.BYTE?o.getSizeInBytes():e.length;this.appendLengthInfo(f,l,s,c),c.appendBitArray(o);const d=l.getECBlocksForLevel(t),A=l.getTotalCodewords()-d.getTotalECCodewords();this.terminateBits(A,c);const b=this.interleaveWithECBytes(c,l.getTotalCodewords(),A,d.getNumBlocks()),I=new en;I.setECLevel(t),I.setMode(s),I.setVersion(l);const S=l.getDimensionForVersion(),_=new kn(S,S),F=this.chooseMaskPattern(b,t,l,_);return I.setMaskPattern(F),J.buildMatrix(b,t,l,F,_),I.setMatrix(_),I}static recommendVersion(e,t,n,r){const i=this.calculateBitsNeeded(t,n,r,K.getVersionForNumber(1)),s=this.chooseVersion(i,e),a=this.calculateBitsNeeded(t,n,r,s);return this.chooseVersion(a,e)}static calculateBitsNeeded(e,t,n,r){return t.getSize()+e.getCharacterCountBits(r)+n.getSize()}static getAlphanumericCode(e){return e<Oe.ALPHANUMERIC_TABLE.length?Oe.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(U.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return q.KANJI;let n=!1,r=!1;for(let i=0,s=e.length;i<s;++i){const a=e.charAt(i);if(Oe.isDigit(a))n=!0;else if(this.getAlphanumericCode(a.charCodeAt(0))!==-1)r=!0;else return q.BYTE}return r?q.ALPHANUMERIC:n?q.NUMERIC:q.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=We.encode(e,U.SJIS)}catch{return!1}const n=t.length;if(n%2!==0)return!1;for(let r=0;r<n;r+=2){const i=t[r]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0}static chooseMaskPattern(e,t,n,r){let i=Number.MAX_SAFE_INTEGER,s=-1;for(let a=0;a<en.NUM_MASK_PATTERNS;a++){J.buildMatrix(e,t,n,a,r);let o=this.calculateMaskPenalty(r);o<i&&(i=o,s=a)}return s}static chooseVersion(e,t){for(let n=1;n<=40;n++){const r=K.getVersionForNumber(n);if(Oe.willFit(e,r,t))return r}throw new ye("Data too big")}static willFit(e,t,n){const r=t.getTotalCodewords(),s=t.getECBlocksForLevel(n).getTotalECCodewords(),a=r-s,o=(e+7)/8;return a>=o}static terminateBits(e,t){const n=e*8;if(t.getSize()>n)throw new ye("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(let s=0;s<4&&t.getSize()<n;++s)t.appendBit(!1);const r=t.getSize()&7;if(r>0)for(let s=r;s<8;s++)t.appendBit(!1);const i=e-t.getSizeInBytes();for(let s=0;s<i;++s)t.appendBits((s&1)===0?236:17,8);if(t.getSize()!==n)throw new ye("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,n,r,i,s){if(r>=n)throw new ye("Block ID too large");const a=e%n,o=n-a,l=Math.floor(e/n),c=l+1,f=Math.floor(t/n),d=f+1,A=l-f,b=c-d;if(A!==b)throw new ye("EC bytes mismatch");if(n!==o+a)throw new ye("RS blocks mismatch");if(e!==(f+A)*o+(d+b)*a)throw new ye("Total bytes mismatch");r<o?(i[0]=f,s[0]=A):(i[0]=d,s[0]=b)}static interleaveWithECBytes(e,t,n,r){if(e.getSizeInBytes()!==n)throw new ye("Number of bits and data bytes does not match");let i=0,s=0,a=0;const o=new Array;for(let c=0;c<r;++c){const f=new Int32Array(1),d=new Int32Array(1);Oe.getNumDataBytesAndNumECBytesForBlockID(t,n,r,c,f,d);const A=f[0],b=new Uint8Array(A);e.toBytes(8*i,b,0,A);const I=Oe.generateECBytes(b,d[0]);o.push(new gi(b,I)),s=Math.max(s,A),a=Math.max(a,I.length),i+=f[0]}if(n!==i)throw new ye("Data bytes does not match offset");const l=new oe;for(let c=0;c<s;++c)for(const f of o){const d=f.getDataBytes();c<d.length&&l.appendBits(d[c],8)}for(let c=0;c<a;++c)for(const f of o){const d=f.getErrorCorrectionBytes();c<d.length&&l.appendBits(d[c],8)}if(t!==l.getSizeInBytes())throw new ye("Interleaving error: "+t+" and "+l.getSizeInBytes()+" differ.");return l}static generateECBytes(e,t){const n=e.length,r=new Int32Array(n+t);for(let s=0;s<n;s++)r[s]=e[s]&255;new sr(fe.QR_CODE_FIELD_256).encode(r,t);const i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=r[n+s];return i}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,n,r){const i=n.getCharacterCountBits(t);if(e>=1<<i)throw new ye(e+" is bigger than "+((1<<i)-1));r.appendBits(e,i)}static appendBytes(e,t,n,r){switch(t){case q.NUMERIC:Oe.appendNumericBytes(e,n);break;case q.ALPHANUMERIC:Oe.appendAlphanumericBytes(e,n);break;case q.BYTE:Oe.append8BitBytes(e,n,r);break;case q.KANJI:Oe.appendKanjiBytes(e,n);break;default:throw new ye("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=Oe.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=Oe.getDigit(e.charAt(r));if(r+2<n){const s=Oe.getDigit(e.charAt(r+1)),a=Oe.getDigit(e.charAt(r+2));t.appendBits(i*100+s*10+a,10),r+=3}else if(r+1<n){const s=Oe.getDigit(e.charAt(r+1));t.appendBits(i*10+s,7),r+=2}else t.appendBits(i,4),r++}}static appendAlphanumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=Oe.getAlphanumericCode(e.charCodeAt(r));if(i===-1)throw new ye;if(r+1<n){const s=Oe.getAlphanumericCode(e.charCodeAt(r+1));if(s===-1)throw new ye;t.appendBits(i*45+s,11),r+=2}else t.appendBits(i,6),r++}}static append8BitBytes(e,t,n){let r;try{r=We.encode(e,n)}catch(i){throw new ye(i)}for(let i=0,s=r.length;i!==s;i++){const a=r[i];t.appendBits(a,8)}}static appendKanjiBytes(e,t){let n;try{n=We.encode(e,U.SJIS)}catch(i){throw new ye(i)}const r=n.length;for(let i=0;i<r;i+=2){const s=n[i]&255,a=n[i+1]&255,o=s<<8&4294967295|a;let l=-1;if(o>=33088&&o<=40956?l=o-33088:o>=57408&&o<=60351&&(l=o-49472),l===-1)throw new ye("Invalid byte sequence");const c=(l>>8)*192+(l&255);t.appendBits(c,13)}}static appendECI(e,t){t.appendBits(q.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}Oe.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Oe.DEFAULT_BYTE_MODE_ENCODING=U.UTF8.getName();class tn{write(e,t,n,r=null){if(e.length===0)throw new D("Found empty contents");if(t<0||n<0)throw new D("Requested dimensions are too small: "+t+"x"+n);let i=_e.L,s=tn.QUIET_ZONE_SIZE;r!==null&&(r.get(ze.ERROR_CORRECTION)!==void 0&&(i=_e.fromString(r.get(ze.ERROR_CORRECTION).toString())),r.get(ze.MARGIN)!==void 0&&(s=Number.parseInt(r.get(ze.MARGIN).toString(),10)));const a=Oe.encode(e,i,r);return this.renderResult(a,t,n,s)}writeToDom(e,t,n,r,i=null){typeof e=="string"&&(e=document.querySelector(e));const s=this.write(t,n,r,i);e&&e.appendChild(s)}renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new Et;const s=i.getWidth(),a=i.getHeight(),o=s+r*2,l=a+r*2,c=Math.max(t,o),f=Math.max(n,l),d=Math.min(Math.floor(c/o),Math.floor(f/l)),A=Math.floor((c-s*d)/2),b=Math.floor((f-a*d)/2),I=this.createSVGElement(c,f);for(let S=0,_=b;S<a;S++,_+=d)for(let F=0,k=A;F<s;F++,k+=d)if(i.get(F,S)===1){const P=this.createSvgRectElement(k,_,d,d);I.appendChild(P)}return I}createSVGElement(e,t){const n=document.createElementNS(tn.SVG_NS,"svg");return n.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width",t.toString()),n}createSvgRectElement(e,t,n,r){const i=document.createElementNS(tn.SVG_NS,"rect");return i.setAttributeNS(null,"x",e.toString()),i.setAttributeNS(null,"y",t.toString()),i.setAttributeNS(null,"height",n.toString()),i.setAttributeNS(null,"width",r.toString()),i.setAttributeNS(null,"fill","#000000"),i}}tn.QUIET_ZONE_SIZE=4,tn.SVG_NS="http://www.w3.org/2000/svg";class hn{encode(e,t,n,r,i){if(e.length===0)throw new D("Found empty contents");if(t!==z.QR_CODE)throw new D("Can only encode QR_CODE, but got "+t);if(n<0||r<0)throw new D(`Requested dimensions are too small: ${n}x${r}`);let s=_e.L,a=hn.QUIET_ZONE_SIZE;i!==null&&(i.get(ze.ERROR_CORRECTION)!==void 0&&(s=_e.fromString(i.get(ze.ERROR_CORRECTION).toString())),i.get(ze.MARGIN)!==void 0&&(a=Number.parseInt(i.get(ze.MARGIN).toString(),10)));const o=Oe.encode(e,s,i);return hn.renderResult(o,n,r,a)}static renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new Et;const s=i.getWidth(),a=i.getHeight(),o=s+r*2,l=a+r*2,c=Math.max(t,o),f=Math.max(n,l),d=Math.min(Math.floor(c/o),Math.floor(f/l)),A=Math.floor((c-s*d)/2),b=Math.floor((f-a*d)/2),I=new Re(c,f);for(let S=0,_=b;S<a;S++,_+=d)for(let F=0,k=A;F<s;F++,k+=d)i.get(F,S)===1&&I.setRegion(k,_,d,d);return I}}hn.QUIET_ZONE_SIZE=4;class wi{encode(e,t,n,r,i){let s;switch(t){case z.QR_CODE:s=new hn;break;default:throw new D("No encoder available for format "+t)}return s.encode(e,t,n,r,i)}}class Bt extends Zt{constructor(e,t,n,r,i,s,a,o){if(super(s,a),this.yuvData=e,this.dataWidth=t,this.dataHeight=n,this.left=r,this.top=i,r+s>t||i+a>n)throw new D("Crop rectangle does not fit within image data.");o&&this.reverseHorizontal(s,a)}getRow(e,t){if(e<0||e>=this.getHeight())throw new D("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return ne.arraycopy(this.yuvData,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return ne.arraycopy(this.yuvData,i,r,0,n),r;for(let s=0;s<t;s++){const a=s*e;ne.arraycopy(this.yuvData,i,r,a,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new Bt(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,n,r,!1)}renderThumbnail(){const e=this.getWidth()/Bt.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/Bt.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(e*t),r=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let s=0;s<t;s++){const a=s*e;for(let o=0;o<e;o++){const l=r[i+o*Bt.THUMBNAIL_SCALE_FACTOR]&255;n[a+o]=4278190080|l*65793}i+=this.dataWidth*Bt.THUMBNAIL_SCALE_FACTOR}return n}getThumbnailWidth(){return this.getWidth()/Bt.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Bt.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const n=this.yuvData;for(let r=0,i=this.top*this.dataWidth+this.left;r<t;r++,i+=this.dataWidth){const s=i+e/2;for(let a=i,o=i+e-1;a<s;a++,o--){const l=n[a];n[a]=n[o],n[o]=l}}}invert(){return new $e(this)}}Bt.THUMBNAIL_SCALE_FACTOR=2;class ar extends Zt{constructor(e,t,n,r,i,s,a){if(super(t,n),this.dataWidth=r,this.dataHeight=i,this.left=s,this.top=a,e.BYTES_PER_ELEMENT===4){const o=t*n,l=new Uint8ClampedArray(o);for(let c=0;c<o;c++){const f=e[c],d=f>>16&255,A=f>>7&510,b=f&255;l[c]=(d+A+b)/4&255}this.luminances=l}else this.luminances=e;if(r===void 0&&(this.dataWidth=t),i===void 0&&(this.dataHeight=n),s===void 0&&(this.left=0),a===void 0&&(this.top=0),this.left+t>this.dataWidth||this.top+n>this.dataHeight)throw new D("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new D("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return ne.arraycopy(this.luminances,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return ne.arraycopy(this.luminances,i,r,0,n),r;for(let s=0;s<t;s++){const a=s*e;ne.arraycopy(this.luminances,i,r,a,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new ar(this.luminances,n,r,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new $e(this)}}class Tr extends U{static forName(e){return this.getCharacterSetECIByName(e)}}class or{}or.ISO_8859_1=U.ISO8859_1;class _r{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Rr{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class mi{constructor(e){this.previous=e}getPrevious(){return this.previous}}class fn extends mi{constructor(e,t,n){super(e),this.value=t,this.bitCount=n}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new fn(this,e,t)}addBinaryShift(e,t){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new fn(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+$.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class lr extends fn{constructor(e,t,n){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=n}appendTo(e,t){for(let n=0;n<this.binaryShiftByteCount;n++)(n===0||n===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):n===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+n],8)}addBinaryShift(e,t){return new lr(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Ai(h,e,t){return new lr(h,e,t)}function Nn(h,e,t){return new fn(h,e,t)}const Ci=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],zt=0,Un=1,St=2,Or=3,Pt=4,Ei=new fn(null,0,0),cr=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function pi(h){for(let e of h)pe.fill(e,-1);return h[zt][Pt]=0,h[Un][Pt]=0,h[Un][zt]=28,h[Or][Pt]=0,h[St][Pt]=0,h[St][zt]=15,h}const Dr=pi(pe.createInt32Array(6,6));class Lt{constructor(e,t,n,r){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=r}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let n=this.bitCount,r=this.token;if(e!==this.mode){let s=cr[this.mode][e];r=Nn(r,s&65535,s>>16),n+=s>>16}let i=e===St?4:5;return r=Nn(r,t,i),new Lt(r,e,0,n+i)}shiftAndAppend(e,t){let n=this.token,r=this.mode===St?4:5;return n=Nn(n,Dr[this.mode][e],r),n=Nn(n,t,5),new Lt(n,this.mode,0,this.bitCount+r+5)}addBinaryShiftChar(e){let t=this.token,n=this.mode,r=this.bitCount;if(this.mode===Pt||this.mode===St){let a=cr[n][zt];t=Nn(t,a&65535,a>>16),r+=a>>16,n=zt}let i=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,s=new Lt(t,n,this.binaryShiftByteCount+1,r+i);return s.binaryShiftByteCount===2078&&(s=s.endBinaryShift(e+1)),s}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let t=this.token;return t=Ai(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new Lt(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(cr[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=Lt.calculateBinaryShiftCost(e)-Lt.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let r=this.endBinaryShift(e.length).token;r!==null;r=r.getPrevious())t.unshift(r);let n=new oe;for(const r of t)r.appendTo(n,e);return n}toString(){return Q.format("%s bits=%d bytes=%d",Ci[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}Lt.INITIAL_STATE=new Lt(Ei,zt,0,0);function bi(h){const e=Q.getCharCode(" "),t=Q.getCharCode("."),n=Q.getCharCode(",");h[zt][e]=1;const r=Q.getCharCode("Z"),i=Q.getCharCode("A");for(let d=i;d<=r;d++)h[zt][d]=d-i+2;h[Un][e]=1;const s=Q.getCharCode("z"),a=Q.getCharCode("a");for(let d=a;d<=s;d++)h[Un][d]=d-a+2;h[St][e]=1;const o=Q.getCharCode("9"),l=Q.getCharCode("0");for(let d=l;d<=o;d++)h[St][d]=d-l+2;h[St][n]=12,h[St][t]=13;const c=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let d=0;d<c.length;d++)h[Or][Q.getCharCode(c[d])]=d;const f=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let d=0;d<f.length;d++)Q.getCharCode(f[d])>0&&(h[Pt][Q.getCharCode(f[d])]=d);return h}const ur=bi(pe.createInt32Array(5,256));class Tn{constructor(e){this.text=e}encode(){const e=Q.getCharCode(" "),t=Q.getCharCode(`
`);let n=Rr.singletonList(Lt.INITIAL_STATE);for(let i=0;i<this.text.length;i++){let s,a=i+1<this.text.length?this.text[i+1]:0;switch(this.text[i]){case Q.getCharCode("\r"):s=a===t?2:0;break;case Q.getCharCode("."):s=a===e?3:0;break;case Q.getCharCode(","):s=a===e?4:0;break;case Q.getCharCode(":"):s=a===e?5:0;break;default:s=0}s>0?(n=Tn.updateStateListForPair(n,i,s),i++):n=this.updateStateListForChar(n,i)}return Rr.min(n,(i,s)=>i.getBitCount()-s.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const n=[];for(let r of e)this.updateStateForChar(r,t,n);return Tn.simplifyStates(n)}updateStateForChar(e,t,n){let r=this.text[t]&255,i=ur[e.getMode()][r]>0,s=null;for(let a=0;a<=Pt;a++){let o=ur[a][r];if(o>0){if(s==null&&(s=e.endBinaryShift(t)),!i||a===e.getMode()||a===St){const l=s.latchAndAppend(a,o);n.push(l)}if(!i&&Dr[e.getMode()][a]>=0){const l=s.shiftAndAppend(a,o);n.push(l)}}}if(e.getBinaryShiftByteCount()>0||ur[e.getMode()][r]===0){let a=e.addBinaryShiftChar(t);n.push(a)}}static updateStateListForPair(e,t,n){const r=[];for(let i of e)this.updateStateForPair(i,t,n,r);return this.simplifyStates(r)}static updateStateForPair(e,t,n,r){let i=e.endBinaryShift(t);if(r.push(i.latchAndAppend(Pt,n)),e.getMode()!==Pt&&r.push(i.shiftAndAppend(Pt,n)),n===3||n===4){let s=i.latchAndAppend(St,16-n).latchAndAppend(St,1);r.push(s)}if(e.getBinaryShiftByteCount()>0){let s=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);r.push(s)}}static simplifyStates(e){let t=[];for(const n of e){let r=!0;for(const i of t){if(i.isBetterThanOrEqualTo(n)){r=!1;break}n.isBetterThanOrEqualTo(i)&&(t=t.filter(s=>s!==i))}r&&t.push(n)}return t}}class xe{constructor(){}static encodeBytes(e){return xe.encode(e,xe.DEFAULT_EC_PERCENT,xe.DEFAULT_AZTEC_LAYERS)}static encode(e,t,n){let r=new Tn(e).encode(),i=$.truncDivision(r.getSize()*t,100)+11,s=r.getSize()+i,a,o,l,c,f;if(n!==xe.DEFAULT_AZTEC_LAYERS){if(a=n<0,o=Math.abs(n),o>(a?xe.MAX_NB_BITS_COMPACT:xe.MAX_NB_BITS))throw new D(Q.format("Illegal value %s for layers",n));l=xe.totalBitsInLayer(o,a),c=xe.WORD_SIZE[o];let P=l-l%c;if(f=xe.stuffBits(r,c),f.getSize()+i>P)throw new D("Data to large for user specified layer");if(a&&f.getSize()>c*64)throw new D("Data to large for user specified layer")}else{c=0,f=null;for(let P=0;;P++){if(P>xe.MAX_NB_BITS)throw new D("Data too large for an Aztec code");if(a=P<=3,o=a?P+1:P,l=xe.totalBitsInLayer(o,a),s>l)continue;(f==null||c!==xe.WORD_SIZE[o])&&(c=xe.WORD_SIZE[o],f=xe.stuffBits(r,c));let ce=l-l%c;if(!(a&&f.getSize()>c*64)&&f.getSize()+i<=ce)break}}let d=xe.generateCheckWords(f,l,c),A=f.getSize()/c,b=xe.generateModeMessage(a,o,A),I=(a?11:14)+o*4,S=new Int32Array(I),_;if(a){_=I;for(let P=0;P<S.length;P++)S[P]=P}else{_=I+1+2*$.truncDivision($.truncDivision(I,2)-1,15);let P=$.truncDivision(I,2),ce=$.truncDivision(_,2);for(let ie=0;ie<P;ie++){let dt=ie+$.truncDivision(ie,15);S[P-ie-1]=ce-dt-1,S[P+ie]=ce+dt+1}}let F=new Re(_);for(let P=0,ce=0;P<o;P++){let ie=(o-P)*4+(a?9:12);for(let dt=0;dt<ie;dt++){let _t=dt*2;for(let xt=0;xt<2;xt++)d.get(ce+_t+xt)&&F.set(S[P*2+xt],S[P*2+dt]),d.get(ce+ie*2+_t+xt)&&F.set(S[P*2+dt],S[I-1-P*2-xt]),d.get(ce+ie*4+_t+xt)&&F.set(S[I-1-P*2-xt],S[I-1-P*2-dt]),d.get(ce+ie*6+_t+xt)&&F.set(S[I-1-P*2-dt],S[P*2+xt])}ce+=ie*8}if(xe.drawModeMessage(F,a,_,b),a)xe.drawBullsEye(F,$.truncDivision(_,2),5);else{xe.drawBullsEye(F,$.truncDivision(_,2),7);for(let P=0,ce=0;P<$.truncDivision(I,2)-1;P+=15,ce+=16)for(let ie=$.truncDivision(_,2)&1;ie<_;ie+=2)F.set($.truncDivision(_,2)-ce,ie),F.set($.truncDivision(_,2)+ce,ie),F.set(ie,$.truncDivision(_,2)-ce),F.set(ie,$.truncDivision(_,2)+ce)}let k=new _r;return k.setCompact(a),k.setSize(_),k.setLayers(o),k.setCodeWords(A),k.setMatrix(F),k}static drawBullsEye(e,t,n){for(let r=0;r<n;r+=2)for(let i=t-r;i<=t+r;i++)e.set(i,t-r),e.set(i,t+r),e.set(t-r,i),e.set(t+r,i);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)}static generateModeMessage(e,t,n){let r=new oe;return e?(r.appendBits(t-1,2),r.appendBits(n-1,6),r=xe.generateCheckWords(r,28,4)):(r.appendBits(t-1,5),r.appendBits(n-1,11),r=xe.generateCheckWords(r,40,4)),r}static drawModeMessage(e,t,n,r){let i=$.truncDivision(n,2);if(t)for(let s=0;s<7;s++){let a=i-3+s;r.get(s)&&e.set(a,i-5),r.get(s+7)&&e.set(i+5,a),r.get(20-s)&&e.set(a,i+5),r.get(27-s)&&e.set(i-5,a)}else for(let s=0;s<10;s++){let a=i-5+s+$.truncDivision(s,5);r.get(s)&&e.set(a,i-7),r.get(s+10)&&e.set(i+7,a),r.get(29-s)&&e.set(a,i+7),r.get(39-s)&&e.set(i-7,a)}}static generateCheckWords(e,t,n){let r=e.getSize()/n,i=new sr(xe.getGF(n)),s=$.truncDivision(t,n),a=xe.bitsToWords(e,n,s);i.encode(a,s-r);let o=t%n,l=new oe;l.appendBits(0,o);for(const c of Array.from(a))l.appendBits(c,n);return l}static bitsToWords(e,t,n){let r=new Int32Array(n),i,s;for(i=0,s=e.getSize()/t;i<s;i++){let a=0;for(let o=0;o<t;o++)a|=e.get(i*t+o)?1<<t-o-1:0;r[i]=a}return r}static getGF(e){switch(e){case 4:return fe.AZTEC_PARAM;case 6:return fe.AZTEC_DATA_6;case 8:return fe.AZTEC_DATA_8;case 10:return fe.AZTEC_DATA_10;case 12:return fe.AZTEC_DATA_12;default:throw new D("Unsupported word size "+e)}}static stuffBits(e,t){let n=new oe,r=e.getSize(),i=(1<<t)-2;for(let s=0;s<r;s+=t){let a=0;for(let o=0;o<t;o++)(s+o>=r||e.get(s+o))&&(a|=1<<t-1-o);(a&i)===i?(n.appendBits(a&i,t),s--):(a&i)===0?(n.appendBits(a|1,t),s--):n.appendBits(a,t)}return n}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}xe.DEFAULT_EC_PERCENT=33,xe.DEFAULT_AZTEC_LAYERS=0,xe.MAX_NB_BITS=32,xe.MAX_NB_BITS_COMPACT=4,xe.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Vn{encode(e,t,n,r){return this.encodeWithHints(e,t,n,r,null)}encodeWithHints(e,t,n,r,i){let s=or.ISO_8859_1,a=xe.DEFAULT_EC_PERCENT,o=xe.DEFAULT_AZTEC_LAYERS;return i!=null&&(i.has(ze.CHARACTER_SET)&&(s=Tr.forName(i.get(ze.CHARACTER_SET).toString())),i.has(ze.ERROR_CORRECTION)&&(a=$.parseInt(i.get(ze.ERROR_CORRECTION).toString())),i.has(ze.AZTEC_LAYERS)&&(o=$.parseInt(i.get(ze.AZTEC_LAYERS).toString()))),Vn.encodeLayers(e,t,n,r,s,a,o)}static encodeLayers(e,t,n,r,i,s,a){if(t!==z.AZTEC)throw new D("Can only encode AZTEC, but got "+t);let o=xe.encode(Q.getBytes(e,i),s,a);return Vn.renderResult(o,n,r)}static renderResult(e,t,n){let r=e.getMatrix();if(r==null)throw new Et;let i=r.getWidth(),s=r.getHeight(),a=Math.max(t,i),o=Math.max(n,s),l=Math.min(a/i,o/s),c=(a-i*l)/2,f=(o-s*l)/2,d=new Re(a,o);for(let A=0,b=f;A<s;A++,b+=l)for(let I=0,S=c;I<i;I++,S+=l)r.get(I,A)&&d.setRegion(S,b,l,l);return d}}u.AbstractExpandedDecoder=Kn,u.ArgumentException=L,u.ArithmeticException=rn,u.AztecCode=_r,u.AztecCodeReader=Ie,u.AztecCodeWriter=Vn,u.AztecDecoder=Ae,u.AztecDetector=W,u.AztecDetectorResult=Dn,u.AztecEncoder=xe,u.AztecHighLevelEncoder=Tn,u.AztecPoint=M,u.BarcodeFormat=z,u.Binarizer=Qe,u.BinaryBitmap=ue,u.BitArray=oe,u.BitMatrix=Re,u.BitSource=$n,u.BrowserAztecCodeReader=at,u.BrowserBarcodeReader=$r,u.BrowserCodeReader=Ft,u.BrowserDatamatrixCodeReader=ti,u.BrowserMultiFormatReader=fi,u.BrowserPDF417Reader=di,u.BrowserQRCodeReader=xi,u.BrowserQRCodeSvgWriter=tn,u.CharacterSetECI=U,u.ChecksumException=re,u.Code128Reader=H,u.Code39Reader=ke,u.DataMatrixDecodedBitStreamParser=Wt,u.DataMatrixReader=Xt,u.DecodeHintType=le,u.DecoderResult=Vt,u.DefaultGridSampler=An,u.DetectorResult=Kt,u.EAN13Reader=qt,u.EncodeHintType=ze,u.Exception=C,u.FormatException=G,u.GenericGF=fe,u.GenericGFPoly=Fe,u.GlobalHistogramBinarizer=Ne,u.GridSampler=mn,u.GridSamplerInstance=Ot,u.HTMLCanvasElementLuminanceSource=ct,u.HybridBinarizer=te,u.ITFReader=Ce,u.IllegalArgumentException=D,u.IllegalStateException=Et,u.InvertedLuminanceSource=$e,u.LuminanceSource=Zt,u.MathUtils=Z,u.MultiFormatOneDReader=cn,u.MultiFormatReader=Nr,u.MultiFormatWriter=wi,u.NotFoundException=O,u.OneDReader=Te,u.PDF417DecodedBitStreamParser=T,u.PDF417DecoderErrorCorrection=Er,u.PDF417Reader=tt,u.PDF417ResultMetadata=br,u.PerspectiveTransform=mt,u.PlanarYUVLuminanceSource=Bt,u.QRCodeByteMatrix=kn,u.QRCodeDataMask=It,u.QRCodeDecodedBitStreamParser=Pe,u.QRCodeDecoderErrorCorrectionLevel=_e,u.QRCodeDecoderFormatInformation=st,u.QRCodeEncoder=Oe,u.QRCodeEncoderQRCode=en,u.QRCodeMaskUtil=Ge,u.QRCodeMatrixUtil=J,u.QRCodeMode=q,u.QRCodeReader=jt,u.QRCodeVersion=K,u.QRCodeWriter=hn,u.RGBLuminanceSource=ar,u.RSS14Reader=Ve,u.RSSExpandedReader=v,u.ReaderException=Fn,u.ReedSolomonDecoder=Rt,u.ReedSolomonEncoder=sr,u.ReedSolomonException=Gt,u.Result=Le,u.ResultMetadataType=Xe,u.ResultPoint=Y,u.StringUtils=Q,u.UnsupportedOperationException=gt,u.VideoInputDevice=nn,u.WhiteRectangleDetector=pt,u.WriterException=ye,u.ZXingArrays=pe,u.ZXingCharset=Tr,u.ZXingInteger=$,u.ZXingStandardCharsets=or,u.ZXingStringBuilder=de,u.ZXingStringEncoding=We,u.ZXingSystem=ne,u.createAbstractExpandedDecoder=Ar,Object.defineProperty(u,"__esModule",{value:!0})})}(On,On.exports)),On.exports}var De=Gi();const Hi=Si(De),Wi=vi({__proto__:null,default:Hi},[De]);var kr=function(){function w(x,u,E){if(this.formatMap=new Map([[j.QR_CODE,De.BarcodeFormat.QR_CODE],[j.AZTEC,De.BarcodeFormat.AZTEC],[j.CODABAR,De.BarcodeFormat.CODABAR],[j.CODE_39,De.BarcodeFormat.CODE_39],[j.CODE_93,De.BarcodeFormat.CODE_93],[j.CODE_128,De.BarcodeFormat.CODE_128],[j.DATA_MATRIX,De.BarcodeFormat.DATA_MATRIX],[j.MAXICODE,De.BarcodeFormat.MAXICODE],[j.ITF,De.BarcodeFormat.ITF],[j.EAN_13,De.BarcodeFormat.EAN_13],[j.EAN_8,De.BarcodeFormat.EAN_8],[j.PDF_417,De.BarcodeFormat.PDF_417],[j.RSS_14,De.BarcodeFormat.RSS_14],[j.RSS_EXPANDED,De.BarcodeFormat.RSS_EXPANDED],[j.UPC_A,De.BarcodeFormat.UPC_A],[j.UPC_E,De.BarcodeFormat.UPC_E],[j.UPC_EAN_EXTENSION,De.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Wi)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=u,this.logger=E;var p=this.createZXingFormats(x),g=new Map;g.set(De.DecodeHintType.POSSIBLE_FORMATS,p),g.set(De.DecodeHintType.TRY_HARDER,!1),this.hints=g}return w.prototype.decodeAsync=function(x){var u=this;return new Promise(function(E,p){try{E(u.decode(x))}catch(g){p(g)}})},w.prototype.decode=function(x){var u=new De.MultiFormatReader(this.verbose,this.hints),E=new De.HTMLCanvasElementLuminanceSource(x),p=new De.BinaryBitmap(new De.HybridBinarizer(E)),g=u.decode(p);return{text:g.text,format:Yr.create(this.toHtml5QrcodeSupportedFormats(g.format)),debugData:this.createDebugData()}},w.prototype.createReverseFormatMap=function(){var x=new Map;return this.formatMap.forEach(function(u,E,p){x.set(u,E)}),x},w.prototype.toHtml5QrcodeSupportedFormats=function(x){if(!this.reverseFormatMap.has(x))throw"reverseFormatMap doesn't have ".concat(x);return this.reverseFormatMap.get(x)},w.prototype.createZXingFormats=function(x){for(var u=[],E=0,p=x;E<p.length;E++){var g=p[E];this.formatMap.has(g)?u.push(this.formatMap.get(g)):this.logger.logError("".concat(g," is not supported by")+"ZXingHtml5QrcodeShim")}return u},w.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},w}(),Xi=function(w,x,u,E){function p(g){return g instanceof u?g:new u(function(R){R(g)})}return new(u||(u=Promise))(function(g,R){function V(L){try{C(E.next(L))}catch(D){R(D)}}function B(L){try{C(E.throw(L))}catch(D){R(D)}}function C(L){L.done?g(L.value):p(L.value).then(V,B)}C((E=E.apply(w,x||[])).next())})},ji=function(w,x){var u={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},E,p,g,R;return R={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function V(C){return function(L){return B([C,L])}}function B(C){if(E)throw new TypeError("Generator is already executing.");for(;R&&(R=0,C[0]&&(u=0)),u;)try{if(E=1,p&&(g=C[0]&2?p.return:C[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,C[1])).done)return g;switch(p=0,g&&(C=[C[0]&2,g.value]),C[0]){case 0:case 1:g=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,p=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(g=u.trys,!(g=g.length>0&&g[g.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!g||C[1]>g[0]&&C[1]<g[3])){u.label=C[1];break}if(C[0]===6&&u.label<g[1]){u.label=g[1],g=C;break}if(g&&u.label<g[2]){u.label=g[2],u.ops.push(C);break}g[2]&&u.ops.pop(),u.trys.pop();continue}C=x.call(w,u)}catch(L){C=[6,L],p=0}finally{E=g=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Ur=function(){function w(x,u,E){if(this.formatMap=new Map([[j.QR_CODE,"qr_code"],[j.AZTEC,"aztec"],[j.CODABAR,"codabar"],[j.CODE_39,"code_39"],[j.CODE_93,"code_93"],[j.CODE_128,"code_128"],[j.DATA_MATRIX,"data_matrix"],[j.ITF,"itf"],[j.EAN_13,"ean_13"],[j.EAN_8,"ean_8"],[j.PDF_417,"pdf417"],[j.UPC_A,"upc_a"],[j.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!w.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=u,this.logger=E;var p=this.createBarcodeDetectorFormats(x);if(this.detector=new BarcodeDetector(p),!this.detector)throw"BarcodeDetector detector not supported"}return w.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var x=new BarcodeDetector({formats:["qr_code"]});return typeof x<"u"},w.prototype.decodeAsync=function(x){return Xi(this,void 0,void 0,function(){var u,E;return ji(this,function(p){switch(p.label){case 0:return[4,this.detector.detect(x)];case 1:if(u=p.sent(),!u||u.length===0)throw"No barcode or QR code detected.";return E=this.selectLargestBarcode(u),[2,{text:E.rawValue,format:Yr.create(this.toHtml5QrcodeSupportedFormats(E.format)),debugData:this.createDebugData()}]}})})},w.prototype.selectLargestBarcode=function(x){for(var u=null,E=0,p=0,g=x;p<g.length;p++){var R=g[p],V=R.boundingBox.width*R.boundingBox.height;V>E&&(E=V,u=R)}if(!u)throw"No largest barcode found";return u},w.prototype.createBarcodeDetectorFormats=function(x){for(var u=[],E=0,p=x;E<p.length;E++){var g=p[E];this.formatMap.has(g)?u.push(this.formatMap.get(g)):this.logger.warn("".concat(g," is not supported by")+"BarcodeDetectorDelegate")}return{formats:u}},w.prototype.toHtml5QrcodeSupportedFormats=function(x){if(!this.reverseFormatMap.has(x))throw"reverseFormatMap doesn't have ".concat(x);return this.reverseFormatMap.get(x)},w.prototype.createReverseFormatMap=function(){var x=new Map;return this.formatMap.forEach(function(u,E,p){x.set(u,E)}),x},w.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},w}(),Vr=function(w,x,u,E){function p(g){return g instanceof u?g:new u(function(R){R(g)})}return new(u||(u=Promise))(function(g,R){function V(L){try{C(E.next(L))}catch(D){R(D)}}function B(L){try{C(E.throw(L))}catch(D){R(D)}}function C(L){L.done?g(L.value):p(L.value).then(V,B)}C((E=E.apply(w,x||[])).next())})},Gr=function(w,x){var u={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},E,p,g,R;return R={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function V(C){return function(L){return B([C,L])}}function B(C){if(E)throw new TypeError("Generator is already executing.");for(;R&&(R=0,C[0]&&(u=0)),u;)try{if(E=1,p&&(g=C[0]&2?p.return:C[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,C[1])).done)return g;switch(p=0,g&&(C=[C[0]&2,g.value]),C[0]){case 0:case 1:g=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,p=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(g=u.trys,!(g=g.length>0&&g[g.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!g||C[1]>g[0]&&C[1]<g[3])){u.label=C[1];break}if(C[0]===6&&u.label<g[1]){u.label=g[1],g=C;break}if(g&&u.label<g[2]){u.label=g[2],u.ops.push(C);break}g[2]&&u.ops.pop(),u.trys.pop();continue}C=x.call(w,u)}catch(L){C=[6,L],p=0}finally{E=g=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Yi=function(){function w(x,u,E,p){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=E,u&&Ur.isSupported()?(this.primaryDecoder=new Ur(x,E,p),this.secondaryDecoder=new kr(x,E,p)):this.primaryDecoder=new kr(x,E,p)}return w.prototype.decodeAsync=function(x){return Vr(this,void 0,void 0,function(){var u;return Gr(this,function(E){switch(E.label){case 0:u=performance.now(),E.label=1;case 1:return E.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(x)];case 2:return[2,E.sent()];case 3:return this.possiblyLogPerformance(u),[7];case 4:return[2]}})})},w.prototype.decodeRobustlyAsync=function(x){return Vr(this,void 0,void 0,function(){var u,E;return Gr(this,function(p){switch(p.label){case 0:u=performance.now(),p.label=1;case 1:return p.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(x)];case 2:return[2,p.sent()];case 3:if(E=p.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(x)];throw E;case 4:return this.possiblyLogPerformance(u),[7];case 5:return[2]}})})},w.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},w.prototype.possiblyLogPerformance=function(x){if(this.verbose){var u=performance.now()-x;this.executionResults.push(u),this.executions++,this.possiblyFlushPerformanceReport()}},w.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var x=0,u=0,E=this.executionResults;u<E.length;u++){var p=E[u];x+=p}var g=x/this.executionResults.length;console.log("".concat(g," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},w}(),xr=function(){var w=function(x,u){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,p){E.__proto__=p}||function(E,p){for(var g in p)Object.prototype.hasOwnProperty.call(p,g)&&(E[g]=p[g])},w(x,u)};return function(x,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");w(x,u);function E(){this.constructor=x}x.prototype=u===null?Object.create(u):(E.prototype=u.prototype,new E)}}(),Xn=function(w,x,u,E){function p(g){return g instanceof u?g:new u(function(R){R(g)})}return new(u||(u=Promise))(function(g,R){function V(L){try{C(E.next(L))}catch(D){R(D)}}function B(L){try{C(E.throw(L))}catch(D){R(D)}}function C(L){L.done?g(L.value):p(L.value).then(V,B)}C((E=E.apply(w,x||[])).next())})},jn=function(w,x){var u={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},E,p,g,R;return R={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function V(C){return function(L){return B([C,L])}}function B(C){if(E)throw new TypeError("Generator is already executing.");for(;R&&(R=0,C[0]&&(u=0)),u;)try{if(E=1,p&&(g=C[0]&2?p.return:C[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,C[1])).done)return g;switch(p=0,g&&(C=[C[0]&2,g.value]),C[0]){case 0:case 1:g=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,p=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(g=u.trys,!(g=g.length>0&&g[g.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!g||C[1]>g[0]&&C[1]<g[3])){u.label=C[1];break}if(C[0]===6&&u.label<g[1]){u.label=g[1],g=C;break}if(g&&u.label<g[2]){u.label=g[2],u.ops.push(C);break}g[2]&&u.ops.pop(),u.trys.pop();continue}C=x.call(w,u)}catch(L){C=[6,L],p=0}finally{E=g=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Zr=function(){function w(x,u){this.name=x,this.track=u}return w.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},w.prototype.apply=function(x){var u={};u[this.name]=x;var E={advanced:[u]};return this.track.applyConstraints(E)},w.prototype.value=function(){var x=this.track.getSettings();if(this.name in x){var u=x[this.name];return u}return null},w}(),zi=function(w){xr(x,w);function x(u,E){return w.call(this,u,E)||this}return x.prototype.min=function(){return this.getCapabilities().min},x.prototype.max=function(){return this.getCapabilities().max},x.prototype.step=function(){return this.getCapabilities().step},x.prototype.apply=function(u){var E={};E[this.name]=u;var p={advanced:[E]};return this.track.applyConstraints(p)},x.prototype.getCapabilities=function(){this.failIfNotSupported();var u=this.track.getCapabilities(),E=u[this.name];return{min:E.min,max:E.max,step:E.step}},x.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},x}(Zr),Zi=function(w){xr(x,w);function x(u){return w.call(this,"zoom",u)||this}return x}(zi),Ki=function(w){xr(x,w);function x(u){return w.call(this,"torch",u)||this}return x}(Zr),qi=function(){function w(x){this.track=x}return w.prototype.zoomFeature=function(){return new Zi(this.track)},w.prototype.torchFeature=function(){return new Ki(this.track)},w}(),Qi=function(){function w(x,u,E){this.isClosed=!1,this.parentElement=x,this.mediaStream=u,this.callbacks=E,this.surface=this.createVideoElement(this.parentElement.clientWidth),x.append(this.surface)}return w.prototype.createVideoElement=function(x){var u=document.createElement("video");return u.style.width="".concat(x,"px"),u.style.display="block",u.muted=!0,u.setAttribute("muted","true"),u.playsInline=!0,u},w.prototype.setupSurface=function(){var x=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var u=function(){var E=x.surface.clientWidth,p=x.surface.clientHeight;x.callbacks.onRenderSurfaceReady(E,p),x.surface.removeEventListener("playing",u)};this.surface.addEventListener("playing",u),this.surface.srcObject=this.mediaStream,this.surface.play()},w.create=function(x,u,E,p){return Xn(this,void 0,void 0,function(){var g,R;return jn(this,function(V){switch(V.label){case 0:return g=new w(x,u,p),E.aspectRatio?(R={aspectRatio:E.aspectRatio},[4,g.getFirstTrackOrFail().applyConstraints(R)]):[3,2];case 1:V.sent(),V.label=2;case 2:return g.setupSurface(),[2,g]}})})},w.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},w.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},w.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},w.prototype.resume=function(x){this.failIfClosed();var u=this,E=function(){setTimeout(x,200),u.surface.removeEventListener("playing",E)};this.surface.addEventListener("playing",E),this.surface.play()},w.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},w.prototype.getSurface=function(){return this.failIfClosed(),this.surface},w.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},w.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},w.prototype.applyVideoConstraints=function(x){return Xn(this,void 0,void 0,function(){return jn(this,function(u){if("aspectRatio"in x)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(x)]})})},w.prototype.close=function(){if(this.isClosed)return Promise.resolve();var x=this;return new Promise(function(u,E){var p=x.mediaStream.getVideoTracks(),g=p.length,R=0;x.mediaStream.getVideoTracks().forEach(function(V){x.mediaStream.removeTrack(V),V.stop(),++R,R>=g&&(x.isClosed=!0,x.parentElement.removeChild(x.surface),u())})})},w.prototype.getCapabilities=function(){return new qi(this.getFirstTrackOrFail())},w}(),Ji=function(){function w(x){this.mediaStream=x}return w.prototype.render=function(x,u,E){return Xn(this,void 0,void 0,function(){return jn(this,function(p){return[2,Qi.create(x,this.mediaStream,u,E)]})})},w.create=function(x){return Xn(this,void 0,void 0,function(){var u,E;return jn(this,function(p){switch(p.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return u={audio:!1,video:x},[4,navigator.mediaDevices.getUserMedia(u)];case 1:return E=p.sent(),[2,new w(E)]}})})},w}(),Hr=function(w,x,u,E){function p(g){return g instanceof u?g:new u(function(R){R(g)})}return new(u||(u=Promise))(function(g,R){function V(L){try{C(E.next(L))}catch(D){R(D)}}function B(L){try{C(E.throw(L))}catch(D){R(D)}}function C(L){L.done?g(L.value):p(L.value).then(V,B)}C((E=E.apply(w,x||[])).next())})},Wr=function(w,x){var u={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},E,p,g,R;return R={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function V(C){return function(L){return B([C,L])}}function B(C){if(E)throw new TypeError("Generator is already executing.");for(;R&&(R=0,C[0]&&(u=0)),u;)try{if(E=1,p&&(g=C[0]&2?p.return:C[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,C[1])).done)return g;switch(p=0,g&&(C=[C[0]&2,g.value]),C[0]){case 0:case 1:g=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,p=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(g=u.trys,!(g=g.length>0&&g[g.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!g||C[1]>g[0]&&C[1]<g[3])){u.label=C[1];break}if(C[0]===6&&u.label<g[1]){u.label=g[1],g=C;break}if(g&&u.label<g[2]){u.label=g[2],u.ops.push(C);break}g[2]&&u.ops.pop(),u.trys.pop();continue}C=x.call(w,u)}catch(L){C=[6,L],p=0}finally{E=g=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},$i=function(){function w(){}return w.failIfNotSupported=function(){return Hr(this,void 0,void 0,function(){return Wr(this,function(x){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new w]})})},w.prototype.create=function(x){return Hr(this,void 0,void 0,function(){return Wr(this,function(u){return[2,Ji.create(x)]})})},w}(),es=function(w,x,u,E){function p(g){return g instanceof u?g:new u(function(R){R(g)})}return new(u||(u=Promise))(function(g,R){function V(L){try{C(E.next(L))}catch(D){R(D)}}function B(L){try{C(E.throw(L))}catch(D){R(D)}}function C(L){L.done?g(L.value):p(L.value).then(V,B)}C((E=E.apply(w,x||[])).next())})},ts=function(w,x){var u={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},E,p,g,R;return R={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function V(C){return function(L){return B([C,L])}}function B(C){if(E)throw new TypeError("Generator is already executing.");for(;R&&(R=0,C[0]&&(u=0)),u;)try{if(E=1,p&&(g=C[0]&2?p.return:C[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,C[1])).done)return g;switch(p=0,g&&(C=[C[0]&2,g.value]),C[0]){case 0:case 1:g=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,p=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(g=u.trys,!(g=g.length>0&&g[g.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!g||C[1]>g[0]&&C[1]<g[3])){u.label=C[1];break}if(C[0]===6&&u.label<g[1]){u.label=g[1],g=C;break}if(g&&u.label<g[2]){u.label=g[2],u.ops.push(C);break}g[2]&&u.ops.pop(),u.trys.pop();continue}C=x.call(w,u)}catch(L){C=[6,L],p=0}finally{E=g=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},ns=function(){function w(){}return w.retrieve=function(){if(navigator.mediaDevices)return w.getCamerasFromMediaDevices();var x=MediaStreamTrack;return MediaStreamTrack&&x.getSources?w.getCamerasFromMediaStreamTrack():w.rejectWithError()},w.rejectWithError=function(){var x=wn.unableToQuerySupportedDevices();return w.isHttpsOrLocalhost()||(x=wn.insecureContextCameraQueryError()),Promise.reject(x)},w.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var x=location.host.split(":")[0];return x==="127.0.0.1"||x==="localhost"},w.getCamerasFromMediaDevices=function(){return es(this,void 0,void 0,function(){var x,u,E,p,g,R,V;return ts(this,function(B){switch(B.label){case 0:return x=function(C){for(var L=C.getVideoTracks(),D=0,ue=L;D<ue.length;D++){var re=ue[D];re.enabled=!1,re.stop(),C.removeTrack(re)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return u=B.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(E=B.sent(),p=[],g=0,R=E;g<R.length;g++)V=R[g],V.kind==="videoinput"&&p.push({id:V.deviceId,label:V.label});return x(u),[2,p]}})})},w.getCamerasFromMediaStreamTrack=function(){return new Promise(function(x,u){var E=function(g){for(var R=[],V=0,B=g;V<B.length;V++){var C=B[V];C.kind==="video"&&R.push({id:C.id,label:C.label})}x(R)},p=MediaStreamTrack;p.getSources(E)})},w}(),Be;(function(w){w[w.UNKNOWN=0]="UNKNOWN",w[w.NOT_STARTED=1]="NOT_STARTED",w[w.SCANNING=2]="SCANNING",w[w.PAUSED=3]="PAUSED"})(Be||(Be={}));var rs=function(){function w(){this.state=Be.NOT_STARTED,this.onGoingTransactionNewState=Be.UNKNOWN}return w.prototype.directTransition=function(x){this.failIfTransitionOngoing(),this.validateTransition(x),this.state=x},w.prototype.startTransition=function(x){return this.failIfTransitionOngoing(),this.validateTransition(x),this.onGoingTransactionNewState=x,this},w.prototype.execute=function(){if(this.onGoingTransactionNewState===Be.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var x=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Be.UNKNOWN,this.directTransition(x)},w.prototype.cancel=function(){if(this.onGoingTransactionNewState===Be.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Be.UNKNOWN},w.prototype.getState=function(){return this.state},w.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Be.UNKNOWN)throw"Cannot transition to a new state, already under transition"},w.prototype.validateTransition=function(x){switch(this.state){case Be.UNKNOWN:throw"Transition from unknown is not allowed";case Be.NOT_STARTED:this.failIfNewStateIs(x,[Be.PAUSED]);break;case Be.SCANNING:break;case Be.PAUSED:break}},w.prototype.failIfNewStateIs=function(x,u){for(var E=0,p=u;E<p.length;E++){var g=p[E];if(x===g)throw"Cannot transition from ".concat(this.state," to ").concat(x)}},w}(),is=function(){function w(x){this.stateManager=x}return w.prototype.startTransition=function(x){return this.stateManager.startTransition(x)},w.prototype.directTransition=function(x){this.stateManager.directTransition(x)},w.prototype.getState=function(){return this.stateManager.getState()},w.prototype.canScanFile=function(){return this.stateManager.getState()===Be.NOT_STARTED},w.prototype.isScanning=function(){return this.stateManager.getState()!==Be.NOT_STARTED},w.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Be.SCANNING},w.prototype.isPaused=function(){return this.stateManager.getState()===Be.PAUSED},w}(),ss=function(){function w(){}return w.create=function(){return new is(new rs)},w}(),as=function(){var w=function(x,u){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,p){E.__proto__=p}||function(E,p){for(var g in p)Object.prototype.hasOwnProperty.call(p,g)&&(E[g]=p[g])},w(x,u)};return function(x,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");w(x,u);function E(){this.constructor=x}x.prototype=u===null?Object.create(u):(E.prototype=u.prototype,new E)}}(),Ct=function(w){as(x,w);function x(){return w!==null&&w.apply(this,arguments)||this}return x.DEFAULT_WIDTH=300,x.DEFAULT_WIDTH_OFFSET=2,x.FILE_SCAN_MIN_HEIGHT=300,x.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,x.MIN_QR_BOX_SIZE=50,x.SHADED_LEFT=1,x.SHADED_RIGHT=2,x.SHADED_TOP=3,x.SHADED_BOTTOM=4,x.SHADED_REGION_ELEMENT_ID="qr-shaded-region",x.VERBOSE=!1,x.BORDER_SHADER_DEFAULT_COLOR="#ffffff",x.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",x}(Fi),os=function(){function w(x,u){this.logger=u,this.fps=Ct.SCAN_DEFAULT_FPS,x?(x.fps&&(this.fps=x.fps),this.disableFlip=x.disableFlip===!0,this.qrbox=x.qrbox,this.aspectRatio=x.aspectRatio,this.videoConstraints=x.videoConstraints):this.disableFlip=Ct.DEFAULT_DISABLE_FLIP}return w.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?zr.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},w.prototype.isShadedBoxEnabled=function(){return!kt(this.qrbox)},w.create=function(x,u){return new w(x,u)},w}(),Hn=function(){function w(x,u){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(x))throw"HTML Element with id=".concat(x," not found");this.elementId=x,this.verbose=!1;var E;typeof u=="boolean"?this.verbose=u===!0:u&&(E=u,this.verbose=E.verbose===!0,E.experimentalFeatures),this.logger=new Ui(this.verbose),this.qrcode=new Yi(this.getSupportedFormats(u),this.getUseBarCodeDetectorIfSupported(E),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=ss.create()}return w.prototype.start=function(x,u,E,p){var g=this;if(!x)throw"cameraIdOrConfig is required";if(!E||typeof E!="function")throw"qrCodeSuccessCallback is required and should be a function.";var R;p?R=p:R=this.verbose?this.logger.log:function(){};var V=os.create(u,this.logger);this.clearElement();var B=!1;V.videoConstraints&&(V.isMediaStreamConstraintsValid()?B=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var C=B,L=document.getElementById(this.elementId);L.clientWidth?L.clientWidth:Ct.DEFAULT_WIDTH,L.style.position="relative",this.shouldScan=!0,this.element=L;var D=this,ue=this.stateManagerProxy.startTransition(Be.SCANNING);return new Promise(function(re,Qe){var ne=C?V.videoConstraints:D.createVideoConstraints(x);if(!ne){ue.cancel(),Qe("videoConstraints should be defined");return}var lt={};(!C||V.aspectRatio)&&(lt.aspectRatio=V.aspectRatio);var rt={onRenderSurfaceReady:function(pe,$){D.setupUi(pe,$,V),D.isScanning=!0,D.foreverScan(V,E,R)}};$i.failIfNotSupported().then(function(pe){pe.create(ne).then(function($){return $.render(g.element,lt,rt).then(function(oe){D.renderedCamera=oe,ue.execute(),re(null)}).catch(function(oe){ue.cancel(),Qe(oe)})}).catch(function($){ue.cancel(),Qe(wn.errorGettingUserMedia($))})}).catch(function(pe){ue.cancel(),Qe(wn.cameraStreamingNotSupported())})})},w.prototype.pause=function(x){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Be.PAUSED),this.showPausedState(),(kt(x)||x!==!0)&&(x=!1),x&&this.renderedCamera&&this.renderedCamera.pause()},w.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var x=this,u=function(){x.stateManagerProxy.directTransition(Be.SCANNING),x.hidePausedState()};if(!this.renderedCamera.isPaused()){u();return}this.renderedCamera.resume(function(){u()})},w.prototype.getState=function(){return this.stateManagerProxy.getState()},w.prototype.stop=function(){var x=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var u=this.stateManagerProxy.startTransition(Be.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var E=function(){if(x.element){var g=document.getElementById(Ct.SHADED_REGION_ELEMENT_ID);g&&x.element.removeChild(g)}},p=this;return this.renderedCamera.close().then(function(){return p.renderedCamera=null,p.element&&(p.element.removeChild(p.canvasElement),p.canvasElement=null),E(),p.qrRegion&&(p.qrRegion=null),p.context&&(p.context=null),u.execute(),p.hidePausedState(),p.isScanning=!1,Promise.resolve()})},w.prototype.scanFile=function(x,u){return this.scanFileV2(x,u).then(function(E){return E.decodedText})},w.prototype.scanFileV2=function(x,u){var E=this;if(!x||!(x instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(kt(u)&&(u=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(p,g){E.possiblyCloseLastScanImageFile(),E.clearElement(),E.lastScanImageFile=URL.createObjectURL(x);var R=new Image;R.onload=function(){var V=R.width,B=R.height,C=document.getElementById(E.elementId),L=C.clientWidth?C.clientWidth:Ct.DEFAULT_WIDTH,D=Math.max(C.clientHeight?C.clientHeight:B,Ct.FILE_SCAN_MIN_HEIGHT),ue=E.computeCanvasDrawConfig(V,B,L,D);if(u){var re=E.createCanvasElement(L,D,"qr-canvas-visible");re.style.display="inline-block",C.appendChild(re);var Qe=re.getContext("2d");if(!Qe)throw"Unable to get 2d context from canvas";Qe.canvas.width=L,Qe.canvas.height=D,Qe.drawImage(R,0,0,V,B,ue.x,ue.y,ue.width,ue.height)}var ne=Ct.FILE_SCAN_HIDDEN_CANVAS_PADDING,lt=Math.max(R.width,ue.width),rt=Math.max(R.height,ue.height),pe=lt+2*ne,$=rt+2*ne,oe=E.createCanvasElement(pe,$);C.appendChild(oe);var Je=oe.getContext("2d");if(!Je)throw"Unable to get 2d context from canvas";Je.canvas.width=pe,Je.canvas.height=$,Je.drawImage(R,0,0,V,B,ne,ne,lt,rt);try{E.qrcode.decodeRobustlyAsync(oe).then(function(le){p(Lr.createFromQrcodeResult(le))}).catch(g)}catch(le){g("QR code parse error, error = ".concat(le))}},R.onerror=g,R.onabort=g,R.onstalled=g,R.onsuspend=g,R.src=URL.createObjectURL(x)})},w.prototype.clear=function(){this.clearElement()},w.getCameras=function(){return ns.retrieve()},w.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},w.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},w.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},w.prototype.applyVideoConstraints=function(x){if(x){if(!zr.isMediaStreamConstraintsValid(x,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(x)},w.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},w.prototype.getSupportedFormats=function(x){var u=[j.QR_CODE,j.AZTEC,j.CODABAR,j.CODE_39,j.CODE_93,j.CODE_128,j.DATA_MATRIX,j.MAXICODE,j.ITF,j.EAN_13,j.EAN_8,j.PDF_417,j.RSS_14,j.RSS_EXPANDED,j.UPC_A,j.UPC_E,j.UPC_EAN_EXTENSION];if(!x||typeof x=="boolean"||!x.formatsToSupport)return u;if(!Array.isArray(x.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(x.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var E=[],p=0,g=x.formatsToSupport;p<g.length;p++){var R=g[p];Li(R)?E.push(R):this.logger.warn("Invalid format: ".concat(R," passed in config, ignoring."))}if(E.length===0)throw"None of formatsToSupport match supported values.";return E},w.prototype.getUseBarCodeDetectorIfSupported=function(x){if(kt(x))return!0;if(!kt(x.useBarCodeDetectorIfSupported))return x.useBarCodeDetectorIfSupported!==!1;if(kt(x.experimentalFeatures))return!0;var u=x.experimentalFeatures;return kt(u.useBarCodeDetectorIfSupported)?!0:u.useBarCodeDetectorIfSupported!==!1},w.prototype.validateQrboxSize=function(x,u,E){var p=this,g=E.qrbox;this.validateQrboxConfig(g);var R=this.toQrdimensions(x,u,g),V=function(C){if(C<Ct.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ct.MIN_QR_BOX_SIZE,"px.")},B=function(C){return C>x&&(p.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),C=x),C};V(R.width),V(R.height),R.width=B(R.width)},w.prototype.validateQrboxConfig=function(x){if(typeof x!="number"&&typeof x!="function"&&(x.width===void 0||x.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},w.prototype.toQrdimensions=function(x,u,E){if(typeof E=="number")return{width:E,height:E};if(typeof E=="function")try{return E(x,u)}catch(p){throw new Error("qrbox config was passed as a function but it failed with unknown error"+p)}return E},w.prototype.setupUi=function(x,u,E){E.isShadedBoxEnabled()&&this.validateQrboxSize(x,u,E);var p=kt(E.qrbox)?{width:x,height:u}:E.qrbox;this.validateQrboxConfig(p);var g=this.toQrdimensions(x,u,p);g.height>u&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var R=E.isShadedBoxEnabled()&&g.height<=u,V={x:0,y:0,width:x,height:u},B=R?this.getShadedRegionBounds(x,u,g):V,C=this.createCanvasElement(B.width,B.height),L={willReadFrequently:!0},D=C.getContext("2d",L);D.canvas.width=B.width,D.canvas.height=B.height,this.element.append(C),R&&this.possiblyInsertShadingElement(this.element,x,u,g),this.createScannerPausedUiElement(this.element),this.qrRegion=B,this.context=D,this.canvasElement=C},w.prototype.createScannerPausedUiElement=function(x){var u=document.createElement("div");u.innerText=wn.scannerPaused(),u.style.display="none",u.style.position="absolute",u.style.top="0px",u.style.zIndex="1",u.style.background="rgba(9, 9, 9, 0.46)",u.style.color="#FFECEC",u.style.textAlign="center",u.style.width="100%",x.appendChild(u),this.scannerPausedUiElement=u},w.prototype.scanContext=function(x,u){var E=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(p){return x(p.text,Lr.createFromQrcodeResult(p)),E.possiblyUpdateShaders(!0),!0}).catch(function(p){E.possiblyUpdateShaders(!1);var g=wn.codeParseError(p);return u(g,ki.createFrom(g)),!1})},w.prototype.foreverScan=function(x,u,E){var p=this;if(this.shouldScan&&this.renderedCamera){var g=this.renderedCamera.getSurface(),R=g.videoWidth/g.clientWidth,V=g.videoHeight/g.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var B=this.qrRegion.width*R,C=this.qrRegion.height*V,L=this.qrRegion.x*R,D=this.qrRegion.y*V;this.context.drawImage(g,L,D,B,C,0,0,this.qrRegion.width,this.qrRegion.height);var ue=function(){p.foreverScanTimeout=setTimeout(function(){p.foreverScan(x,u,E)},p.getTimeoutFps(x.fps))};this.scanContext(u,E).then(function(re){!re&&x.disableFlip!==!0?(p.context.translate(p.context.canvas.width,0),p.context.scale(-1,1),p.scanContext(u,E).finally(function(){ue()})):ue()}).catch(function(re){p.logger.logError("Error happend while scanning context",re),ue()})}},w.prototype.createVideoConstraints=function(x){if(typeof x=="string")return{deviceId:{exact:x}};if(typeof x=="object"){var u="facingMode",E="deviceId",p={user:!0,environment:!0},g="exact",R=function(Qe){if(Qe in p)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(Qe,"'")},V=Object.keys(x);if(V.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(V.length," keys");var B=Object.keys(x)[0];if(B!==u&&B!==E)throw"Only '".concat(u,"' and '").concat(E,"' ")+" are supported for 'cameraIdOrConfig'";if(B===u){var C=x.facingMode;if(typeof C=="string"){if(R(C))return{facingMode:C}}else if(typeof C=="object")if(g in C){if(R(C["".concat(g)]))return{facingMode:{exact:C["".concat(g)]}}}else throw"'facingMode' should be string or object with"+" ".concat(g," as key.");else{var L=typeof C;throw"Invalid type of 'facingMode' = ".concat(L)}}else{var D=x.deviceId;if(typeof D=="string")return{deviceId:D};if(typeof D=="object"){if(g in D)return{deviceId:{exact:D["".concat(g)]}};throw"'deviceId' should be string or object with"+" ".concat(g," as key.")}else{var ue=typeof D;throw"Invalid type of 'deviceId' = ".concat(ue)}}}var re=typeof x;throw"Invalid type of 'cameraIdOrConfig' = ".concat(re)},w.prototype.computeCanvasDrawConfig=function(x,u,E,p){if(x<=E&&u<=p){var g=(E-x)/2,R=(p-u)/2;return{x:g,y:R,width:x,height:u}}else{var V=x,B=u;return x>E&&(u=E/x*u,x=E),u>p&&(x=p/u*x,u=p),this.logger.log("Image downsampled from "+"".concat(V,"X").concat(B)+" to ".concat(x,"X").concat(u,".")),this.computeCanvasDrawConfig(x,u,E,p)}},w.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var x=document.getElementById(this.elementId);x&&(x.innerHTML="")},w.prototype.possiblyUpdateShaders=function(x){this.qrMatch!==x&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(u){u.style.backgroundColor=x?Ct.BORDER_SHADER_MATCH_COLOR:Ct.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=x)},w.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},w.prototype.createCanvasElement=function(x,u,E){var p=x,g=u,R=document.createElement("canvas");return R.style.width="".concat(p,"px"),R.style.height="".concat(g,"px"),R.style.display="none",R.id=kt(E)?"qr-canvas":E,R},w.prototype.getShadedRegionBounds=function(x,u,E){if(E.width>x||E.height>u)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(x-E.width)/2,y:(u-E.height)/2,width:E.width,height:E.height}},w.prototype.possiblyInsertShadingElement=function(x,u,E,p){if(!(u-p.width<1||E-p.height<1)){var g=document.createElement("div");g.style.position="absolute";var R=(u-p.width)/2,V=(E-p.height)/2;if(g.style.borderLeft="".concat(R,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderRight="".concat(R,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderTop="".concat(V,"px solid rgba(0, 0, 0, 0.48)"),g.style.borderBottom="".concat(V,"px solid rgba(0, 0, 0, 0.48)"),g.style.boxSizing="border-box",g.style.top="0px",g.style.bottom="0px",g.style.left="0px",g.style.right="0px",g.id="".concat(Ct.SHADED_REGION_ELEMENT_ID),u-p.width<11||E-p.height<11)this.hasBorderShaders=!1;else{var B=5,C=40;this.insertShaderBorders(g,C,B,-B,null,0,!0),this.insertShaderBorders(g,C,B,-B,null,0,!1),this.insertShaderBorders(g,C,B,null,-B,0,!0),this.insertShaderBorders(g,C,B,null,-B,0,!1),this.insertShaderBorders(g,B,C+B,-B,null,-B,!0),this.insertShaderBorders(g,B,C+B,null,-B,-B,!0),this.insertShaderBorders(g,B,C+B,-B,null,-B,!1),this.insertShaderBorders(g,B,C+B,null,-B,-B,!1),this.hasBorderShaders=!0}x.append(g)}},w.prototype.insertShaderBorders=function(x,u,E,p,g,R,V){var B=document.createElement("div");B.style.position="absolute",B.style.backgroundColor=Ct.BORDER_SHADER_DEFAULT_COLOR,B.style.width="".concat(u,"px"),B.style.height="".concat(E,"px"),p!==null&&(B.style.top="".concat(p,"px")),g!==null&&(B.style.bottom="".concat(g,"px")),V?B.style.left="".concat(R,"px"):B.style.right="".concat(R,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(B),x.appendChild(B)},w.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},w.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},w.prototype.getTimeoutFps=function(x){return 1e3/x},w}(),Xr;(function(w){w[w.STATUS_DEFAULT=0]="STATUS_DEFAULT",w[w.STATUS_SUCCESS=1]="STATUS_SUCCESS",w[w.STATUS_WARNING=2]="STATUS_WARNING",w[w.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Xr||(Xr={}));const ls=[{title:"Dashboard",href:"/dashboard"},{title:"Dashboard",href:"/librarian/dashboard"}];function ps(){const{auth:w,stats:x,student:u,book:E,scanStep:p,errors:g,success:R}=Ni().props;console.log("Received props:",{scanStep:p,student:u,book:E,success:R,errors:g});const[V,B]=He.useState(""),[C,L]=He.useState(!1),[D,ue]=He.useState(null),[re,Qe]=He.useState([]),[ne,lt]=He.useState(null),[rt,pe]=He.useState(!1),[$,oe]=He.useState([]),[Je,le]=He.useState(null),[G,ge]=He.useState(!1),[U,gt]=He.useState(""),[We,Q]=He.useState(!1),[de,Re]=He.useState(null),O=He.useRef(0),{data:Ne,setData:te,post:Zt,processing:$e,reset:ct}=Mr({scan_input:"",scan_step:p}),{data:nn,setData:Ze,post:Ft,processing:Le,reset:Ut}=Mr({member_id:""}),z=He.useRef(null),Nt=He.useRef(null),Xe=He.useRef(null),Vt=He.useRef(null),wt=He.useRef(null),Fe=He.useRef(null);He.useEffect(()=>{console.log("initialScanStep changed:",p),te("scan_step",p)},[p,te]),He.useEffect(()=>{var M,W;return pe(/mobile|android|iphone|ipad|tablet/i.test(navigator.userAgent.toLowerCase())),p!=="confirm"&&(z.current||(z.current=new Hn("scanner-container",{verbose:!0})),rn()),p!=="confirm"&&wt.current&&wt.current.focus(),R&&Z("success",R),g.scan_input&&Z("error",g.scan_input),(g.student_id||g.book_isbn)&&Z("error",((M=g.student_id)==null?void 0:M[0])||((W=g.book_isbn)==null?void 0:W[0])||"Validation error occurred."),()=>{Rt(),Me(),p==="confirm"&&z.current&&(z.current=null)}},[R,g,p]);const rn=async()=>{var M;(!z.current||!Nt.current)&&(z.current=new Hn("scanner-container",{verbose:!0}),Nt.current=new Hn("clearance-scanner-container",{verbose:!0}));try{const W=await Hn.getCameras();console.log("Available cameras:",W);const Ie=W.map(at=>({id:at.id,label:at.label||`Camera ${at.id}`}));if(Qe(Ie),W.length>0){const at=W.find(Te=>{var H,ke,Ce;return((H=Te.label)==null?void 0:H.toLowerCase().includes("back"))||((ke=Te.label)==null?void 0:ke.toLowerCase().includes("rear"))||((Ce=Te.label)==null?void 0:Ce.toLowerCase().includes("environment"))})||W[0];lt(at.id),rt&&W.length===1&&((M=at.label)!=null&&M.toLowerCase().includes("front"))&&(ue("Only front camera detected. For best results, use the rear camera or manual input."),Re("Only front camera detected. For best results, use the rear camera or manual input."),Z("info","Only front camera detected. Rear camera is recommended for scanning."))}else ue("No camera found. Please connect a camera or use manual input."),Re("No camera found. Please connect a camera or use manual input.")}catch(W){console.error("Camera access error:",W.name,W.message);let Ie="Failed to access camera. Please allow camera permissions or use manual input.";W.name==="NotAllowedError"?(Ie="Camera access denied. Please allow camera permissions in your browser settings.",Ae()):W.name==="NotFoundError"&&(Ie="No camera found. Please connect a camera or use manual input."),ue(Ie),Re(Ie),Z("error",Ie)}},fe=M=>{console.log("Parsing QR code:",M);const W=M.split("|");return W.length===3?W[1]:M},Gt=async()=>{if(!z.current||!Xe.current||!ne){ue("No camera selected. Please select a camera or use manual input.");return}try{L(!0),ue(null),await z.current.start(ne,{fps:15,qrbox:{width:300,height:300},aspectRatio:rt?1.777:void 0,experimentalFeatures:{useBarCodeDetectorIfSupported:!0}},M=>{console.log("Scanned text:",M);const W=p==="student"?fe(M):M;B(W),te({scan_input:W,scan_step:p}),Y({preventDefault:()=>{}}),Rt()},M=>{const W=Date.now();W-O.current>=5e3&&!M.includes("No QR code found")&&(console.error("Scanning error:",M),Z("error",`Failed to detect code: ${M}. Please try again.`),O.current=W)}),setTimeout(()=>{C&&(Rt(),Z("info","Scanning timed out. Please try again or use manual input."))},15e3)}catch(M){console.error("Start scanning error:",M.name,M.message);let W="Failed to access camera. Please allow camera permissions or use manual input.";M.name==="NotAllowedError"?(W="Camera access denied. Please allow camera permissions in your browser settings.",Ae()):M.name==="NotFoundError"?W="No camera found. Please connect a camera or use manual input.":M.name==="OverconstrainedError"&&(W="Camera constraints not supported. Please select a different camera or use manual input."),ue(W),Z("error",W),L(!1)}},Et=async()=>{if(!Nt.current||!Vt.current||!ne){Re("No camera selected. Please select a camera or use manual input.");return}try{Q(!0),Re(null),await Nt.current.start(ne,{fps:15,qrbox:{width:300,height:300},aspectRatio:rt?1.777:void 0,experimentalFeatures:{useBarCodeDetectorIfSupported:!0}},M=>{console.log("Clearance scan text:",M);const W=fe(M);gt(W),Ze("member_id",W),Kt({preventDefault:()=>{}}),Me()},M=>{const W=Date.now();W-O.current>=5e3&&!M.includes("No QR code found")&&(console.error("Clearance scanning error:",M),Z("error",`Failed to detect code: ${M}. Please try again.`),O.current=W)}),setTimeout(()=>{We&&(Me(),Z("info","Clearance scanning timed out. Please try again or use manual input."))},15e3)}catch(M){console.error("Start clearance scanning error:",M.name,M.message);let W="Failed to access camera. Please allow camera permissions or use manual input.";M.name==="NotAllowedError"?(W="Camera access denied. Please allow camera permissions in your browser settings.",Ae()):M.name==="NotFoundError"?W="No camera found. Please connect a camera or use manual input.":M.name==="OverconstrainedError"&&(W="Camera constraints not supported. Please select a different camera or use manual input."),Re(W),Z("error",W),Q(!1)}},Rt=()=>{z.current&&z.current.getState()!==Be.NOT_STARTED&&z.current.stop().then(()=>{L(!1)}).catch(M=>{console.error("Stop scanning error:",M)}),L(!1)},Me=()=>{Nt.current&&Nt.current.getState()!==Be.NOT_STARTED&&Nt.current.stop().then(()=>{Q(!1)}).catch(M=>{console.error("Stop clearance scanning error:",M)}),Q(!1)};He.useEffect(()=>{(D&&wt.current&&p!=="confirm"||wt.current&&p!=="confirm")&&wt.current.focus(),G&&Fe.current&&Fe.current.focus()},[p,D,G]);const Ae=()=>{const M=navigator.userAgent.toLowerCase();let W="Please enable camera permissions in your browser settings.";M.includes("chrome")?W+=" Go to Settings > Privacy and security > Site settings > Camera.":M.includes("firefox")?W+=" Go to Preferences > Privacy & Security > Permissions > Camera.":M.includes("safari")&&(W+=" Go to Settings > Websites > Camera."),Z("info",W)},Z=(M,W)=>{const Ie=Date.now().toString();oe(at=>[...at,{type:M,message:W,id:Ie}]),setTimeout(()=>{oe(at=>at.filter(Te=>Te.id!==Ie))},5e3)},sn=M=>{oe(W=>W.filter(Ie=>Ie.id!==M))},Y=async M=>{if(M.preventDefault(),!(!Ne.scan_input.trim()||$e)){if(Ne.scan_step==="book"){if(Ne.scan_input.length!==10&&Ne.scan_input.length!==13){Z("error","Invalid ISBN format. ISBN must be 10 or 13 digits.");return}if(!/^\d+$/.test(Ne.scan_input)){Z("error","Invalid ISBN format. ISBN must contain only digits.");return}}console.log("Submitting scan:",Ne),Zt(route("librarian.scan"),{preserveState:!0,onSuccess:()=>{ct(),B(""),te("scan_step",p)},onError:W=>{console.error("Scan errors:",W),Z("error",W.scan_input||"Failed to process scan."),B(""),ct()}})}},Kt=async M=>{M.preventDefault(),!(!nn.member_id.trim()||Le)&&(console.log("Submitting clearance check:",nn),Ft(route("librarian.clearance"),{preserveState:!0,onSuccess:W=>{const{clearance:Ie}=W.props;le(Ie),Z(Ie.isCleared?"success":"error",Ie.message)},onError:W=>{var Ie;console.error("Clearance check errors:",W),Z("error",((Ie=W.member_id)==null?void 0:Ie[0])||"Failed to check clearance."),gt(""),Ut()}}))},Dn=()=>{if(!u||!E){Z("error","Missing student or book information");return}const M={member_id:u.member_id,book_isbn:E.isbn};console.log("Confirm borrow payload:",M),hr.post(route("librarian.confirm-borrow"),M,{preserveState:!1,headers:{"X-Debug-Source":"handleConfirmBorrow"},onSuccess:()=>{console.log("Borrow confirmation successful"),ct(),B(""),le(null),Z("success","Borrowing confirmed successfully.")},onError:W=>{var Ie,at;console.error("Confirm borrow errors:",W),Z("error",((Ie=W.student_id)==null?void 0:Ie[0])||((at=W.book_isbn)==null?void 0:at[0])||"Failed to confirm borrowing.")}})},pt=()=>{console.log("Resetting scan state"),hr.post(route("librarian.scan"),{scan_input:"",scan_step:"student",reset:!0},{preserveState:!1,headers:{"X-Debug-Source":"handleReset"},onSuccess:()=>{console.log("Reset successful"),ct(),B(""),le(null),Z("success","Scan reset successfully.")},onError:M=>{var W;console.error("Reset errors:",M),Z("error",((W=M.reset)==null?void 0:W[0])||"Failed to reset scan state.")}})},mn=()=>{console.log("Clearing all scan state"),hr.post(route("librarian.scan"),{scan_input:"",scan_step:"student",clear_all:!0},{preserveState:!1,headers:{"X-Debug-Source":"handleClearAll"},onSuccess:()=>{console.log("Clear all successful"),ct(),B(""),le(null),Z("success","All scan data cleared successfully.")},onError:M=>{var W;console.error("Clear all errors:",M),Z("error",((W=M.clear_all)==null?void 0:W[0])||"Failed to clear scan data.")}})},mt=()=>{ge(!0),le(null),gt(""),Ut(),Fe.current&&Fe.current.focus()},An=()=>{ge(!1),Me(),le(null),gt(""),Ut()},Ot=()=>{le(null),gt(""),Ut(),Me(),Fe.current&&Fe.current.focus()};return y.jsxs(_i,{breadcrumbs:ls,children:[y.jsx(Ti,{title:"Librarian Dashboard"}),y.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[y.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-5",children:[y.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm lg:col-span-2",children:[y.jsxs("h1",{className:"mb-2 text-xl font-bold text-gray-900",children:["Welcome, ",w.user.name]}),y.jsx("p",{className:"text-gray-600",children:"Manage book transactions and assist library users with their borrowing needs."})]}),y.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Transactions"}),y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.totalTransactions||0})]}),y.jsx(Ri,{className:"h-8 w-8 text-blue-600"})]})}),y.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Books"}),y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.overdueBooks||0})]}),y.jsx(Oi,{className:"h-8 w-8 text-red-600"})]})}),y.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:y.jsx("button",{onClick:mt,className:"w-full text-left",children:y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx(gn,{className:"h-8 w-8 text-green-600"}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold text-gray-900",children:"Check Clearance"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Check student clearance status"})]})]})})})]}),y.jsx("div",{className:"rounded-lg bg-gradient-to-br from-gray-50 to-blue-50 p-6",children:y.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[y.jsx("div",{className:"space-y-6",children:y.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-lg",children:[y.jsxs("div",{className:"mb-6 flex items-center space-x-3",children:[y.jsx(Di,{className:"h-6 w-6 text-blue-600"}),y.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:p==="student"?"Scan Student ID QR Code":p==="book"?"Scan Book ISBN":"Confirm Borrowing"})]}),re.length>0&&p!=="confirm"&&y.jsxs("div",{className:"mb-4",children:[y.jsx("label",{htmlFor:"cameraSelect",className:"block text-sm font-medium text-gray-700",children:"Select Camera"}),y.jsxs("select",{id:"cameraSelect",value:ne||"",onChange:M=>lt(M.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2",children:[y.jsx("option",{value:"",disabled:!0,children:"Select a camera"}),re.map(M=>y.jsx("option",{value:M.id,children:M.label.toLowerCase().includes("back")||M.label.toLowerCase().includes("rear")||M.label.toLowerCase().includes("environment")?"Rear Camera":"Front Camera"},M.id))]})]}),p!=="confirm"&&y.jsxs("div",{className:"relative mb-4",children:[y.jsx("div",{id:"scanner-container",ref:Xe,className:`w-full rounded-lg ${C?"block":"hidden"}`,style:{maxHeight:rt?"50vh":"300px"}}),!C&&y.jsx("div",{className:`flex h-[${rt?"50vh":"300px"}] w-full items-center justify-center rounded-lg bg-gray-100`,children:D?y.jsx("p",{className:"px-4 text-center text-red-600",id:"camera-error",children:D}):y.jsx("p",{className:"text-gray-500",children:"Camera feed will appear here when scanning"})})]}),p!=="confirm"&&y.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("input",{ref:wt,type:"text",value:V,onChange:M=>{B(M.target.value),te("scan_input",M.target.value)},placeholder:D?"Enter student ID or full QR code manually...":p==="student"?"Scan or enter student ID...":"Scan or enter book ISBN...",className:"w-full rounded-lg border border-gray-300 px-4 py-3 font-mono text-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",disabled:$e,"aria-describedby":D?"camera-error":void 0}),$e&&y.jsx("div",{className:"absolute top-1/2 right-3 -translate-y-1/2 transform",children:y.jsx(Rn,{className:"h-5 w-5 animate-spin text-blue-600"})})]}),y.jsxs("div",{className:"flex space-x-3",children:[y.jsx("button",{type:"button",onClick:C?Rt:Gt,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",disabled:$e||!ne,"aria-label":C?"Stop scanning":"Start scanning",children:C?"Stop Scanning":"Start Scanning"}),y.jsx("button",{type:"submit",disabled:!Ne.scan_input.trim()||$e,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Submit manual scan",children:$e?"Processing...":"Manual Scan"}),y.jsx("button",{type:"button",onClick:pt,className:"rounded-lg border border-gray-300 px-4 py-2 text-gray-700 transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:outline-none","aria-label":"Reset scanning",children:y.jsx(Rn,{className:"h-4 w-4"})}),y.jsx("button",{type:"button",onClick:mn,className:"rounded-lg border border-red-300 px-4 py-2 text-red-700 transition-colors hover:bg-red-50 focus:ring-2 focus:ring-red-500 focus:outline-none","aria-label":"Clear all scans",children:y.jsx(Mi,{className:"h-4 w-4"})})]})]}),p==="confirm"&&u&&E&&y.jsxs("div",{className:"mt-6 rounded-lg border border-blue-200 bg-blue-50 p-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Confirm Borrowing"}),y.jsxs("div",{className:"mt-2 space-y-2",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Student:"})," ",u.name," (",u.member_id,")"]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Book ISBN:"})," ",E.isbn]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Book Title:"})," ",E.title]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Author:"})," ",E.author]})]}),y.jsxs("div",{className:"mt-4 flex space-x-3",children:[y.jsx("button",{type:"button",onClick:Dn,className:"flex-1 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",disabled:$e,children:$e?"Processing...":"Confirm Borrowing"}),y.jsx("button",{type:"button",onClick:pt,className:"rounded-lg border border-gray-300 px-4 py-2 text-gray-700 transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:outline-none","aria-label":"Cancel borrowing",children:"Cancel"})]})]}),y.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-4",children:[y.jsxs("div",{className:`flex items-center space-x-2 rounded-full px-3 py-1 text-sm ${p==="student"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:[y.jsx("span",{className:`h-2 w-2 rounded-full ${p==="student"?"bg-blue-600":"bg-green-600"}`}),y.jsx("span",{children:"Step 1: Student ID"})]}),y.jsxs("div",{className:`flex items-center space-x-2 rounded-full px-3 py-1 text-sm ${p==="book"||p==="confirm"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"}`,children:[y.jsx("span",{className:`h-2 w-2 rounded-full ${p==="book"||p==="confirm"?"bg-blue-600":"bg-gray-400"}`}),y.jsx("span",{children:"Step 2: Book ISBN"})]}),y.jsxs("div",{className:`flex items-center space-x-2 rounded-full px-3 py-1 text-sm ${p==="confirm"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"}`,children:[y.jsx("span",{className:`h-2 w-2 rounded-full ${p==="confirm"?"bg-blue-600":"bg-gray-400"}`}),y.jsx("span",{children:"Step 3: Confirm"})]})]})]})}),y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-lg",children:[y.jsxs("div",{className:"mb-4 flex items-center space-x-3",children:[y.jsx(vr,{className:"h-6 w-6 text-green-600"}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Student Information"})]}),u?y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{className:"text-gray-600",children:"Student ID:"}),y.jsx("span",{className:"font-medium",children:u.member_id})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{className:"text-gray-600",children:"Name:"}),y.jsx("span",{className:"font-medium",children:u.name})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{className:"text-gray-600",children:"Email:"}),y.jsx("span",{className:"font-medium",children:u.email})]}),y.jsx("div",{className:"mt-4 rounded-lg border border-green-200 bg-green-50 p-3",children:y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx(gn,{className:"h-4 w-4 text-green-600"}),y.jsx("span",{className:"text-sm text-green-800",children:"Student verified"})]})})]}):y.jsxs("div",{className:"py-8 text-center text-gray-500",children:[y.jsx(vr,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),y.jsx("p",{children:"Scan a student ID QR code to view information"})]})]}),y.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-lg",children:[y.jsxs("div",{className:"mb-4 flex items-center space-x-3",children:[y.jsx(fr,{className:"h-6 w-6 text-blue-600"}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Book Information"})]}),E?y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{className:"text-gray-600",children:"ISBN:"}),y.jsx("span",{className:"font-medium",children:E.isbn})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{className:"text-gray-600",children:"Title:"}),y.jsx("span",{className:"font-medium",children:E.title})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{className:"text-gray-600",children:"Author:"}),y.jsx("span",{className:"font-medium",children:E.author})]}),y.jsx("div",{className:"mt-4",children:y.jsx("div",{className:`rounded-lg border p-3 ${E.available?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:y.jsxs("div",{className:"flex items-center space-x-2",children:[E.available?y.jsx(gn,{className:"h-4 w-4 text-green-600"}):y.jsx(_n,{className:"h-4 w-4 text-red-600"}),y.jsx("span",{className:`text-sm ${E.available?"text-green-800":"text-red-800"}`,children:E.available?"Available for borrowing":"Currently unavailable"})]})})})]}):y.jsxs("div",{className:"py-8 text-center text-gray-500",children:[y.jsx(fr,{className:"mx-auto mb-3 h-12 w-12 text-gray-300"}),y.jsx("p",{children:"Scan a book ISBN to view information"})]})]})]})]})}),y.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[y.jsx("a",{href:"/librarian/transactions",className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-shadow hover:shadow-md",children:y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx(fr,{className:"h-8 w-8 text-blue-600"}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold text-gray-900",children:"View Transactions"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Browse all borrowing records"})]})]})}),y.jsx("a",{href:"/librarian/returns",className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-shadow hover:shadow-md",children:y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx(Rn,{className:"h-8 w-8 text-green-600"}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold text-gray-900",children:"Process Returns"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Handle book returns"})]})]})}),y.jsx("a",{href:"/librarian/overdue",className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm transition-shadow hover:shadow-md",children:y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx(_n,{className:"h-8 w-8 text-red-600"}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold text-gray-900",children:"Overdue Books"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Manage overdue items"})]})]})})]}),G&&y.jsx("div",{className:"bg-opacity-50 fixed inset-0 z-50 flex items-center justify-center bg-black",children:y.jsxs("div",{className:"w-full max-w-lg rounded-lg bg-white p-6 shadow-xl",children:[y.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[y.jsxs("h2",{className:"flex items-center text-xl font-semibold text-gray-900",children:[y.jsx(gn,{className:"mr-2 h-6 w-6 text-green-600"}),"Check Student Clearance"]}),y.jsx("button",{onClick:An,className:"text-gray-400 hover:text-gray-600","aria-label":"Close clearance modal",children:"×"})]}),y.jsxs("div",{className:"space-y-4",children:[re.length>0&&y.jsxs("div",{className:"mb-4",children:[y.jsx("label",{htmlFor:"clearanceCameraSelect",className:"block text-sm font-medium text-gray-700",children:"Select Camera"}),y.jsxs("select",{id:"clearanceCameraSelect",value:ne||"",onChange:M=>lt(M.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2",children:[y.jsx("option",{value:"",disabled:!0,children:"Select a camera"}),re.map(M=>y.jsx("option",{value:M.id,children:M.label.toLowerCase().includes("back")||M.label.toLowerCase().includes("rear")||M.label.toLowerCase().includes("environment")?"Rear Camera":"Front Camera"},M.id))]})]}),y.jsxs("div",{className:"relative mb-4",children:[y.jsx("div",{id:"clearance-scanner-container",ref:Vt,className:`w-full rounded-lg ${We?"block":"hidden"}`,style:{maxHeight:rt?"40vh":"250px"}}),!We&&y.jsx("div",{className:`flex h-[${rt?"40vh":"250px"}] w-full items-center justify-center rounded-lg bg-gray-100`,children:de?y.jsx("p",{className:"px-4 text-center text-red-600",id:"clearance-camera-error",children:de}):y.jsx("p",{className:"text-gray-500",children:"Camera feed will appear here when scanning"})})]}),y.jsxs("form",{onSubmit:Kt,className:"space-y-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("input",{ref:Fe,type:"text",value:U,onChange:M=>{gt(M.target.value),Ze("member_id",M.target.value)},placeholder:de?"Enter student ID manually...":"Scan or enter student ID...",className:"w-full rounded-lg border border-gray-300 px-4 py-3 font-mono text-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none",disabled:Le,"aria-describedby":de?"clearance-camera-error":void 0}),Le&&y.jsx("div",{className:"absolute top-1/2 right-3 -translate-y-1/2 transform",children:y.jsx(Rn,{className:"h-5 w-5 animate-spin text-blue-600"})})]}),y.jsxs("div",{className:"flex space-x-3",children:[y.jsx("button",{type:"button",onClick:We?Me:Et,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",disabled:Le||!ne,"aria-label":We?"Stop scanning":"Start scanning",children:We?"Stop Scanning":"Start Scanning"}),y.jsx("button",{type:"submit",disabled:!nn.member_id.trim()||Le,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Submit clearance check",children:Le?"Checking...":"Check Clearance"}),y.jsx("button",{type:"button",onClick:Ot,className:"rounded-lg border border-gray-300 px-4 py-2 text-gray-700 transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:outline-none","aria-label":"Reset clearance scan",children:y.jsx(Rn,{className:"h-4 w-4"})})]})]}),Je&&y.jsxs("div",{className:"mt-4 rounded-lg border p-4",children:[y.jsx("div",{className:"flex items-center space-x-2",children:Je.isCleared?y.jsxs(y.Fragment,{children:[y.jsx(gn,{className:"h-5 w-5 text-green-600"}),y.jsx("span",{className:"text-sm font-medium text-green-800",children:Je.message})]}):y.jsxs(y.Fragment,{children:[y.jsx(_n,{className:"h-5 w-5 text-red-600"}),y.jsx("span",{className:"text-sm font-medium text-red-800",children:Je.message})]})}),!Je.isCleared&&Je.details&&y.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[y.jsxs("p",{children:["Active Loans: ",Je.details.activeLoans]}),y.jsxs("p",{children:["Unpaid Fines: $",Je.details.unpaidFines.toFixed(2)]})]})]}),y.jsx("div",{className:"mt-4 flex justify-end space-x-3",children:y.jsx("button",{onClick:An,className:"rounded-lg border border-gray-300 px-4 py-2 text-gray-700 transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:outline-none","aria-label":"Close clearance modal",children:"Close"})})]})]})}),y.jsx("div",{className:"fixed right-4 bottom-4 z-50 space-y-2",children:$.map(M=>y.jsxs("div",{className:`flex max-w-sm items-center space-x-3 rounded-lg border px-4 py-3 shadow-lg ${M.type==="success"?"border-green-200 bg-green-50 text-green-800":M.type==="error"?"border-red-200 bg-red-50 text-red-800":"border-blue-200 bg-blue-50 text-blue-800"}`,children:[M.type==="success"&&y.jsx(gn,{className:"h-5 w-5 text-green-600"}),M.type==="error"&&y.jsx(_n,{className:"h-5 w-5 text-red-600"}),M.type==="info"&&y.jsx(_n,{className:"h-5 w-5 text-blue-600"}),y.jsx("span",{className:"text-sm font-medium",children:M.message}),y.jsx("button",{onClick:()=>sn(M.id),className:"text-gray-400 hover:text-gray-600",children:"×"})]},M.id))})]})]})}export{ps as default};
